(function(){var e={25012:function(e,t,n){"use strict";n(41011),n(92806),n(53287),n(70039),n(70144),n(86823),n(51204),n(41011),n(92806),n(53287),n(70039),n(70144),n(86823),n(51204),Object.defineProperty(t,"__esModule",{value:!0}),t.AptosUtils=void 0;class i{static getTransaction(e){if("rawTransaction"in e){let t=e;if("entryFunction"in t.rawTransaction.payload){let e=t.rawTransaction.payload.entryFunction,n=e.type_args,i=new Array;n.forEach((e=>{i.push(e.toString())}));let s=new Array;this.getTypeArguments(e.args,s);let o={arguments:s,function:`${e.module_name.address.data?e.module_name.address.toString():e.module_name.address}::${e.module_name.name.identifier?e.module_name.name.identifier:e.module_name.name}::${e.function_name.identifier?e.function_name.identifier:e.function_name}`,type:"entry_function_payload",type_arguments:i};return this.getArguments(o)}}return e}static getTypeArguments(e,t){for(let n=0;n<e.length;n++){let i=e[n];if("values"in i&&null!=i.values&&i.values instanceof Array){let e=new Array;t.push(e),this.getTypeArguments(i.values,e)}else this.dealArrayElements(i,t)}}static dealArrayElements(e,t){if(!("value"in e)||null==e.value)return"data"in e&&null!=e.data&&(e.data,Uint8Array),t.push(e.toString());t.push(e.value.toString())}static getArguments(e){if("arguments"in e){let t=e.arguments;if(Array.isArray(t)){let n=new Array;t.forEach((e=>{if(e instanceof Uint8Array){let t=new Array;e.forEach((e=>{t.push(e)})),n.push(t)}else n.push(e)})),e=Object.assign(Object.assign({},e),{arguments:n})}}return e}}t.AptosUtils=i},94868:function(e,t,n){"use strict";n(88373),n(51555),n(33734),n(22035),n(94932),n(50427),n(19239),n(88373),n(51555),n(33734),n(22035),n(94932),n(50427),n(19239);var i=this&&this.__awaiter||function(e,t,n,i){function s(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function r(e){try{c(i.next(e))}catch(t){o(t)}}function a(e){try{c(i["throw"](e))}catch(t){o(t)}}function c(e){e.done?n(e.value):s(e.value).then(r,a)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.OKXAptosProvider=void 0;const o=n(33211),r=n(25012),a=n(51927),c=s(n(70275));class l{constructor(e){this.chainsSet=new Set,this.provider=e.getUniversalProvider(),this.getConnectedNamespace()}get defaultNetwork(){let e=this.provider.requestDefaultChainWithNamespace(a.NameSpaceKeyAptos);return e}get currentChainId(){return`aptos:${this.defaultNetwork}`}getRealChainId(e){if(null==e){if(1==this.chainsSet.size)return this.currentChainId;throw new Error("connected to multiple aptos chains,chainId can not be null")}return e}getConnectedNamespace(){var e,t,n;null===(n=null===(t=null===(e=this.provider.session)||void 0===e?void 0:e.namespaces)||void 0===t?void 0:t["aptos"])||void 0===n||n.chains.forEach((e=>{this.chainsSet.add(e)}))}getAccount(e){var t,n,i,s,o,r,c,l,d;let u=null===(n=null===(t=this.provider.session)||void 0===t?void 0:t.namespaces["aptos"])||void 0===n?void 0:n.accounts[0];if(null!=e&&(u=null===(s=null===(i=this.provider.session)||void 0===i?void 0:i.namespaces["aptos"])||void 0===s?void 0:s.accounts.filter((function(t){return t.startsWith(e)}))[0]),(0,a.logDebug)("getAccount",u),!u)return;const h=u.split(":"),f=u.split(":")[2];console.log("aptos_publicKey",null===(r=null===(o=this.provider.session)||void 0===o?void 0:o.namespaces["aptos"])||void 0===r?void 0:r.extra);let p=null===(d=null===(l=null===(c=this.provider.session)||void 0===c?void 0:c.namespaces["aptos"])||void 0===l?void 0:l.extra)||void 0===d?void 0:d[`${h[0]}:${h[1]}`],g="";return void 0!=p&&(g=p["publicKey"],console.log("aptos_publicKey",g)),f?{address:f,publicKey:g}:void 0}signMessage(e,t){return i(this,void 0,void 0,(function*(){var n,i;let s=this.getRealChainId(t);try{let t="APTOS",a=null===(n=this.getAccount(s))||void 0===n?void 0:n.address,l="",d="";var r=t;let u=window.location.protocol+"//"+window.location.hostname;"address"in e&&e.address&&(r+="\naddress: "+a),"application"in e&&e.application&&(r+="\napplication: "+u),"chainId"in e&&e.chainId&&(r+="\nchainId: "+s),"message"in e&&(r+="\nmessage: "+e.message,l=e.message),"nonce"in e&&(r+="\nnonce: "+e.nonce,d=e.nonce),console.log("signMessage",r);const h=o.Buffer.from(r),f=this.bufferToHex(h);let p={chainId:s,method:"aptos_signMessage",params:{message:f}},g=yield this.provider.request(p,s);if("result"in g){let e=g.result,n=null===(i=this.getAccount(s))||void 0===i?void 0:i.publicKey;n.slice(2,66);console.log("apt_signMessage",o.Buffer.from(e,"hex")),console.log("apt_signMessage",e);const h=c.default.sign.detached.verify(o.Buffer.from(r),o.Buffer.from(e.slice(2,e.length),"hex"),o.Buffer.from(n,"hex"));return console.log("signMessage",h),new Promise(((n,i)=>{n({address:a,application:u,chainId:s,fullMessage:r,message:l,nonce:d,prefix:t,signature:e,verified:h})}))}return new Promise(((e,t)=>{"error"in g&&e(g.error)}))}catch(a){return console.error("方法数据回调失败 --Error--",a),new Promise(((e,t)=>{e(a)}))}}))}signTransaction(e,t){return i(this,void 0,void 0,(function*(){let n=r.AptosUtils.getTransaction(e);console.log("signTransaction",n);let i=this.getRealChainId(t);try{let e=yield this.provider.request({method:"aptos_signTransaction",params:n},i);if("result"in e){let t=e.result;return new Promise(((e,n)=>{e(o.Buffer.from(t))}))}return new Promise(((t,n)=>{n(e)}))}catch(s){return(0,a.logDebug)("getSignedTransaction",s),new Promise(((e,t)=>{e(s)}))}}))}signAndSubmitTransaction(e,t){return i(this,void 0,void 0,(function*(){let n=r.AptosUtils.getTransaction(e);console.log("signAndSubmitTransaction",n);let i=this.getRealChainId(t);try{let e=yield this.provider.request({method:"aptos_signAndSubmitTransaction",params:n},i);if("result"in e){let t=e.result;return new Promise(((e,n)=>{e(t)}))}return new Promise(((t,n)=>{n(e)}))}catch(s){return(0,a.logDebug)("getSignedTransaction",s),new Promise(((e,t)=>{e(s)}))}}))}bufferToHex(e){return"0x"+o.Buffer.from(e).toString("hex")}}t.OKXAptosProvider=l,t["default"]=l},88392:function(e,t,n){"use strict";t.V=void 0;var i=n(94868);Object.defineProperty(t,"V",{enumerable:!0,get:function(){return i.OKXAptosProvider}})},80385:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CONNECT_METHOD_FETCHMSG=t.CONNECT_METHOD_RECEIVE=t.CONNECT_METHOD_UNSUB=t.CONNECT_METHOD_SUB=t.CONNECT_METHOD_PUBLISH=t.CONNECT_METHOD_LOGIN=t.CONNECT_METHOD_PUSH=void 0,t.CONNECT_METHOD_PUSH="push",t.CONNECT_METHOD_LOGIN="login",t.CONNECT_METHOD_PUBLISH="publish",t.CONNECT_METHOD_SUB="subscribe",t.CONNECT_METHOD_UNSUB="unsubscribe",t.CONNECT_METHOD_RECEIVE="receive",t.CONNECT_METHOD_FETCHMSG="fetchMessages"},86209:function(e,t,n){"use strict";n(37008),n(24671),n(73074),n(37008),n(24671),n(73074);var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,s)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e["default"]=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t},r=this&&this.__awaiter||function(e,t,n,i){function s(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function r(e){try{c(i.next(e))}catch(t){o(t)}}function a(e){try{c(i["throw"](e))}catch(t){o(t)}}function c(e){e.done?n(e.value):s(e.value).then(r,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.OKXWalletConnector=void 0;const a=n(61174),c=n(31364),l=n(57837),d=n(55282),u=o(n(23902)),h=(0,l.resolveWebSocketImplementation)();class f{constructor(e){if(this.events=new d.EventEmitter,this.state=a.ConnectorState.InitState,!(0,l.checkWSUrl)(e))throw new Error(`CONNECTOR: invalid url ${e}`);this.url=e,this.heartbeatTimer=null}get connecting(){return this.state==a.ConnectorState.Connecting}onPayload(e){if("undefined"!==typeof e.data){if(u.logDebug("get received data"),u.logDebug(e),"string"===typeof e.data){let t=e.data;if("pong"===t)return void u.logDebug(`CONNECT: receive pong ${Date.now().toString()}`)}this.events.emit("payload",e.data)}}onClose(e){this.socket=void 0,this.events.emit("close",e)}onError(e,t){const n={id:e,msg:t.toString()};this.events.emit("payload",n)}onopen(e){e.onmessage=e=>this.onPayload(e),e.onclose=e=>this.onClose(e),this.socket=e,this.state=a.ConnectorState.Connected,this.events.emit("open")}emitError(e){this.events.emit("fail",e)}heartbeat(){return r(this,void 0,void 0,(function*(){if(this.heartbeatTimer&&clearTimeout(this.heartbeatTimer),this.state==a.ConnectorState.Connected||this.state==a.ConnectorState.OnError){if(this.socket){if(this.socket.readyState===WebSocket.OPEN)u.logDebug(`send ping heart beat: ${Date.now().toString()}, ${this.socket}`),this.socket.send("ping"),this.heartbeatTimer=setTimeout(this.heartbeat.bind(this),5e3);else if(u.logDebug("socket not ready"),this.state==a.ConnectorState.Connected||this.state==a.ConnectorState.OnError){u.logDebug("socket reconnect by heartbeat");try{yield this.registOpen()}catch(e){u.logError("regist open failed"),this.heartbeatTimer=setTimeout(this.heartbeat.bind(this),5e3)}}}else if(u.logDebug("socket not exist"),this.state==a.ConnectorState.Connected||this.state==a.ConnectorState.OnError){u.logDebug("socket reconnect by heartbeat");try{yield this.registOpen()}catch(e){u.logError("regist open failed"),this.heartbeatTimer=setTimeout(this.heartbeat.bind(this),5e3)}}}else u.logDebug("heart beat close")}))}registOpen(e=this.url){if(!(0,l.checkWSUrl)(e))throw new Error(`CONNECTOR: invalid url ${e}`);if(this.connecting)return new Promise(((e,t)=>{this.events.once("fail",(e=>{t(e)})),this.events.once("open",(()=>{if("undefined"==typeof this.socket)return t(new Error("Connect lost"));e(this.socket)}))}));this.url=e,this.state=a.ConnectorState.Connecting;new URLSearchParams(e).get("origin");return new Promise(((t,n)=>{const i=new h(e,[]);(0,l.hasBuiltInWebSocket)()?i.onerror=e=>{const t=e;this.state=a.ConnectorState.OnError,this.emitError(t.error),n(new Error(t.message))}:i.on("error",(e=>{this.state=a.ConnectorState.OnError,this.emitError(e),n(new Error("socketError"))})),i.onopen=()=>{u.logDebug("socket opened"),this.onopen(i),this.heartbeat(),t(i)}}))}onVisibleChanged(){return r(this,void 0,void 0,(function*(){if("visible"!==document.visibilityState||(u.logDebug(`get changed ${this.state}, ${this.socket}`),this.state!=a.ConnectorState.Connected||"undefined"!==typeof this.socket));else{u.logDebug("CONNECTION need reopen");try{yield this.registOpen()}catch(e){u.logError("regist open failed")}}}))}connect(){return r(this,void 0,void 0,(function*(){yield this.registOpen(this.url),document.removeEventListener("visibilitychange",this.onVisibleChanged.bind(this)),document.addEventListener("visibilitychange",this.onVisibleChanged.bind(this))}))}disconnect(){return r(this,void 0,void 0,(function*(){return this.state=a.ConnectorState.Disconnected,new Promise(((e,t)=>{"undefined"!==typeof this.socket?(this.socket.onclose=t=>{this.onClose(t),e()},this.socket.close(),this.heartbeatTimer&&clearTimeout(this.heartbeatTimer)):e()}))}))}currentStatus(){return{state:this.state,url:this.url}}addListener(e,t,n,i){this.listenPayloadHandler&&this.events.removeListener("payload",this.listenPayloadHandler),this.listenPayloadHandler=s=>{var o;u.logDebug(`<<< get payload ${s}`);let r=(0,c.safeJsonParse)(s);if(r.params&&r.params.data){let a=null===(o=r.params.data)||void 0===o?void 0:o.message;if(a)try{let s=t(a);void 0===s?(u.logDebug("CONNECT: decrypt undefined"),i(e,"Decrypt undefined")):n(e,s)}catch(s){u.logDebug(`CONNECT: decrypt failed: ${s}`),i(e,s.message)}}},this.events.on("payload",this.listenPayloadHandler),this.failHandler&&this.events.removeListener("fail",this.failHandler),this.failHandler=t=>{t?(u.logDebug(`CONNECT failed: ${t}`),i(e,t.message)):i(e,"Unkonow error")},this.events.on("fail",this.failHandler)}addPackageParse(e){this.payloadHandler&&this.events.removeListener("payload",this.payloadHandler),this.payloadHandler=t=>r(this,void 0,void 0,(function*(){u.logDebug(`CONNECTION @[${(new Date).toUTCString()}] <<<< received e:${t}`);let n=(0,c.safeJsonParse)(t);yield e(n)})),this.events.on("payload",this.payloadHandler)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}send(e,t){return r(this,void 0,void 0,(function*(){"undefined"===typeof this.socket&&(u.logDebug(`>>> send payload undefined ${t}`),yield e());try{u.logDebug(`CONNECTION @[${(new Date).toUTCString()}]>>> send payload ${(0,c.safeJsonStringify)(t)}`),this.socket&&this.socket.send((0,c.safeJsonStringify)(t))}catch(n){this.onError(t.id,n)}}))}getMsgPayloadFromHistory(e){return r(this,void 0,void 0,(function*(){if("undefined"===typeof e)return;let t={params:{data:e}},n=(0,c.safeJsonStringify)(e);u.logDebug("get received data from history"),u.logDebug(n),n=(0,c.safeJsonStringify)(t),this.events.emit("payload",n)}))}onOpen(e){this.openHandler&&this.events.removeListener("open",this.openHandler),this.openHandler=()=>r(this,void 0,void 0,(function*(){u.logDebug(`CONNECTION @[${(new Date).toUTCString()}] >>> ws opened: `),yield e()})),this.events.on("open",this.openHandler)}}t.OKXWalletConnector=f},9908:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,s)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e["default"]=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t},r=this&&this.__awaiter||function(e,t,n,i){function s(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function r(e){try{c(i.next(e))}catch(t){o(t)}}function a(e){try{c(i["throw"](e))}catch(t){o(t)}}function c(e){e.done?n(e.value):s(e.value).then(r,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionManager=void 0;const a=n(86209),c=n(80385),l=n(64321),d=n(27125),u=n(61174),h=n(55282),f=n(43138),p=n(57837),g=n(97737),b=n(40742),_=n(60529),m=o(n(23902)),v=n(23902);class O{constructor(){this.events=new h.EventEmitter,this.connectStorage=new f.Storage(l.OKXCONNECTOR_CACHE_KEY),this.crypto=new g.SessionCrypto,this.jwtKeyPair=this.getCachedJWTKeyPair(),this.saveJWTKeyPair(this.jwtKeyPair),this.connector=new a.OKXWalletConnector(u.OKXCONNECTOR_WS_URL),this.packageId=Date.now(),this.connectedWalletPK="",this.currentTopic="",m.logDebug(`this.connectedWalletPK  constructor   ${this.connectedWalletPK}`)}refreshPackageId(){this.packageId=Date.now()}saveCryptoKeyPair(e){let t=(0,_.safeJsonStringify)(e);this.connectStorage.encryptStoreMsg(t,l.OKXCONNECTOR_CRYPTO_KEY)}getCachedCryptoKeyPair(){const e=this.connectStorage.getAndDecrypt(l.OKXCONNECTOR_CRYPTO_KEY),t=e;if("string"==typeof t){m.logDebug("get cached crypto key:"),m.logDebug(t);let e=(0,_.safeJsonParse)(t);return e}return this.connectStorage.clearCache(),null}saveJWTKeyPair(e){var t={publicKey:(0,p.toHexString)(e.publicKey),secretKey:(0,p.toHexString)(e.secretKey)};m.logDebug("save jwt kp");let n=(0,_.safeJsonStringify)(t);m.logDebug(n),this.connectStorage.encryptStoreMsg(n,l.OKXCONNECTOR_JWT_KEY)}getCachedJWTKeyPair(){const e=this.connectStorage.getAndDecrypt(l.OKXCONNECTOR_JWT_KEY),t=e;if("string"==typeof t){m.logDebug("get cached jwt kp:"),m.logDebug(t);let e=(0,_.safeJsonParse)(t);m.logDebug("save jwt kp"),m.logDebug(e);var n={publicKey:(0,p.hexToByteArray)(e.publicKey),secretKey:(0,p.hexToByteArray)(e.secretKey)};return n}return(0,b.generateKeyPair)()}isWalletPKReady(){return m.logDebug(`isWalletPKReady  ===> ${this.connectedWalletPK}`),this.connectedWalletPK.length>0}makeJWT(e){return r(this,void 0,void 0,(function*(){return yield(0,b.signJWT)(e,d.OKXCONNECTOR_JWT_SIDE,d.OKXCONNECTOR_JWT_TTL,this.jwtKeyPair)}))}parsePackage(e){return r(this,arguments,void 0,(function*(e,t=!1){var n,i,s,o,r;if(this.events.emit(e.id,e),!t){yield this.sendACK(e.id,!0);let t=null===(n=this.connectStorage.getItem(l.OKXCONNECTOR_TOKEN_CACHE))||void 0===n?void 0:n.content;if(t){let n=e;(null===(s=null===(i=n.params)||void 0===i?void 0:i.data)||void 0===s?void 0:s.messageId)&&(this.refreshPackageId(),yield this.sendReceive(this.packageId.toString(),null===(r=null===(o=n.params)||void 0===o?void 0:o.data)||void 0===r?void 0:r.messageId,t))}}}))}restoreConnect(e){return r(this,void 0,void 0,(function*(){if(m.logDebug(`connectionManager  restoreConenct   ${e}`),"string"!==typeof e||0===e.length)throw new Error("CONNECTION: invalid topic");m.logDebug("connectionManager  restoreConenct   disconnect"),yield this.disconnect(!0),this.connectStorage.saveContent(e,l.OKXCONNECTOR_TOKEN_CACHE),m.logDebug("connectionManager  restoreConenct   conect"),yield this.connect(!0)}))}getConnectInfo(){var e=(0,p.generateTopic)();m.logDebug(`generate topic token: ${e}`),this.currentTopic=e;const t={channelId:e,clientId:this.crypto.stringifyKeypair().publicKey};return t}connect(){return r(this,arguments,void 0,(function*(e=!1){this.timeLog=(new Date).getTime(),(0,v.logDebug)("ConnectTime---enter->",this.timeLog);let t=this.connectStorage.getItem(l.OKXCONNECTOR_TOKEN_CACHE);var n=this.currentTopic;if(m.logDebug(`generate topic token: ${n}`),e){"undefined"!==typeof t&&null!==t&&(m.logDebug(`read last connect id: ${t}`),n=t.content);var i=this.connectStorage.getItem(l.OKXCONNECTOR_CRYPTO_SENDER_PK_CACHE);i&&(this.connectedWalletPK=i.content);const e=this.getCachedCryptoKeyPair();this.crypto=new g.SessionCrypto(e)}m.logDebug(`use crypto client id: ${this.crypto.stringifyKeypair().publicKey}`),this.connectStorage.saveContent(n,l.OKXCONNECTOR_TOKEN_CACHE);var s=yield this.makeJWT(n);return m.logDebug(`generate jwt token: ${s}`),this.connectStorage.saveContent(s,"jwt"),new Promise(((e,t)=>{this.connector.onOpen((()=>r(this,void 0,void 0,(function*(){m.logDebug("1. connector on open");const i=(new Date).getTime();(0,v.logDebug)("ConnectTime---open->",i-this.timeLog),this.events.once(this.packageId.toString(),(i=>r(this,void 0,void 0,(function*(){if(i&&i.error){m.logError("failed when login"),yield this.connector.disconnect();var s=new Error;s.message=i.error.message,s.name=i.error.code.toString(),t(s)}this.refreshPackageId(),this.events.once(this.packageId.toString(),(i=>r(this,void 0,void 0,(function*(){if(i&&i.error){m.logError("failed when subscribe"),yield this.connector.disconnect();var s=new Error;s.message=i.error.message,s.name=i.error.code.toString(),t(s)}this.refreshPackageId(),m.logDebug(`4. subscribe callback then send fetch: ${this.packageId}`);const o=(new Date).getTime();(0,v.logDebug)("ConnectTime--subscribe callback->",o-this.timeLog),yield this.sendFetchAndConsumeMessages(this.packageId.toString(),n),e()})))),m.logDebug(`3. login callback then send subscribe: ${this.packageId}`);const o=(new Date).getTime();(0,v.logDebug)("ConnectTime---login callback->",o-this.timeLog),yield this.connector.send((()=>r(this,void 0,void 0,(function*(){m.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}))),{id:this.packageId.toString(),jsonrpc:u.CONNECT_JSONRPC_VER,method:c.CONNECT_METHOD_SUB,params:{topic:n}})})))),m.logDebug("2. login called"),yield this.connector.send((()=>r(this,void 0,void 0,(function*(){m.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}))),{id:this.packageId.toString(),jsonrpc:u.CONNECT_JSONRPC_VER,method:c.CONNECT_METHOD_LOGIN,params:{token:s}}),this.connector.addPackageParse((e=>{var t;if(m.logDebug("connect: parse package"),m.logDebug(e),!("params"in e)||!("data"in e["params"]))return void this.parsePackage(e,!0);let n=null===(t=e.params.data)||void 0===t?void 0:t.message;if("undefined"!==typeof n){n=n.replace(/'/g,'"');let e=(0,_.safeJsonParse)(n);"string"!==typeof e&&"clientId"in e&&e.clientId&&e.clientId.length>0&&(this.connectedWalletPK=e.clientId,m.logDebug(`this.connectedWalletPK  addPackageParse   ${this.connectedWalletPK}`),this.connectStorage.saveContent(this.connectedWalletPK,l.OKXCONNECTOR_CRYPTO_SENDER_PK_CACHE),this.saveCryptoKeyPair(this.crypto.stringifyKeypair()))}this.parsePackage(e,e.method===c.CONNECT_METHOD_RECEIVE)}))})))),this.connector.connect()}))}))}disconnect(){return r(this,arguments,void 0,(function*(e=!1){yield this.connector.disconnect(),this.connectStorage.clearCache(l.OKXCONNECTOR_TOKEN_CACHE),e||(this.connectStorage.clearCache(l.OKXCONNECTOR_CRYPTO_SENDER_PK_CACHE),this.connectedWalletPK="")}))}addListener(e,t,n){this.connector.addListener((0,_.safeJsonStringify)(e),(e=>{if(e=e.replace(/'/g,'"'),m.logDebug(`addListener ===> ${e}`),"undefined"!==typeof e){var t=(0,_.safeJsonParse)(e),n=t.message;t.clientId&&t.clientId.length>0&&(this.connectedWalletPK=t.clientId,this.connectStorage.saveContent(this.connectedWalletPK,l.OKXCONNECTOR_CRYPTO_SENDER_PK_CACHE),m.logDebug(`this.connectedWalletPK  addListener   ${this.connectedWalletPK}`),m.logDebug(`this.cryptoKey  addListener   ${(0,p.toHexString)(this.crypto.keyPair.publicKey)}`),this.saveCryptoKeyPair(this.crypto.stringifyKeypair()));var i=this.crypto.decrypt(n,this.connectedWalletPK);return m.logDebug(`addListener ===> ${i}`),i}}),t,n)}sendRaw(e){return r(this,void 0,void 0,(function*(){m.logDebug(`message send =====> ${e}`);let t=e;m.logDebug(`message send =====encrypt message.length>>>> ${t.length}`);let n=this.connectStorage.getItem(l.OKXCONNECTOR_TOKEN_CACHE);m.logDebug(`message send =====topic>>>> ${null===n||void 0===n?void 0:n.content}`),this.refreshPackageId();const i={id:this.packageId.toString(),method:c.CONNECT_METHOD_PUBLISH,jsonrpc:u.CONNECT_JSONRPC_VER,params:{message:{topic:null===n||void 0===n?void 0:n.content,message:t,ttl:u.OKXCONNECTOR_MESSAGE_TTL}}};return this.events.once(this.packageId.toString(),(e=>r(this,void 0,void 0,(function*(){e&&e.error?m.logError(`@${(new Date).toUTCString()} >>> failed when send msg`):e&&!e.error&&m.logDebug(`CONNECTION @[${(new Date).toUTCString()}] >>> send msg with id ${this.packageId} successed`)})))),yield this.connector.send((()=>r(this,void 0,void 0,(function*(){m.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}))),i),this.packageId}))}send(e){return r(this,void 0,void 0,(function*(){if(m.logDebug(`message send =====> ${e}`),!this.isWalletPKReady())throw new Error("connection not finish");let t=this.crypto.encrypt(e,this.connectedWalletPK);m.logDebug(`message send =====encrypt message.length>>>> ${t.length}`);let n=this.connectStorage.getItem(l.OKXCONNECTOR_TOKEN_CACHE);m.logDebug(`message send =====topic>>>> ${null===n||void 0===n?void 0:n.content}`),this.refreshPackageId();const i={id:this.packageId.toString(),method:c.CONNECT_METHOD_PUBLISH,jsonrpc:u.CONNECT_JSONRPC_VER,params:{message:{topic:null===n||void 0===n?void 0:n.content,message:t,ttl:u.OKXCONNECTOR_MESSAGE_TTL}}};return this.events.once(this.packageId.toString(),(e=>r(this,void 0,void 0,(function*(){e&&e.error?m.logError(`@${(new Date).toUTCString()} >>> failed when send msg`):e&&!e.error&&m.logDebug(`CONNECTION @[${(new Date).toUTCString()}] >>> send msg with id ${this.packageId} successed`)})))),yield this.connector.send((()=>r(this,void 0,void 0,(function*(){m.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}))),i),this.packageId}))}sendACK(e,t){return r(this,arguments,void 0,(function*(e,t,n=void 0){if(!0===t){const t={id:e,jsonrpc:u.CONNECT_JSONRPC_VER,result:!0};yield this.connector.send((()=>r(this,void 0,void 0,(function*(){m.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}))),t)}else if(n){const t={id:e,jsonrpc:u.CONNECT_JSONRPC_VER,error:{code:n.code,message:n.message}};yield this.connector.send((()=>r(this,void 0,void 0,(function*(){m.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}))),t)}}))}sendReceive(e,t,n){return r(this,void 0,void 0,(function*(){const i={id:e,jsonrpc:u.CONNECT_JSONRPC_VER,method:c.CONNECT_METHOD_RECEIVE,params:{data:{messageId:t,topic:n}}};yield this.connector.send((()=>r(this,void 0,void 0,(function*(){m.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}))),i)}))}sendConnectSessionInfo(e,t,n,i){return r(this,void 0,void 0,(function*(){}))}sendFetchAndConsumeMessages(e,t){return r(this,void 0,void 0,(function*(){this.events.once(e,(e=>r(this,void 0,void 0,(function*(){var n,i;if(e.result){var s=e.result.hasMore,o=e.result.data;if(o)for(let e=0;e<o.length;e++){let n=o[e];if(n&&n.topic==t){let e=n.messageId;yield this.connector.getMsgPayloadFromHistory(n),this.refreshPackageId(),yield this.sendReceive(this.packageId.toString(),e,t)}}s&&(this.refreshPackageId(),yield this.sendFetchAndConsumeMessages(this.packageId.toString(),t))}else m.logDebug(`CONNECT: get error rsp ${null===(n=e.error)||void 0===n?void 0:n.code} : ${null===(i=e.error)||void 0===i?void 0:i.message}`)})))),m.logDebug("5. send fetch more");const n=(new Date).getTime();(0,v.logDebug)("ConnectTime---5->",n-this.timeLog);const i={id:e,jsonrpc:u.CONNECT_JSONRPC_VER,method:c.CONNECT_METHOD_FETCHMSG,params:{data:{topic:t}}};yield this.connector.send((()=>r(this,void 0,void 0,(function*(){m.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}))),i)}))}cleanCache(){return r(this,void 0,void 0,(function*(){this.connectStorage.clearCache()}))}saveSessionContent(e,t){t||this.connectStorage.clearCache(l.OKXCONNECTOR_SESSION_PREFIX_KEY+e);let n=(0,_.safeJsonStringify)(t);this.connectStorage.encryptStoreMsg(n,l.OKXCONNECTOR_SESSION_PREFIX_KEY+e)}getSessionContent(e){let t=this.connectStorage.getAndDecrypt(l.OKXCONNECTOR_SESSION_PREFIX_KEY+e);if(t){let e=(0,_.safeJsonParse)(t);return e}}}t.ConnectionManager=O},61174:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectorState=t.CONNECT_JSONRPC_VER=t.OKXCONNECTOR_MESSAGE_TTL=t.OKXCONNECTOR_WS_URL=t.EVENT_EMITTER_MAX_LISTENERS=void 0,t.EVENT_EMITTER_MAX_LISTENERS=10,t.OKXCONNECTOR_WS_URL="wss://wsdexpri.okx.com/ws/v1/wallet-connect-relay",t.OKXCONNECTOR_MESSAGE_TTL=3e5,t.CONNECT_JSONRPC_VER="2.0",t.ConnectorState={InitState:0,Connecting:1,Connected:2,Disconnected:3,OnError:4}},24269:function(e,t,n){"use strict";n(41011),n(27618),n(41011),n(27618);var i=this&&this.__awaiter||function(e,t,n,i){function s(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function r(e){try{c(i.next(e))}catch(t){o(t)}}function a(e){try{c(i["throw"](e))}catch(t){o(t)}}function c(e){e.done?n(e.value):s(e.value).then(r,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Engine=void 0;const s=n(84978),o=n(60529),r=n(23902),a=n(60075),c=n(31364),l=n(31364),d=n(594),u=n(95821);class h{constructor(e){this.pendingRequests=new Map,this.disconnectListener=[],this.connectionManager=e,this.connectionManager.addListener("sdk_response",((e,t)=>{var n=(0,o.safeJsonParse)(t);(0,r.logDebug)(`Engine ==>> addListener ==> success ==> ${n}`),this.handleResponse(e,n)}),(function(){}))}addDisconnectListener(e){this.disconnectListener.push(e)}disconnect(){(0,r.logDebug)("Engine ==>> disconnect"),this.pendingRequests.clear()}getRequestId(){const e=Date.now().toString();return(0,r.logDebug)("Engine ==>> getRequestId ==>",e),e}bindRequestForPromise(e,t){this.pendingRequests.set(e,t)}send(e,t,n){return i(this,void 0,void 0,(function*(){(0,r.logDebug)("Engine ==>> send  request==>",JSON.stringify(e));const i=this.getRequestId();try{let a=yield(0,s.callForSuccess)((()=>this.connectionManager.send(JSON.stringify(Object.assign(Object.assign({},e),{requestId:i})))),n);this.connectionManager.events.once(a.toString(),(e=>{var n;(0,r.logDebug)(`Engine ==> send => onAck => ${(0,o.safeJsonStringify)(e)}`),e&&e.result&&(null===(n=t.onAck)||void 0===n||n.call(t))})),t.resolve&&this.bindRequestForPromise(i,t.resolve)}catch(a){return Promise.reject(a)}}))}sendSession(e){return i(this,void 0,void 0,(function*(){(0,r.logDebug)("[Connect] sendSession called:",e);const t=this.getRequestId();let n={method:"session_info",params:{sessionInfo:e}};yield this.connectionManager.sendRaw(JSON.stringify(Object.assign(Object.assign({},n),{requestId:t})))}))}handleResponse(e,t){if((0,r.logDebug)(`Engine ==>> handleResponse_1  ======>response: ${(0,o.safeJsonStringify)(t)}`,e),"requestId"in t){(0,r.logDebug)("Engine ==>> handleResponse_2  ===> in response");let e=t.requestId;const n=this.pendingRequests.get(e);n?((0,r.logDebug)("Engine ==>> handleResponse_3  ===> find resolve:",n),n(t),this.pendingRequests.delete(e)):((0,r.logDebug)("Engine ==>> handleResponse_3  ===> not find resolve:"),"disconnect"===t.method&&(this.disconnectListener.forEach((e=>e())),this.disconnectListener=[],this.disconnect()))}}restoreconnect(e,t){return i(this,void 0,void 0,(function*(){var n;yield null===(n=this.connectionManager)||void 0===n?void 0:n.restoreConnect(e.topic),t(e)}))}conect(e,t,n){return i(this,void 0,void 0,(function*(){var i,s;const o=this.connectionManager.getConnectInfo(),d=this.getRequestId();let u=null!==(i=t.openUniversalUrl)&&void 0!==i&&i;const h={protocolVer:Number(a.tonConnectSdkVersion),topic:o.channelId,clientId:o.clientId,requestId:d,dAppInfo:t.dappInfo,requests:e},f=JSON.stringify(h),p=(new TextEncoder).encode(f),g=btoa(String.fromCharCode(...p)),b=`${a.standardDeeplink}?param=${g}`;(0,r.logDebug)("engine ==>> connect ==>>deeplinkUrl:",b);const _=(0,l.isIos)();return(0,r.logDebug)(`engine ==>> connect ==>>isIOS: ${_}   openUniversalLink: ${u}`),_&&u&&((0,r.logDebug)("bridge-provider ==>> connect_3"),(0,c.openOKXDeeplinkWithFallback)(b)),yield null===(s=this.connectionManager)||void 0===s?void 0:s.disconnect(!1),this.bindRequestForPromise(d,(e=>{let i=this.onConnect(e,t,o.channelId);n(i,e)})),yield this.connectionManager.connect(),!_&&u&&((0,r.logDebug)("bridge-provider ==>> connect_4"),(0,c.openOKXDeeplinkWithFallback)(b)),{connectInfo:o,deeplinkUrl:(0,c.getUniversalLink)(b)}}))}onConnect(e,t,n){if("connect"==e.method){let i=(0,d.buildNameSpacesByConnectResponse)(e);if(i){let e={topic:n,sessionConfig:t,namespaces:i};return e}}return null}universalConnect(e,t,n){return i(this,void 0,void 0,(function*(){return new Promise(((s,o)=>i(this,void 0,void 0,(function*(){var i,h,f,p;try{(0,r.logDebug)("engine universalConnect request :",JSON.stringify(e)),(0,r.logDebug)("engine universalConnect sessionConfig :",JSON.stringify(t));let b=[],_=[];e.forEach((e=>{let t=e.name;t.startsWith("requestAccounts")?_.push(e):t.startsWith("ton")&&b.push(e)})),(0,r.logDebug)("engine universalConnect tonRequest :",JSON.stringify(b)),(0,r.logDebug)("engine universalConnect universalRequest :",JSON.stringify(_));const m=this.connectionManager.getConnectInfo(),v=this.getRequestId();let O=null!==(i=t.openUniversalUrl)&&void 0!==i&&i;const y={protocolVer:Number(a.tonConnectSdkVersion),topic:m.channelId,clientId:m.clientId,requestId:v,dAppInfo:t.dappInfo,requests:_},C=(0,u.encodeConnectParams)(y);y.redirect=null!==(h=null===t||void 0===t?void 0:t.redirect)&&void 0!==h?h:"none";const E={protocolVer:Number(a.tonConnectSdkVersion),topic:m.channelId,clientId:m.clientId,requestId:v,dAppInfo:t.dappInfo,requests:b,redirect:null!==(f=null===t||void 0===t?void 0:t.redirect)&&void 0!==f?f:"none"};let N=!1;b.length>0&&(N=!0);let w=N?E:y;(0,r.logDebug)("engine universalConnect ==>>defaultConnectRequest:",N,JSON.stringify(w));var g="";if(O){const e=(0,u.encodeConnectParams)(w);g=`${a.standardDeeplink}?param=${e}`}(0,r.logDebug)("engine universalConnect ==>>deeplinkUrl:",g);const R=(0,l.isIos)();if(R&&O&&((0,r.logDebug)(`engine universalConnect ==>>isIOS: ${R}   openUniversalLink: ${O}`),(0,c.openOKXDeeplinkWithFallback)(g)),yield null===(p=this.connectionManager)||void 0===p?void 0:p.disconnect(!1),this.bindRequestForPromise(v,(e=>{var n,i;try{let o=e;if("connect"==o.method){(0,r.logDebug)("engin  universalConnect success connectResponse:>>>",JSON.stringify(o));let e=(0,d.buildNameSpacesByConnectResponse)(o);if(!e)throw new a.OKXConnectError(a.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR);{let i={topic:m.channelId,sessionConfig:t,namespaces:e,wallet:Object.assign({},null===(n=o.payload)||void 0===n?void 0:n.wallet)};(0,r.logDebug)("engin  universalConnect success session:>>>",JSON.stringify(i)),s(i)}}else if("connect_error"==o.method&&(null===(i=o.payload)||void 0===i?void 0:i.code))throw new a.OKXConnectError(o.payload.code)}catch(c){o(c)}})),yield this.connectionManager.connect(),!R&&O&&(0,c.openOKXDeeplinkWithFallback)(g),(0,r.logDebug)("engin  universalConnect ==>> connectInfoAndUrl:",n),this.sendSession(C),n){const e={connectRequest:y,redirect:t.redirect,tmaReturnUrl:t.tmaReturnUrl};N&&(e.tonConnectRequest=E),(0,r.logDebug)("universalConnect connectInfoAndUrl info :",JSON.stringify(e)),n(e)}}catch(b){o(b)}}))))}))}}t.Engine=h},94643:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Storage=t.Engine=t.WalletConnectionManager=t.ConnectionManager=t.OKXWalletConnector=void 0;var i=n(86209);Object.defineProperty(t,"OKXWalletConnector",{enumerable:!0,get:function(){return i.OKXWalletConnector}});var s=n(9908);Object.defineProperty(t,"ConnectionManager",{enumerable:!0,get:function(){return s.ConnectionManager}});var o=n(57519);Object.defineProperty(t,"WalletConnectionManager",{enumerable:!0,get:function(){return o.WalletConnectionManager}});var r=n(24269);Object.defineProperty(t,"Engine",{enumerable:!0,get:function(){return r.Engine}});var a=n(43138);Object.defineProperty(t,"Storage",{enumerable:!0,get:function(){return a.Storage}})},40742:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,s)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e["default"]=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t},r=this&&this.__awaiter||function(e,t,n,i){function s(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function r(e){try{c(i.next(e))}catch(t){o(t)}}function a(e){try{c(i["throw"](e))}catch(t){o(t)}}function c(e){e.done?n(e.value):s(e.value).then(r,a)}c((i=i.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MULTICODEC_ED25519_LENGTH=t.MULTICODEC_ED25519_HEADER=t.MULTICODEC_ED25519_BASE=t.MULTICODEC_ED25519_ENCODING=t.DID_METHOD=t.DID_PREFIX=t.DID_DELIMITER=t.KEY_PAIR_SEED_LENGTH=t.DATA_ENCODING=t.JSON_ENCODING=t.JWT_ENCODING=t.JWT_DELIMITER=t.JWT_IRIDIUM_TYP=t.JWT_IRIDIUM_ALG=t.JWTHeaderType=void 0,t.generateKeyPair=p,t.decodeJSON=g,t.encodeJSON=b,t.encodeIss=_,t.decodeIss=m,t.encodeSig=v,t.decodeSig=O,t.encodeData=y,t.decodeData=C,t.encodeJWT=E,t.decodeJWT=N,t.signJWT=w,t.verifyJWT=R;const c=o(n(25806)),l=n(60529),d=n(57837),u=a(n(77361)),h=o(n(23902)),f=n(98650);function p(){return u.default.sign.keyPair()}function g(e){return(0,l.safeJsonParse)((0,f.okxtoString)((0,f.okxfromString)(e,t.JWT_ENCODING),t.JSON_ENCODING))}function b(e){return(0,f.okxtoString)((0,f.okxfromString)((0,l.safeJsonStringify)(e),t.JSON_ENCODING),t.JWT_ENCODING)}function _(e){h.logDebug(`publicKey: ${(0,d.toHexString)(e)}`);var n=(0,f.okxtoString)(e,t.MULTICODEC_ED25519_ENCODING);return[t.DID_PREFIX,t.DID_METHOD,n].join(t.DID_DELIMITER)}function m(e){const[n,i,s]=e.split(t.DID_DELIMITER);if(n!==t.DID_PREFIX||i!==t.DID_METHOD)throw new Error('Issuer must be a DID with method "key"');if(void 0===s)throw new Error("multicodec is undefined");const o=(0,f.okxfromString)(s,t.MULTICODEC_ED25519_ENCODING);if(void 0===o||o.length!==t.MULTICODEC_ED25519_LENGTH)throw new Error("Issuer must be a public key with length 32 bytes");return o}function v(e){return(0,f.okxtoString)(e,t.JWT_ENCODING)}function O(e){return(0,f.okxfromString)(e,t.JWT_ENCODING)}function y(e){return(0,f.okxfromString)([b(e.header),b(e.payload)].join(t.JWT_DELIMITER),t.DATA_ENCODING)}function C(e){var n,i;const s=(0,f.okxtoString)(e,t.DATA_ENCODING).split(t.JWT_DELIMITER),o=g(null!==(n=s[0])&&void 0!==n?n:"{}"),r=g(null!==(i=s[1])&&void 0!==i?i:"{}");return{header:o,payload:r}}function E(e){return[b(e.header),b(e.payload),v(e.signature)].join(t.JWT_DELIMITER)}function N(e){var n,i,s;const o=e.split(t.JWT_DELIMITER),r=g(null!==(n=o[0])&&void 0!==n?n:"{}"),a=g(null!==(i=o[1])&&void 0!==i?i:"{}"),c=O(null!==(s=o[2])&&void 0!==s?s:"{}"),l=(0,f.okxfromString)(o.slice(0,2).join(t.JWT_DELIMITER),t.DATA_ENCODING);return{header:r,payload:a,signature:c,data:l}}function w(e,n,i,s){return r(this,arguments,void 0,(function*(e,n,i,s,o=Math.floor(Date.now())){const r={alg:t.JWT_IRIDIUM_ALG,typ:t.JWT_IRIDIUM_TYP},a=_(s.publicKey),c=o+i,l="authenticate user",d={iss:a,sub:e,aud:n,act:l,iat:o,exp:c},f=y({header:r,payload:d});h.logDebug(`get sec kp: ${s.secretKey} {${s.secretKey.length}}`);const p=u.default.sign.detached(f,s.secretKey);return E({header:r,payload:d,signature:p})}))}function R(e){return r(this,void 0,void 0,(function*(){const{header:n,payload:i,data:s,signature:o}=N(e);if(n.alg!==t.JWT_IRIDIUM_ALG||n.typ!==t.JWT_IRIDIUM_TYP)throw new Error("JWT must use EdDSA algorithm");const r=m(i.iss);return c.verify(r,s,o)}))}t.JWTHeaderType="dapp",t.JWT_IRIDIUM_ALG="EdDSA",t.JWT_IRIDIUM_TYP="JWT",t.JWT_DELIMITER=".",t.JWT_ENCODING="base64url",t.JSON_ENCODING="utf8",t.DATA_ENCODING="utf8",t.KEY_PAIR_SEED_LENGTH=32,t.DID_DELIMITER=":",t.DID_PREFIX="did",t.DID_METHOD="key",t.MULTICODEC_ED25519_ENCODING="base58btc",t.MULTICODEC_ED25519_BASE="z",t.MULTICODEC_ED25519_HEADER="K36",t.MULTICODEC_ED25519_LENGTH=32},27125:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OKXCONNECTOR_JWT_TTL=t.OKXCONNECTOR_JWT_WALLET_SIDE=t.OKXCONNECTOR_JWT_SIDE=void 0,t.OKXCONNECTOR_JWT_SIDE="wallet",t.OKXCONNECTOR_JWT_WALLET_SIDE="dapp",t.OKXCONNECTOR_JWT_TTL=864e5},594:function(e,t,n){"use strict";n(41011),n(41011),Object.defineProperty(t,"__esModule",{value:!0}),t.buildNameSpacesByConnectResponse=s,t.buildRequestAccountNameSpacesByConnectResponse=o;const i=n(23902);function s(e){let t=o(e);return t}function o(e){let t={};(0,i.logDebug)("buildRequestAccountNameSpacesByConnectResponse start connectResponse>>",JSON.stringify(e));let n=e.payload.responses.find((e=>"requestAccounts"===e.name));const s=e.payload.responses.find((e=>"ton_addr"===e.name)),o=e.payload.responses.find((e=>"ton_proof"===e.name));if(s&&!n){(0,i.logDebug)("buildRequestAccountNameSpacesByConnectResponse adapt ton data >>");let e=s.address;e="ton:"+s.network+":"+e;let t={ton_addr:s};o&&(t.ton_proof=o),n={name:"requestAccounts",accounts:[{namespace:"ton",addresses:[e],methods:["ton_sendTransaction"],extra:{},data:t}]}}return(0,i.logDebug)("buildRequestAccountNameSpacesByConnectResponse end universalResponse>>>",JSON.stringify(n)),n.accounts.forEach((e=>{var n=[],s=[];e.addresses.forEach((e=>{var t=e.split(":");if((0,i.logDebug)("buildRequestAccountNameSpacesByConnectResponse addressArr>>",t.length),t.length>=3){let o=t.slice(0,2).join(":");n.push(o),s.push(e),(0,i.logDebug)("buildRequestAccountNameSpacesByConnectResponse chain:>>",o,"addressItem:",e)}})),e.data&&e.data.ton_addr&&(e.data.ton_addr.name="ton_addr"),e.data&&e.data.ton_proof&&(e.data.ton_proof.name="ton_proof"),t[e.namespace]={chains:n,accounts:s,methods:e.methods,extra:e.extra,payload:e.data},(0,i.logDebug)("buildRequestAccountNameSpacesByConnectResponse result>>",JSON.stringify(t))})),t}},43138:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,s)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e["default"]=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Storage=void 0;const a=n(64321),c=r(n(77361)),l=n(57837),d=n(31364),u=o(n(23902)),h=n(31364),f=n(50054);class p{constructor(e){const t=(0,l.resolveLocalStorage)();this.storeKey="",this.cipherIV="",this.subKey=e,u.logDebug("--------get current local storage --------"),u.logDebug(t);const n=t.getItem(p.cacheKey+e);if("undefined"===typeof n||null===n)return u.logDebug("with no cache"),void(this.cache={});if(u.logDebug(n),(null===n||void 0===n?void 0:n.length)>0){var i=(0,d.safeJsonParse)(n);this.cache=i}u.logDebug(`get cache obj: ${this.cache}`),"undefined"!==typeof this.cache&&null!=this.cache||(this.cache={})}saveContent(e,t,n="-"){let i={id:n,timestamp:Date.now().toString(),content:e};this.saveItem(i,t)}saveItem(e,t){let n=p.cacheKey+this.subKey;const i=(0,l.resolveLocalStorage)();u.logDebug(this.cache),u.logDebug(`get cache obj: ${this.cache}, ${t}, ${e}`),this.cache[t]=e;let s=(0,d.safeJsonStringify)(this.cache);u.logDebug(`STORAGE: ${t} @ ${this.cache}`),i.setItem(n,s)}getItem(e){return u.logDebug(`STORAGE >> getItem: ${e} @ ${this.cache}`),this.cache[e]}getCachedPBKDF2InfoKey(){var e,t,n,i;const s=32,o=24;if(this.storeKey.length>0&&(null===(e=this.cipherIV)||void 0===e?void 0:e.length)>0)return{pw:this.storeKey,iv:this.cipherIV};let r=null===(t=this.getItem(a.OKXCONNECTOR_STORAGER_CRYPTO_SALT))||void 0===t?void 0:t.content;r||(r=(0,l.toHexString)(c.default.randomBytes(o)),this.saveContent(r,a.OKXCONNECTOR_STORAGER_CRYPTO_SALT));let d=null===(n=this.getItem(a.OKXCONNECTOR_STORAGE_CRYPTO_PASSWORD))||void 0===n?void 0:n.content;d||(d=(0,l.toHexString)(c.default.randomBytes(s)),this.saveContent(d,a.OKXCONNECTOR_STORAGE_CRYPTO_PASSWORD));let u=null===(i=this.getItem(a.OKXCONNECTOR_STORAGE_CRYPTO_CIPHERIV))||void 0===i?void 0:i.content;if(!u){let e=c.default.randomBytes(16);u=(0,l.toHexString)(e),this.saveContent(u,a.OKXCONNECTOR_STORAGE_CRYPTO_CIPHERIV)}return this.cipherIV=u,this.storeKey=(0,f.PBKDF2)(d,r,{iterations:10}).toString(),{pw:this.storeKey,iv:this.cipherIV}}encryptStoreMsg(e,t){(0,h.logDebug)(`encryptStoreMsg  encryptStoreMsg start ${Date.now()}`);let n=this.getCachedPBKDF2InfoKey();(0,h.logDebug)(`encryptStoreMsg  encryptStoreMsg mid ${Date.now()}`);var i=f.AES.encrypt(e,n.pw).toString();this.saveContent(i,t),(0,h.logDebug)(`encryptStoreMsg  encryptStoreMsg end ${Date.now()}`)}getAndDecrypt(e){(0,h.logDebug)(`encryptStoreMsg  getAndDecrypt start ${Date.now()}`);let t=this.getItem(e);if(t&&t.content){let e=this.getCachedPBKDF2InfoKey();(0,h.logDebug)(`encryptStoreMsg  getAndDecrypt mid ${Date.now()}`);let n=f.AES.decrypt(t.content,e.pw).toString(f.enc.Utf8);return(0,h.logDebug)(`encryptStoreMsg  getAndDecrypt end ${Date.now()}`),n}return null}clearCache(e=void 0){if(void 0===e){this.cache={};let e=p.cacheKey+this.subKey;localStorage.setItem(e,"")}else{let t=p.cacheKey+this.subKey;const n=(0,l.resolveLocalStorage)();u.logDebug(this.cache),this.cache[e]=null;let i=(0,d.safeJsonStringify)(this.cache);u.logDebug(`STORAGE: clean key ${e} @ ${this.cache}`),n.setItem(t,i)}}}t.Storage=p,p.cacheKey="OKXStorageKey"},64321:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OKXCONNECTOR_STORAGE_CIPHER_METHOD=t.OKXCONNECTOR_STORAGE_CRYPTO_CIPHERIV=t.OKXCONNECTOR_STORAGER_CRYPTO_SALT=t.OKXCONNECTOR_STORAGE_CRYPTO_PASSWORD=t.OKXCONNECTOR_TON_KEY=t.OKXCONNECTOR_CRYPTO_SENDER_PK_CACHE=t.OKXCONNECTOR_TOKEN_CACHE=t.OKXCONNECTOR_JWT_KEY=t.OKXCONNECTOR_SESSION_PREFIX_KEY=t.OKXCONNECTOR_CRYPTO_KEY=t.OKXCONNECTOR_CACHE_KEY=void 0,t.OKXCONNECTOR_CACHE_KEY="ck",t.OKXCONNECTOR_CRYPTO_KEY="cck_k",t.OKXCONNECTOR_SESSION_PREFIX_KEY="cspk_",t.OKXCONNECTOR_JWT_KEY="cjk_k",t.OKXCONNECTOR_TOKEN_CACHE="ct",t.OKXCONNECTOR_CRYPTO_SENDER_PK_CACHE="csp",t.OKXCONNECTOR_TON_KEY="OKXStorage_ctc",t.OKXCONNECTOR_STORAGE_CRYPTO_PASSWORD="scp",t.OKXCONNECTOR_STORAGER_CRYPTO_SALT="scs",t.OKXCONNECTOR_STORAGE_CRYPTO_CIPHERIV="scpc",t.OKXCONNECTOR_STORAGE_CIPHER_METHOD="aes-256-cbc"},90465:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WalletConnectionManagerEvent=t.WalletConnectionManagerTopicInfoCacheKey=void 0,t.WalletConnectionManagerTopicInfoCacheKey="wcmtic",t.WalletConnectionManagerEvent={RECEIVE_REQUEST:"payload"}},57519:function(e,t,n){"use strict";n(41011),n(41011);var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,s)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e["default"]=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t},r=this&&this.__awaiter||function(e,t,n,i){function s(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function r(e){try{c(i.next(e))}catch(t){o(t)}}function a(e){try{c(i["throw"](e))}catch(t){o(t)}}function c(e){e.done?n(e.value):s(e.value).then(r,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.WalletConnectionManager=void 0;const a=n(86209),c=n(80385),l=n(64321),d=n(27125),u=n(61174),h=n(90465),f=n(55282),p=n(43138),g=n(57837),b=n(97737),_=n(40742),m=n(60529),v=o(n(23902)),O=n(23902);class y{constructor(){this.events=new f.EventEmitter,this.communicateEvents=new f.EventEmitter,v.logDebug("connect manager construct"),this.connectStorage=new p.Storage(l.OKXCONNECTOR_CACHE_KEY),this.jwtKeyPair=this.getCachedJWTKeyPair(),this.saveJWTKeyPair(this.jwtKeyPair),this.connector=new a.OKXWalletConnector(u.OKXCONNECTOR_WS_URL),this.packageId=Date.now(),this.sessionCryptoInfoMap=new Map,this.inLogin=!1,this.isLogined=!1}refreshPackageId(e=0){this.packageId=Date.now()+e}saveCryptoKeyPair(e,t){let n=(0,m.safeJsonStringify)(t);this.connectStorage.encryptStoreMsg(n,l.OKXCONNECTOR_CRYPTO_KEY+e)}getCachedCryptoKeyPair(e){const t=this.connectStorage.getAndDecrypt(l.OKXCONNECTOR_CRYPTO_KEY+e),n=t;if("string"==typeof n){v.logDebug("get cached crypto key:"),v.logDebug(n);let e=(0,m.safeJsonParse)(n);return e}return this.connectStorage.clearCache(),null}saveJWTKeyPair(e){var t={publicKey:(0,g.toHexString)(e.publicKey),secretKey:(0,g.toHexString)(e.secretKey)};v.logDebug("save jwt kp");let n=(0,m.safeJsonStringify)(t);v.logDebug(n),this.connectStorage.encryptStoreMsg(n,l.OKXCONNECTOR_JWT_KEY),v.logDebug("after save jwt kp")}getCachedJWTKeyPair(){const e=this.connectStorage.getAndDecrypt(l.OKXCONNECTOR_JWT_KEY),t=e;if("string"==typeof t){v.logDebug("get cached jwt kp:"),v.logDebug(t);let e=(0,m.safeJsonParse)(t);v.logDebug("save jwt kp"),v.logDebug(e);var n={publicKey:(0,g.hexToByteArray)(e.publicKey),secretKey:(0,g.hexToByteArray)(e.secretKey)};return n}return(0,_.generateKeyPair)()}isTopicPublicKeyExist(e){return v.logDebug(`isTopicPublicKeyExist  ===> ${e}`),this.sessionCryptoInfoMap.get(e)}makeJWT(e){return r(this,void 0,void 0,(function*(){return yield(0,_.signJWT)(e,d.OKXCONNECTOR_JWT_WALLET_SIDE,d.OKXCONNECTOR_JWT_TTL,this.jwtKeyPair)}))}parsePackage(e,t){return r(this,arguments,void 0,(function*(e,t,n=!1){var i,s,o,r,a,c,l,d;this.events.emit(t.id,t);let u=this.sessionCryptoInfoMap.get(e);if(v.logDebug("get sessionInfo for decrypt topic:",e),v.logDebug("get sessionInfo for decrypt:",t.id,e,u,this.sessionCryptoInfoMap),u&&t.params.data&&(null===(i=t.params.data)||void 0===i?void 0:i.message))try{var h=null===(s=t.params.data)||void 0===s?void 0:s.message;let n=(0,m.safeJsonParse)(h);if(n.method)(0,O.logDebug)("<<< parse raw msg:",e,n),this.communicateEvents.emit(e,h);else{h=u.crypto.decryptWallet(null===(o=t.params.data)||void 0===o?void 0:o.message,u.dappPublicKey);(0,O.logDebug)("<<< receive msg:",e,h),this.communicateEvents.emit(e,h)}}catch(f){h=u.crypto.decryptWallet(null===(r=t.params.data)||void 0===r?void 0:r.message,u.dappPublicKey);(0,O.logDebug)("<<< receive msg:",e,h),this.communicateEvents.emit(e,h)}if(!n&&(yield this.sendACK(t.id,!0),e)){let n=t;(null===(c=null===(a=n.params)||void 0===a?void 0:a.data)||void 0===c?void 0:c.messageId)&&(this.refreshPackageId(),yield this.sendReceive(this.packageId.toString(),null===(d=null===(l=n.params)||void 0===l?void 0:l.data)||void 0===d?void 0:d.messageId,e))}}))}recovrySessionInfoFromCache(){let e=this.connectStorage.getAndDecrypt(h.WalletConnectionManagerTopicInfoCacheKey);if(v.logDebug("get cached sessionInfos:",e),e){let t=(0,m.safeJsonParse)(e);for(let e in t){let n=t[e];v.logDebug("make topicItem:",n);let i={topic:e,crypto:new b.SessionCrypto({publicKey:n.cryptoKeyPair.publicKey,secretKey:n.cryptoKeyPair.secretKey}),dappPublicKey:n.dappPublicKey};this.sessionCryptoInfoMap.set(e,i)}}v.logDebug("get cached sessionInfos map:",this.sessionCryptoInfoMap)}syncCacheSessionInfo(){let e={};for(let[n,i]of this.sessionCryptoInfoMap)v.logDebug("for each Keys",n),i&&(e[n]={cryptoKeyPair:i.crypto.stringifyKeypair(),dappPublicKey:i.dappPublicKey});let t=(0,m.safeJsonStringify)(e);v.logDebug("sync cache sessionInfos:",t),this.connectStorage.encryptStoreMsg(t,h.WalletConnectionManagerTopicInfoCacheKey)}cacheSessionInfo(e,t,n=!0){let i=t.dappPublicKey,s=[];for(let[o,r]of this.sessionCryptoInfoMap)v.logDebug("for each Keys",o),r.dappPublicKey==i&&(v.logDebug("duplicated dapp public key:",o,i),s.push(o));for(let[o,r]of this.sessionCryptoInfoMap)s.includes(o)&&this.sessionCryptoInfoMap.delete(o);return v.logDebug("cleaned connect session cache:",this.sessionCryptoInfoMap),this.sessionCryptoInfoMap.set(e,t),v.logDebug("cache sessionInfo:",e,t,this.sessionCryptoInfoMap),n&&this.syncCacheSessionInfo(),s}appendTopic(e,t){return r(this,void 0,void 0,(function*(){return(0,O.logDebug)("4.1. get append Topic:",e),new Promise(((n,i)=>r(this,void 0,void 0,(function*(){if(!this.isLogined){var s=new Error;return s.message="connection is not logined",s.name="append error",void i(s)}yield this.subscribeTopics(Array.from([e]));let o={topic:e,crypto:new b.SessionCrypto,dappPublicKey:t},r=this.cacheSessionInfo(e,o,!1);this.refreshPackageId(),v.logDebug(`5. subscribe callback then fetch append message: ${this.packageId}, ${e}`);const a=(new Date).getTime();(0,O.logDebug)("Append --subscribe callback->",a-this.timeLog),n(r)}))))}))}confirmAppendingTopics(){this.syncCacheSessionInfo()}connect(){return r(this,void 0,void 0,(function*(){this.timeLog=(new Date).getTime(),(0,O.logDebug)("[Wallet] ConnectTime---enter->",this.timeLog);let e=Date.now().toString();var t=yield this.makeJWT(e);return v.logDebug(`generate jwt token: ${t}`),this.connectStorage.saveContent(t,"jwt"),this.recovrySessionInfoFromCache(),new Promise(((e,n)=>{this.inLogin=!0,this.connector.onOpen((()=>r(this,void 0,void 0,(function*(){v.logDebug("1. connector on open");const i=(new Date).getTime();(0,O.logDebug)("ConnectTime---open->",i-this.timeLog),this.events.once(this.packageId.toString(),(t=>r(this,void 0,void 0,(function*(){if(t&&t.error){v.logError("failed when login"),yield this.connector.disconnect();var i=new Error;i.message=t.error.message,i.name=t.error.code.toString(),n(i)}else this.isLogined=!0,e(),v.logDebug("3. subscribe cached topics",this.sessionCryptoInfoMap),this.sessionCryptoInfoMap.size>0&&(yield this.subscribeTopics(Array.from(this.sessionCryptoInfoMap.keys())))})))),v.logDebug("2. login called"),yield this.connector.send((()=>r(this,void 0,void 0,(function*(){v.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}))),{id:this.packageId.toString(),jsonrpc:u.CONNECT_JSONRPC_VER,method:c.CONNECT_METHOD_LOGIN,params:{token:t}})})))),this.connector.connect(),this.connector.addPackageParse((e=>{var t,n;v.logDebug("connect: parse package"),v.logDebug(e),"params"in e&&"data"in e["params"]?(null===(t=e.params.data)||void 0===t?void 0:t.topic)&&this.parsePackage(null===(n=e.params.data)||void 0===n?void 0:n.topic,e,e.method===c.CONNECT_METHOD_RECEIVE):this.parsePackage("",e,!0)}))}))}))}getSessionPublicKey(e){if(this.isTopicPublicKeyExist(e)){let t=this.sessionCryptoInfoMap.get(e);if(t)return(0,g.toHexString)(t.crypto.keyPair.publicKey)}}getCurrentCachedTopicIdList(){return Array.from(this.sessionCryptoInfoMap.keys())}disconnect(){return r(this,arguments,void 0,(function*(e=!1){yield this.connector.disconnect(),this.connectStorage.clearCache(l.OKXCONNECTOR_TOKEN_CACHE),e||this.connectStorage.clearCache(l.OKXCONNECTOR_CRYPTO_SENDER_PK_CACHE)}))}send(e,t){return r(this,arguments,void 0,(function*(e,t,n=!1){var i,s;if(v.logDebug(`message send =====> ${t}`),!this.isTopicPublicKeyExist(e))throw new Error("connection not finish");let o=null===(i=this.sessionCryptoInfoMap.get(e))||void 0===i?void 0:i.dappPublicKey,a=null===(s=this.sessionCryptoInfoMap.get(e))||void 0===s?void 0:s.crypto;if(a&&o){let i=a.encryptWallet(t,o),s={message:i};n&&(s.clientId=(0,g.toHexString)(a.keyPair.publicKey)),this.refreshPackageId();const l={id:this.packageId.toString(),method:c.CONNECT_METHOD_PUBLISH,jsonrpc:u.CONNECT_JSONRPC_VER,params:{message:{topic:e,message:(0,m.safeJsonStringify)(s),ttl:u.OKXCONNECTOR_MESSAGE_TTL}}};return this.events.once(this.packageId.toString(),(e=>r(this,void 0,void 0,(function*(){e&&e.error?v.logError(`@${(new Date).toUTCString()} >>> failed when send msg`):e&&!e.error&&v.logDebug(`CONNECTION @[${(new Date).toUTCString()}] >>> send msg with id ${this.packageId} successed`)})))),yield this.connector.send((()=>r(this,void 0,void 0,(function*(){v.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}))),l),this.packageId}}))}sendACK(e,t){return r(this,arguments,void 0,(function*(e,t,n=void 0){if(!0===t){const t={id:e,jsonrpc:u.CONNECT_JSONRPC_VER,result:!0};yield this.connector.send((()=>r(this,void 0,void 0,(function*(){v.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}))),t)}else if(n){const t={id:e,jsonrpc:u.CONNECT_JSONRPC_VER,error:{code:n.code,message:n.message}};yield this.connector.send((()=>r(this,void 0,void 0,(function*(){v.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}))),t)}}))}sendReceive(e,t,n){return r(this,void 0,void 0,(function*(){const i={id:e,jsonrpc:u.CONNECT_JSONRPC_VER,method:c.CONNECT_METHOD_RECEIVE,params:{data:{messageId:t,topic:n}}};yield this.connector.send((()=>r(this,void 0,void 0,(function*(){v.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}))),i)}))}sendUnsubscribe(e){return r(this,void 0,void 0,(function*(){yield this.connector.send((()=>r(this,void 0,void 0,(function*(){v.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}))),{id:this.packageId.toString(),jsonrpc:u.CONNECT_JSONRPC_VER,method:c.CONNECT_METHOD_UNSUB,params:{topic:e}}),this.sessionCryptoInfoMap.delete(e),this.syncCacheSessionInfo()}))}sendFetchAndConsumeMessages(e,t){return r(this,void 0,void 0,(function*(){this.events.once(e,(e=>r(this,void 0,void 0,(function*(){var n,i;if(e.result){var s=e.result.hasMore,o=e.result.data;if(o)for(let e=0;e<o.length;e++){let n=o[e];if(n&&n.topic==t){let e=n.messageId;yield this.connector.getMsgPayloadFromHistory(n),this.refreshPackageId(),yield this.sendReceive(this.packageId.toString(),e,t)}}s&&(this.refreshPackageId(),yield this.sendFetchAndConsumeMessages(this.packageId.toString(),t))}else v.logDebug(`CONNECT: get error rsp ${null===(n=e.error)||void 0===n?void 0:n.code} : ${null===(i=e.error)||void 0===i?void 0:i.message}`)})))),v.logDebug("5. send fetch more");const n=(new Date).getTime();(0,O.logDebug)("ConnectTime---5->",n-this.timeLog);const i={id:e,jsonrpc:u.CONNECT_JSONRPC_VER,method:c.CONNECT_METHOD_FETCHMSG,params:{data:{topic:t}}};yield this.connector.send((()=>r(this,void 0,void 0,(function*(){v.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}))),i)}))}cleanCache(){return r(this,void 0,void 0,(function*(){this.connectStorage.clearCache()}))}saveSessionContent(e,t){t||this.connectStorage.clearCache(l.OKXCONNECTOR_SESSION_PREFIX_KEY+e);let n=(0,m.safeJsonStringify)(t);this.connectStorage.encryptStoreMsg(n,l.OKXCONNECTOR_SESSION_PREFIX_KEY+e)}getSessionContent(e){let t=this.connectStorage.getAndDecrypt(l.OKXCONNECTOR_SESSION_PREFIX_KEY+e);if(t){let e=(0,m.safeJsonParse)(t);return e}}subscribeTopics(e){return r(this,void 0,void 0,(function*(){return(0,O.logDebug)("4.2 topicid list",e),new Promise(((t,n)=>r(this,void 0,void 0,(function*(){let n=0;for(let i=0;i<e.length;++i){let s=e[i];this.refreshPackageId(i),this.events.once(this.packageId.toString(),(o=>r(this,void 0,void 0,(function*(){if(o&&o.error){v.logError("failed when subscribe"),yield this.connector.disconnect();var r=new Error;r.message=o.error.message,r.name=o.error.code.toString(),n+=1,n==e.length&&t()}this.refreshPackageId(i),v.logDebug(`4. subscribe callback then send fetch: ${this.packageId}, ${s}`);const a=(new Date).getTime();(0,O.logDebug)("ConnectTime--subscribe callback->",a-this.timeLog),yield this.sendFetchAndConsumeMessages(this.packageId.toString(),s),n+=1,n==e.length&&t()})))),v.logDebug(`3. login callback then send subscribe: ${this.packageId}, ${s}`);const o=(new Date).getTime();(0,O.logDebug)("ConnectTime---login callback->",o-this.timeLog),yield this.connector.send((()=>r(this,void 0,void 0,(function*(){v.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}))),{id:this.packageId.toString(),jsonrpc:u.CONNECT_JSONRPC_VER,method:c.CONNECT_METHOD_SUB,params:{topic:s}})}}))))}))}}t.WalletConnectionManager=y},97737:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SessionCrypto=void 0;const s=i(n(77361)),o=n(57837);class r{constructor(e=void 0){this.nonceLength=24,this.sessionKeyPair=e?this.createKeypairFromString(e):this.createKeypair()}createKeypair(){return s.default.box.keyPair()}createKeypairFromString(e){return{publicKey:(0,o.hexToByteArray)(e.publicKey),secretKey:(0,o.hexToByteArray)(e.secretKey)}}createNonce(){return s.default.randomBytes(this.nonceLength)}get keyPair(){return this.sessionKeyPair}encrypt(e,t){const n=(new TextEncoder).encode(e),i=this.createNonce(),r=s.default.box(n,i,(0,o.hexToByteArray)(t),this.keyPair.secretKey);let a=(0,o.concatUint8Arrays)(i,r);var c=(0,o.toHexString)(a),l=(new TextEncoder).encode(c);return(0,o.base64encode)(l,!1)}encryptWallet(e,t){const n=(new TextEncoder).encode(e),i=this.createNonce(),r=s.default.box(n,i,(0,o.hexToByteArray)(t),this.keyPair.secretKey);let a=(0,o.concatUint8Arrays)(i,r);return(0,o.base64encode)(a,!1)}decrypt(e,t){let n=(0,o.base64decode)(e,!0),i=n.toUint8Array();const[r,a]=(0,o.splitToUint8Arrays)(i,this.nonceLength),c=s.default.box.open(a,r,(0,o.hexToByteArray)(t),this.keyPair.secretKey);if(!c)throw new Error(`Decryption error: \n message: ${e.toString()} \n sender pubkey: ${t.toString()} \n keypair pubkey: ${(0,o.toHexString)(this.keyPair.publicKey)} \n keypair secretkey: ${(0,o.toHexString)(this.keyPair.secretKey)}`);return(new TextDecoder).decode(c)}decryptWallet(e,t){let n=(0,o.base64decode)(e,!0),i=(0,o.hexToByteArray)(n.toString());const[r,a]=(0,o.splitToUint8Arrays)(i,this.nonceLength),c=s.default.box.open(a,r,(0,o.hexToByteArray)(t),this.keyPair.secretKey);if(!c)throw new Error(`Decryption error: \n message: ${e.toString()} \n sender pubkey: ${t.toString()} \n keypair pubkey: ${(0,o.toHexString)(this.keyPair.publicKey)} \n keypair secretkey: ${(0,o.toHexString)(this.keyPair.secretKey)}`);return(new TextDecoder).decode(c)}stringifyKeypair(){return{publicKey:(0,o.toHexString)(this.keyPair.publicKey),secretKey:(0,o.toHexString)(this.keyPair.secretKey)}}}t.SessionCrypto=r},65418:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,s)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),s(n(94643),t),s(n(60075),t),s(n(31364),t)},41414:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.IEngine=t.ISignClient=t.ISignClientEvents=t.IEngineEvents=void 0;const s=i(n(55282));class o extends s.default{constructor(){super()}}t.IEngineEvents=o;class r extends s.default{constructor(){super()}}t.ISignClientEvents=r;class a{constructor(e){this.data=e}}t.ISignClient=a;class c{constructor(e){this.client=e}}t.IEngine=c},11250:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,s)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.creatOKXMiniAppWalletInfo=t.creatOKXWalletInfo=t.ISignClientEvents=t.IEngine=t.IEngineEvents=t.ISignClient=t.getBigIntRpcId=t.formatJsonRpcRequest=t.isJsonRpcError=t.isJsonRpcResponse=t.parseConnectionError=t.isHttpUrl=t.formatJsonRpcError=void 0;var o=n(34196);Object.defineProperty(t,"formatJsonRpcError",{enumerable:!0,get:function(){return o.formatJsonRpcError}}),Object.defineProperty(t,"isHttpUrl",{enumerable:!0,get:function(){return o.isHttpUrl}}),Object.defineProperty(t,"parseConnectionError",{enumerable:!0,get:function(){return o.parseConnectionError}}),Object.defineProperty(t,"isJsonRpcResponse",{enumerable:!0,get:function(){return o.isJsonRpcResponse}}),Object.defineProperty(t,"isJsonRpcError",{enumerable:!0,get:function(){return o.isJsonRpcError}}),Object.defineProperty(t,"formatJsonRpcRequest",{enumerable:!0,get:function(){return o.formatJsonRpcRequest}}),Object.defineProperty(t,"getBigIntRpcId",{enumerable:!0,get:function(){return o.getBigIntRpcId}});var r=n(41414);Object.defineProperty(t,"ISignClient",{enumerable:!0,get:function(){return r.ISignClient}}),Object.defineProperty(t,"IEngineEvents",{enumerable:!0,get:function(){return r.IEngineEvents}}),Object.defineProperty(t,"IEngine",{enumerable:!0,get:function(){return r.IEngine}}),Object.defineProperty(t,"ISignClientEvents",{enumerable:!0,get:function(){return r.ISignClientEvents}}),s(n(72136),t);var a=n(65746);Object.defineProperty(t,"creatOKXWalletInfo",{enumerable:!0,get:function(){return a.creatOKXWalletInfo}}),Object.defineProperty(t,"creatOKXMiniAppWalletInfo",{enumerable:!0,get:function(){return a.creatOKXMiniAppWalletInfo}})},34196:function(e,t,n){"use strict";n(92806),n(53287),n(70039),n(70144),n(86823),n(51204),n(92806),n(53287),n(70039),n(70144),n(86823),n(51204);var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};function s(e){return"object"===typeof e&&"id"in e&&"jsonrpc"in e&&"2.0"===e.jsonrpc}function o(e){return s(e)&&"method"in e}function r(e){return s(e)&&(a(e)||c(e))}function a(e){return"result"in e}function c(e){return"error"in e}Object.defineProperty(t,"__esModule",{value:!0}),t.isJsonRpcPayload=s,t.isJsonRpcRequest=o,t.isJsonRpcResponse=r,t.isJsonRpcResult=a,t.isJsonRpcError=c,t.payloadId=p,t.getBigIntRpcId=g,t.formatJsonRpcRequest=b,t.formatJsonRpcResult=_,t.formatJsonRpcError=m,t.isReservedErrorCode=v,t.getError=O,t.getErrorByCode=y,t.formatErrorMessage=C,t.isHttpUrl=w,t.isWsUrl=R,t.parseConnectionError=T;const l=n(40375),d=i(n(77361));class u{constructor(e){this.i=1;8===e?new Uint8Array(1):16===e?new Uint16Array(1):new Uint32Array(1);this.initialValue=d.default.randomBytes(e/8)[0]}getNextValue(){return this.initialValue+this.i++}}const h=new u(8),f=new u(16);function p(){const e=1e3*Date.now(),t=h.getNextValue();return e+t}function g(){const e=BigInt(Date.now())*BigInt(1e6),t=BigInt(f.getNextValue());return e+t}function b(e,t,n){return{id:n||p(),jsonrpc:"2.0",method:e,params:t}}function _(e,t){return{id:e,jsonrpc:"2.0",result:t}}function m(e,t,n){return{id:e,jsonrpc:"2.0",error:C(t,n)}}function v(e){return l.RESERVED_ERROR_CODES.includes(e)}function O(e){return Object.keys(l.STANDARD_ERROR_MAP).includes(e)?l.STANDARD_ERROR_MAP[e]:l.STANDARD_ERROR_MAP[l.DEFAULT_ERROR]}function y(e){const t=Object.values(l.STANDARD_ERROR_MAP).find((t=>t.code===e));return t||l.STANDARD_ERROR_MAP[l.DEFAULT_ERROR]}function C(e,t){return"undefined"===typeof e?O(l.INTERNAL_ERROR):("string"===typeof e&&(e=Object.assign(Object.assign({},O(l.SERVER_ERROR)),{message:e})),"undefined"!==typeof t&&(e.data=t),v(e.code)&&(e=y(e.code)),e)}function E(e){const t=e.match(new RegExp(/^\w+:/,"gi"));if(t&&t.length)return t[0]}function N(e,t){const n=E(e);return"undefined"!==typeof n&&new RegExp(t).test(n)}function w(e){return N(e,"^https?:")}function R(e){return N(e,"^wss?:")}function T(e,t,n){return e.message.includes("getaddrinfo ENOTFOUND")||e.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${n} RPC url at ${t}`):e}},94419:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.CONNECT_ITEM_ERROR_CODES=void 0,function(e){e[e["UNKNOWN_ERROR"]=0]="UNKNOWN_ERROR",e[e["METHOD_NOT_SUPPORTED"]=400]="METHOD_NOT_SUPPORTED"}(n||(t.CONNECT_ITEM_ERROR_CODES=n={}))},2386:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.TONCHAIN=void 0,function(e){e["MAINNET"]="-239"}(n||(t.TONCHAIN=n={}))},72136:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CONNECT_ITEM_ERROR_CODES=t.TONCHAIN=void 0;var i=n(2386);Object.defineProperty(t,"TONCHAIN",{enumerable:!0,get:function(){return i.TONCHAIN}});var s=n(94419);Object.defineProperty(t,"CONNECT_ITEM_ERROR_CODES",{enumerable:!0,get:function(){return s.CONNECT_ITEM_ERROR_CODES}})},65746:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.creatOKXWalletInfo=s,t.creatOKXMiniAppWalletInfo=o;const i=n(2510);function s(){return{appName:"okxAppWallet",name:"OKX Wallet",imageUrl:"https://static.okx.com/cdn/assets/imgs/247/58E63FEA47A2B7D7.png",aboutUrl:"https://www.okx.com/web3",universalLink:i.standardUniversalLink,deepLink:i.standardDeeplink,platforms:["ios","android"]}}function o(){return{appName:"okxMiniApp",name:"OKX Mini Wallet",imageUrl:"https://static.okx.com/cdn/assets/imgs/247/58E63FEA47A2B7D7.png",aboutUrl:"https://www.okx.com/web3",universalLink:`https://t.me/${i.tgwalletName}/start`,deepLink:"",platforms:["ios","android","macos","windows"]}}},2510:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tgwalletName=t.tonConnectSdkVersion=t.standardDeeplink=t.standardUniversalLink=void 0,t.standardUniversalLink="https://www.okx.com/download",t.standardDeeplink="okx://web3/wallet/connect",t.tonConnectSdkVersion="1",t.tgwalletName="OKX_WALLET_BOT"},91306:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OKX_CONNECT_ERROR_CODES=t.OKXConnectError=void 0;var i=n(40375);Object.defineProperty(t,"OKXConnectError",{enumerable:!0,get:function(){return i.OKXConnectError}}),Object.defineProperty(t,"OKX_CONNECT_ERROR_CODES",{enumerable:!0,get:function(){return i.OKX_CONNECT_ERROR_CODES}})},40375:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_ERROR=t.STANDARD_ERROR_MAP=t.SERVER_ERROR_CODE_RANGE=t.RESERVED_ERROR_CODES=t.SERVER_ERROR=t.INTERNAL_ERROR=t.INVALID_PARAMS=t.METHOD_NOT_FOUND=t.INVALID_REQUEST=t.PARSE_ERROR=t.OKX_CONNECT_ERROR_CODES=t.OKXConnectError=void 0;class n extends Error{constructor(e,t){void 0==t&&(t=i(e)),super(t),this.code=e,this.message=`${n.prefix} ${t?"\n"+t:""}`,Object.setPrototypeOf(this,n.prototype)}toJSON(){return{message:this.message,code:this.code}}}function i(e){return e==s.UNKNOWN_ERROR?"unknown error":e==s.BAD_REQUEST_ERROR?"bad request error":e==s.ALREADY_CONNECTED_ERROR?"already connected error":e==s.NOT_CONNECTED_ERROR?"not connected error":e==s.UNKNOWN_APP_ERROR?"unknown app error":e==s.USER_REJECTS_ERROR?"user rejects error":e==s.METHOD_NOT_SUPPORTED?"method not supported":"unknown error"}var s;t.OKXConnectError=n,n.prefix="[OKX_CONNECT_SDK_ERROR]",function(e){e[e["UNKNOWN_ERROR"]=0]="UNKNOWN_ERROR",e[e["BAD_REQUEST_ERROR"]=1]="BAD_REQUEST_ERROR",e[e["ALREADY_CONNECTED_ERROR"]=11]="ALREADY_CONNECTED_ERROR",e[e["NOT_CONNECTED_ERROR"]=12]="NOT_CONNECTED_ERROR",e[e["UNKNOWN_APP_ERROR"]=100]="UNKNOWN_APP_ERROR",e[e["USER_REJECTS_ERROR"]=300]="USER_REJECTS_ERROR",e[e["METHOD_NOT_SUPPORTED"]=400]="METHOD_NOT_SUPPORTED",e[e["CHAIN_NOT_SUPPORTED"]=500]="CHAIN_NOT_SUPPORTED",e[e["WALLET_NOT_SUPPORTED"]=600]="WALLET_NOT_SUPPORTED"}(s||(t.OKX_CONNECT_ERROR_CODES=s={})),t.PARSE_ERROR="PARSE_ERROR",t.INVALID_REQUEST="INVALID_REQUEST",t.METHOD_NOT_FOUND="METHOD_NOT_FOUND",t.INVALID_PARAMS="INVALID_PARAMS",t.INTERNAL_ERROR="INTERNAL_ERROR",t.SERVER_ERROR="SERVER_ERROR",t.RESERVED_ERROR_CODES=[-32700,-32600,-32601,-32602,-32603],t.SERVER_ERROR_CODE_RANGE=[-32e3,-32099],t.STANDARD_ERROR_MAP={[t.PARSE_ERROR]:{code:-32700,message:"Parse error"},[t.INVALID_REQUEST]:{code:-32600,message:"Invalid Request"},[t.METHOD_NOT_FOUND]:{code:-32601,message:"Method not found"},[t.INVALID_PARAMS]:{code:-32602,message:"Invalid params"},[t.INTERNAL_ERROR]:{code:-32603,message:"Internal error"},[t.SERVER_ERROR]:{code:-32e3,message:"Server error"}},t.DEFAULT_ERROR=t.SERVER_ERROR},60075:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,s)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.tonConnectSdkVersion=t.standardDeeplink=t.standardUniversalLink=t.NameSpaceKeyAptos=t.NameSpaceKeyBtc=t.NameSpaceKeySui=t.NameSpaceKeyTON=t.NameSpaceKeySOL=t.NameSpaceKeyEip155=void 0,s(n(91306),t);var o=n(38439);Object.defineProperty(t,"NameSpaceKeyEip155",{enumerable:!0,get:function(){return o.NameSpaceKeyEip155}}),Object.defineProperty(t,"NameSpaceKeySOL",{enumerable:!0,get:function(){return o.NameSpaceKeySOL}}),Object.defineProperty(t,"NameSpaceKeyTON",{enumerable:!0,get:function(){return o.NameSpaceKeyTON}}),Object.defineProperty(t,"NameSpaceKeySui",{enumerable:!0,get:function(){return o.NameSpaceKeySui}}),Object.defineProperty(t,"NameSpaceKeyBtc",{enumerable:!0,get:function(){return o.NameSpaceKeyBtc}}),Object.defineProperty(t,"NameSpaceKeyAptos",{enumerable:!0,get:function(){return o.NameSpaceKeyAptos}});var r=n(2510);Object.defineProperty(t,"standardUniversalLink",{enumerable:!0,get:function(){return r.standardUniversalLink}}),Object.defineProperty(t,"standardDeeplink",{enumerable:!0,get:function(){return r.standardDeeplink}}),Object.defineProperty(t,"tonConnectSdkVersion",{enumerable:!0,get:function(){return r.tonConnectSdkVersion}}),s(n(11250),t)},38439:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NameSpaceKeyAptos=t.NameSpaceKeyBtc=t.NameSpaceKeySui=t.NameSpaceKeyTON=t.NameSpaceKeySOL=t.NameSpaceKeyEip155=void 0,t.NameSpaceKeyEip155="eip155",t.NameSpaceKeySOL="solana",t.NameSpaceKeyTON="ton",t.NameSpaceKeySui="sui",t.NameSpaceKeyBtc="btc",t.NameSpaceKeyAptos="aptos"},84978:function(e,t){"use strict";var n=this&&this.__awaiter||function(e,t,n,i){function s(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function r(e){try{c(i.next(e))}catch(t){o(t)}}function a(e){try{c(i["throw"](e))}catch(t){o(t)}}function c(e){e.done?n(e.value):s(e.value).then(r,a)}c((i=i.apply(e,t||[])).next())}))};function i(e,t){return n(this,void 0,void 0,(function*(){var n,i;const o=null!==(n=null===t||void 0===t?void 0:t.attempts)&&void 0!==n?n:3,r=null!==(i=null===t||void 0===t?void 0:t.delayMs)&&void 0!==i?i:800;if("function"!==typeof e)throw new Error("Expected a function, got "+typeof e);let a,c=0;while(c<o)try{return yield e()}catch(l){a=l,c++,c<o&&(yield s(r))}throw a}))}function s(e,t){return n(this,void 0,void 0,(function*(){return new Promise(((n,i)=>{var s,o;if(null===(s=null===t||void 0===t?void 0:t.signal)||void 0===s?void 0:s.aborted)return void i(new Error("Delay aborted"));const r=setTimeout((()=>n()),e);null===(o=null===t||void 0===t?void 0:t.signal)||void 0===o||o.addEventListener("abort",(()=>{clearTimeout(r),i(new Error("Delay aborted"))}))}))}))}Object.defineProperty(t,"__esModule",{value:!0}),t.callForSuccess=i,t.delay=s},31364:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isBrowser=t.isOS=t.isMobileUserAgent=t.openDeeplinkWithFallback=t.openLinkBlank=t.openLink=t.isValidObject=t.isIos=t.base64decode=t.base64encode=t.splitToUint8Arrays=t.concatUint8Arrays=t.toHexString=t.hexToByteArray=t.encodeTWAConnectURLParams=t.encodeConnectParams=t.openOKXTMAWalletlinkWithFallback=t.getTelegramWalletTWAUrl=t.getAppWalletDeepLink=t.encodeTelegramUrlParameters=t.isTelegramUrl=t.openOKXDeeplinkWithFallback=t.getUniversalLink=t.safeJsonStringify=t.safeJsonParse=t.logWarning=t.logError=t.logDebug=t.callForSuccess=void 0;var i=n(84978);Object.defineProperty(t,"callForSuccess",{enumerable:!0,get:function(){return i.callForSuccess}});var s=n(23902);Object.defineProperty(t,"logDebug",{enumerable:!0,get:function(){return s.logDebug}}),Object.defineProperty(t,"logError",{enumerable:!0,get:function(){return s.logError}}),Object.defineProperty(t,"logWarning",{enumerable:!0,get:function(){return s.logWarning}});var o=n(60529);Object.defineProperty(t,"safeJsonParse",{enumerable:!0,get:function(){return o.safeJsonParse}}),Object.defineProperty(t,"safeJsonStringify",{enumerable:!0,get:function(){return o.safeJsonStringify}});var r=n(95821);Object.defineProperty(t,"getUniversalLink",{enumerable:!0,get:function(){return r.getUniversalLink}}),Object.defineProperty(t,"openOKXDeeplinkWithFallback",{enumerable:!0,get:function(){return r.openOKXDeeplinkWithFallback}}),Object.defineProperty(t,"isTelegramUrl",{enumerable:!0,get:function(){return r.isTelegramUrl}}),Object.defineProperty(t,"encodeTelegramUrlParameters",{enumerable:!0,get:function(){return r.encodeTelegramUrlParameters}}),Object.defineProperty(t,"getAppWalletDeepLink",{enumerable:!0,get:function(){return r.getAppWalletDeepLink}}),Object.defineProperty(t,"getTelegramWalletTWAUrl",{enumerable:!0,get:function(){return r.getTelegramWalletTWAUrl}}),Object.defineProperty(t,"openOKXTMAWalletlinkWithFallback",{enumerable:!0,get:function(){return r.openOKXTMAWalletlinkWithFallback}}),Object.defineProperty(t,"encodeConnectParams",{enumerable:!0,get:function(){return r.encodeConnectParams}}),Object.defineProperty(t,"encodeTWAConnectURLParams",{enumerable:!0,get:function(){return r.encodeTWAConnectURLParams}});var a=n(57837);Object.defineProperty(t,"hexToByteArray",{enumerable:!0,get:function(){return a.hexToByteArray}}),Object.defineProperty(t,"toHexString",{enumerable:!0,get:function(){return a.toHexString}}),Object.defineProperty(t,"concatUint8Arrays",{enumerable:!0,get:function(){return a.concatUint8Arrays}}),Object.defineProperty(t,"splitToUint8Arrays",{enumerable:!0,get:function(){return a.splitToUint8Arrays}}),Object.defineProperty(t,"base64encode",{enumerable:!0,get:function(){return a.base64encode}}),Object.defineProperty(t,"base64decode",{enumerable:!0,get:function(){return a.base64decode}}),Object.defineProperty(t,"isIos",{enumerable:!0,get:function(){return a.isIos}}),Object.defineProperty(t,"isValidObject",{enumerable:!0,get:function(){return a.isValidObject}});var c=n(3879);Object.defineProperty(t,"openLink",{enumerable:!0,get:function(){return c.openLink}}),Object.defineProperty(t,"openLinkBlank",{enumerable:!0,get:function(){return c.openLinkBlank}}),Object.defineProperty(t,"openDeeplinkWithFallback",{enumerable:!0,get:function(){return c.openDeeplinkWithFallback}}),Object.defineProperty(t,"isMobileUserAgent",{enumerable:!0,get:function(){return c.isMobileUserAgent}}),Object.defineProperty(t,"isOS",{enumerable:!0,get:function(){return c.isOS}}),Object.defineProperty(t,"isBrowser",{enumerable:!0,get:function(){return c.isBrowser}})},23902:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logDebug=i,t.logError=s,t.logWarning=o;const n=!0;function i(...e){if("undefined"!=typeof console)try{(n||(null===window||void 0===window?void 0:window.okxLogDebug))&&console.log("[OKX_CONNECT_SDK]",...e)}catch(t){}}function s(...e){if("undefined"!=typeof console)try{(n||(null===window||void 0===window?void 0:window.okxLogDebug))&&console.error("[OKX_CONNECT_SDK]",...e)}catch(t){}}function o(...e){if("undefined"!=typeof console)try{(n||(null===window||void 0===window?void 0:window.okxLogDebug))&&console.warn("[OKX_CONNECT_SDK]",...e)}catch(t){}}},60529:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.safeJsonParse=r,t.safeJsonStringify=a;const i=n(23902),s=e=>JSON.stringify(e,((e,t)=>"bigint"===typeof t?t.toString()+"n":t)),o=e=>{const t=/:(\b\d{17,}|\b(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))(?=[,\}\]]|$)/g,n=e.replace(t,(e=>`"${e}n"`));return JSON.parse(n,((e,t)=>{const n="string"===typeof t&&t.match(/^\d+n$/);return n?BigInt(t.substring(0,t.length-1)):t}))};function r(e){if("string"!==typeof e)throw(0,i.logDebug)(e),new Error("Cannot safe json parse value of type "+typeof e);try{return o(e)}catch(t){return console.error("safeJsonParse error:",t),e}}function a(e){return"string"===typeof e?e:s(e)||""}},98650:function(e,t,n){"use strict";n(92806),n(53287),n(70039),n(70144),n(86823),n(51204),n(92806),n(53287),n(70039),n(70144),n(86823),n(51204),Object.defineProperty(t,"__esModule",{value:!0}),t.okxfromString=o,t.okxtoString=r,t.alloc=a,t.allocUnsafe=c;const i=n(2049),s=n(23902);function o(e,t="utf8"){const n=h[t];if((0,s.logDebug)("okxfromstring ====> "),!n)throw new Error(`Unsupported encoding "${t}"`);return n.decoder.decode(`${n.prefix}${e}`)}function r(e,t="utf8"){const n=h[t];if((0,s.logDebug)("okxtoString ====> "),!n)throw new Error(`Unsupported encoding "${t}"`);return n.encoder.encode(e).substring(1)}function a(e=0){return new Uint8Array(e)}function c(e=0){return new Uint8Array(e)}function l(e,t,n,i){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:n},decoder:{decode:i}}}const d=l("utf8","u",(e=>{const t=new TextDecoder("utf8");return"u"+t.decode(e)}),(e=>{const t=new TextEncoder;return t.encode(e.substring(1))})),u=l("ascii","a",(e=>{let t="a";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t}),(e=>{e=e.substring(1);const t=c(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t})),h=Object.assign({utf8:d,"utf-8":d,hex:i.bases.base16,latin1:u,ascii:u,binary:u},i.bases)},95821:function(e,t,n){"use strict";n(27618),n(37008),n(24671),n(73074),n(27618),n(37008),n(24671),n(73074),Object.defineProperty(t,"__esModule",{value:!0}),t.removeUrlLastSlash=r,t.addPathToUrl=a,t.getUniversalLink=c,t.openOKXDeeplinkWithFallback=l,t.getWindow=d,t.isTelegramUrl=u,t.encodeTelegramUrlParameters=h,t.encodeConnectParams=f,t.encodeTWAConnectURLParams=p,t.getAppWalletDeepLink=g,t.getTelegramWalletTWAUrl=b,t.openOKXTMAWalletlinkWithFallback=_;const i=n(60075),s=n(23902),o=n(2510);function r(e){return"/"===e.slice(-1)?e.slice(0,-1):e}function a(e,t){return r(e)+"/"+t}function c(e){const t=encodeURIComponent(e);return`${i.standardUniversalLink}?deeplink=${t}`}function l(e){var t;const n=c(e),s=!!(null===(t=d())||void 0===t?void 0:t.TelegramWebviewProxy),o=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;console.log("openOKXDeeplinkWithFallback fullUrl:",n);let r=!1;const a=1500,l=(Date.now(),i.standardUniversalLink);if(o)s?window.open(n,"_blank"):(console.log("windowOpen[before]: ",Date.now()),(null===window||void 0===window?void 0:window.okxLogDebug)?window.open(n,"_blank"):window.open(n,"_self"),console.log("windowOpen[after]: ",Date.now()));else{let t=null;var u=()=>{r||(t?t.open(l,"_self"):window.open(l,"_blank"))};s?t=window.open(e,"_blank"):window.location.href=e,setTimeout(u,a),window.addEventListener("blur",(()=>{r=!0}),{once:!0}),document.addEventListener("visibilitychange",(()=>{"hidden"===document.visibilityState&&(r=!0)}))}}function d(){if("undefined"!==typeof window)return window}function u(e){if(!e)return!1;const t=new URL(e);return"tg:"===t.protocol||"t.me"===t.hostname}function h(e){let t=e;return t=t.replace(/\./g,"%2E"),t=t.replace(/-/g,"%2D"),t=t.replace(/_/g,"%5F"),t=t.replace(/&/g,"-"),t=t.replace(/=/g,"__"),t=t.replace(/%/g,"--"),t}function f(e){const t=JSON.stringify(e);(0,s.logDebug)("url encodeConnectParams connectRequestStr ",t);const n=(new TextEncoder).encode(t),i=btoa(String.fromCharCode(...n));return i}function p(e){const t=JSON.stringify({topic:e.topic,clientId:e.clientId});(0,s.logDebug)("url encodeConnectParams connectRequestStr",t);const n=(new TextEncoder).encode(t),i=btoa(String.fromCharCode(...n));return i}function g(e){return`${i.standardDeeplink}?param=${e}`}function b(e,t,n=!1){let i={okxconnect:"",redirect:"",extraparams:""};e&&(i.okxconnect=e),t&&(i.redirect=t);let r=JSON.stringify(i);const a=(new TextEncoder).encode(r),c=btoa(String.fromCharCode(...a));return(0,s.logDebug)("[TWA] open link:",i,c),e||t?n?`http://localhost:5173?${o.tgwalletName}=${c}`:`https://t.me/${o.tgwalletName}/start?startapp=${c}`:n?"http://localhost:5173":`https://t.me/${o.tgwalletName}/start`}function _(e,t=!1){var n,i,o;(0,s.logDebug)("[TWA] open link:",e,"browserDebug ==> ",t),t?window.open(e,"_blank"):null===(o=null===(i=null===(n=d())||void 0===n?void 0:n.Telegram)||void 0===i?void 0:i.WebApp)||void 0===o||o.openTelegramLink(e)}},57837:function(e,t,n){"use strict";n(92806),n(53287),n(70039),n(70144),n(86823),n(51204),n(92806),n(53287),n(70039),n(70144),n(86823),n(51204);var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.isValidObject=t.RANDOM_LENGTH=t.isBrowser=t.resolveLocalStorage=t.hasLocalStorage=t.hasBuiltInWebSocket=t.resolveWebSocketImplementation=void 0,t.hexToByteArray=h,t.toHexString=f,t.concatUint8Arrays=p,t.splitToUint8Arrays=g,t.base64encode=m,t.base64decode=v,t.checkWSUrl=O,t.hashKey=R,t.generateRandomBytes32=T,t.generateTopic=S,t.isIos=P;const s=i(n(77361)),o=i(n(17220)),r=n(8552),a=n(20290),c=n(60529),l=n(23902),d=n(98650),u="base16";function h(e){if(e.length%2!==0)throw new Error(`Cannot convert ${e} to bytesArray`);const t=new Uint8Array(e.length/2);for(let n=0;n<e.length;n+=2)t[n/2]=parseInt(e.slice(n,n+2),16);return t}function f(e){let t="";return e.forEach((e=>{t+=("0"+(255&e).toString(16)).slice(-2)})),t}function p(e,t){const n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}function g(e,t){if(t>=e.length)throw new Error("Index is out of buffer");const n=e.slice(0,t),i=e.slice(t);return[n,i]}function b(e,t){const n=o.default.encodeBase64(e);return t?encodeURIComponent(n):n}function _(e,t){return t&&(e=decodeURIComponent(e)),o.default.decodeBase64(e)}function m(e,t){let n;return e instanceof Uint8Array?n=e:("string"!==typeof e&&(e=(0,c.safeJsonStringify)(e)),n=o.default.decodeUTF8(e)),b(n,t)}function v(e,t){const n=_(e,t);return{toString(){return o.default.encodeUTF8(n)},toObject(){try{return(0,c.safeJsonParse)(o.default.encodeUTF8(n))}catch(e){return null}},toUint8Array(){return n}}}function O(e){const t=e.match(new RegExp(/^\w+:/,"gi"));if(!t||!t.length)return!1;let n=t[0];return void 0!==n&&new RegExp("^wss?:").test(n)}const y=()=>"undefined"!==typeof WebSocket?WebSocket:"undefined"!==typeof n.g&&"undefined"!==typeof n.g.WebSocket?n.g.WebSocket:"undefined"!==typeof window&&"undefined"!==typeof window.WebSocket?window.WebSocket:"undefined"!==typeof self&&"undefined"!==typeof self.WebSocket?self.WebSocket:WebSocket;t.resolveWebSocketImplementation=y;const C=()=>"undefined"!==typeof WebSocket||"undefined"!==typeof n.g&&"undefined"!==typeof n.g.WebSocket||"undefined"!==typeof window&&"undefined"!==typeof window.WebSocket||"undefined"!==typeof self&&"undefined"!==typeof self.WebSocket;t.hasBuiltInWebSocket=C;const E=()=>"undefined"!==typeof n.g&&"undefined"!==typeof n.g.localStorage||"undefined"!==typeof window&&"undefined"!==typeof window.localStorage;t.hasLocalStorage=E;const N=()=>"undefined"!==typeof n.g&&"undefined"!==typeof n.g.localStorage?n.g.localStorage:"undefined"!==typeof window&&"undefined"!==typeof window.localStorage?window.localStorage:localStorage;t.resolveLocalStorage=N;const w=()=>"undefined"!==typeof window;function R(e,t=u){(0,l.logDebug)(`hash key called ${e}`);const n=(0,a.hash)((0,d.okxfromString)(e,t));return(0,r.toString)(n,t)}function T(){return s.default.randomBytes(t.RANDOM_LENGTH)}function S(){let e=T();return(0,l.logDebug)(`generate topic called ${e}`),R((0,r.toString)(e,u))}t.isBrowser=w,t.RANDOM_LENGTH=32;const k=e=>Object.getPrototypeOf(e)===Object.prototype&&Object.keys(e).length;function P(){const e=navigator.userAgent,t=navigator.maxTouchPoints||0,n=/iPad|iPhone|iPod/.test(e)&&!window.MSStream,i=e.includes("Mac")&&t>1;return(0,l.logDebug)(`utils isIos >>>isIOSDevice: ${n}    >> isIPadOS: ${i}`),n||i}t.isValidObject=k},3879:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.openLink=r,t.openLinkBlank=a,t.openDeeplinkWithFallback=c,t.isMobileUserAgent=l,t.getUserAgent=d,t.isOS=u,t.isBrowser=h;const s=i(n(98158)),o=n(23902);function r(e,t="_self"){(0,o.logDebug)("openLink",e,t),window.open(e,t,"noopener noreferrer")}function a(e){r(e,"_blank")}function c(e,t){const n=()=>{h("safari")||u("android")&&h("firefox")||t()},i=setTimeout((()=>n()),500);window.addEventListener("blur",(()=>clearTimeout(i)),{once:!0}),r(e,"_self")}function l(){let e=!1;return function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.slice(0,4)))&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),e}function d(){var e,t,n;const i=(new s.default).getResult(),o=null===(e=i.os.name)||void 0===e?void 0:e.toLowerCase(),r=null===(t=i.device.model)||void 0===t?void 0:t.toLowerCase();let a;switch(!0){case"ipad"===r:a="ipad";break;case"ios"===o:a="ios";break;case"android"===o:a="android";break;case"mac os"===o:a="macos";break;case"linux"===o:a="linux";break;case null===o||void 0===o?void 0:o.includes("windows"):a="windows";break}const c=null===(n=i.browser.name)||void 0===n?void 0:n.toLowerCase();let l;switch(!0){case"chrome"===c:l="chrome";break;case"firefox"===c:l="firefox";break;case null===c||void 0===c?void 0:c.includes("safari"):l="safari";break;case null===c||void 0===c?void 0:c.includes("opera"):l="opera";break}return{os:a,browser:l}}function u(...e){return e.includes(d().os)}function h(...e){return e.includes(d().browser)}},71780:function(e,t,n){"use strict";n(88373),n(51555),n(33734),n(22035),n(94932),n(50427),n(19239),n(88373),n(51555),n(33734),n(22035),n(94932),n(50427),n(19239);var i=this&&this.__awaiter||function(e,t,n,i){function s(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function r(e){try{c(i.next(e))}catch(t){o(t)}}function a(e){try{c(i["throw"](e))}catch(t){o(t)}}function c(e){e.done?n(e.value):s(e.value).then(r,a)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.OKXSolanaProvider=void 0;const o=n(68190),r=s(n(25308)),a=n(62376);class c{getRealChainId(e){if(null==e){if(1==this.chainsSet.size){let e="",t=this.defaultChainMap;if(this.chainsSet.forEach((function(n){t.has(n)&&(e=t.get(n))})),""==e)throw new Error("unsupported chainId");return e}throw new Error("connected to multiple solana chains,chainId can not be null")}if(e.startsWith("svm"))return e;if(this.caip.includes(e))return e;throw new Error("wrong chainId")}getConnectedNamespace(){var e,t,n;null===(n=null===(t=null===(e=this.provider.session)||void 0===e?void 0:e.namespaces)||void 0===t?void 0:t["solana"])||void 0===n||n.chains.forEach((e=>{this.chainsSet.add(e.split(":")[0])}))}constructor(e){this.chainsSet=new Set,this.caip=["solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","sonic:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","sonic:EtWTRABZaYq6iMfeYKouRu166VU2xqa1"],this.defaultChainMap=new Map,this.provider=e.getUniversalProvider(),this.defaultChainMap.set("solana","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp"),this.defaultChainMap.set("sonic","sonic:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z"),this.getConnectedNamespace()}signMessage(e,t){return i(this,void 0,void 0,(function*(){var n;t=this.getRealChainId(t);try{let i={chainId:t,method:"solana_signMessage",params:{message:e,pubkey:null===(n=this.getAccount(t))||void 0===n?void 0:n.address}},s=yield this.provider.request(i,t);if((0,a.logDebug)("signMessage111",s),"result"in s){let e=s.result;return new Promise(((n,i)=>{var s;n({signature:r.default.decode(e),publicKey:null===(s=this.getAccount(t))||void 0===s?void 0:s.address})}))}return(0,a.logDebug)("signMessage111",s),new Promise(((e,t)=>{e(s.error)}))}catch(i){return console.error("方法数据回调失败 --Error--",i),new Promise(((e,t)=>{e(i)}))}}))}getAccount(e){var t,n,i,s;let r=null===(n=null===(t=this.provider.session)||void 0===t?void 0:t.namespaces["solana"])||void 0===n?void 0:n.accounts[0];if(null!=e&&(r=null===(s=null===(i=this.provider.session)||void 0===i?void 0:i.namespaces["solana"])||void 0===s?void 0:s.accounts.filter((function(t){return t.startsWith(e)}))[0]),(0,a.logDebug)("getAccount",r),!r)return;const c=r.split(":")[2];return c?{address:c,publicKey:new o.PublicKey(c)}:void 0}signTransaction(e,t){var n,i;(0,a.logDebug)("OKXSolanaProvider",typeof e),t=this.getRealChainId(t);try{let i=e.serialize({requireAllSignatures:!1,verifySignatures:!1}),s={data:r.default.encode(i),from:null===(n=this.getAccount(t))||void 0===n?void 0:n.address};return this.getSignedTransaction("solana_signTransaction",s,t)}catch(s){let n=e.serialize(),o={data:r.default.encode(n),from:null===(i=this.getAccount(t))||void 0===i?void 0:i.address};return this.getSignedTransaction("solana_signTransaction",o,t)}}signAllTransactions(e,t){return i(this,void 0,void 0,(function*(){t=this.getRealChainId(t);try{var n=e.map((e=>{var n,i;return i=e instanceof o.VersionedTransaction?e.serialize():e.serialize({requireAllSignatures:!1,verifySignatures:!1}),{data:r.default.encode(i),from:null===(n=this.getAccount(t))||void 0===n?void 0:n.address}}));const i=yield this.provider.request({method:"solana_signAllTransactions",params:{transactions:n}},t);if("result"in i){let e=i.result,t=JSON.parse(e).map((e=>{let t=r.default.decode(e);try{let e=o.Transaction.from(t);return(0,a.logDebug)("verifySignatures",e.verifySignatures()),e}catch(n){return o.VersionedTransaction.deserialize(t)}}));return new Promise(((e,n)=>{e(t)}))}return new Promise(((e,t)=>{e(i)}))}catch(i){return(0,a.logDebug)("getSignedTransaction",i),new Promise(((e,t)=>{e(i)}))}}))}signAndSendTransaction(e,t){return i(this,void 0,void 0,(function*(){var n,i;t=this.getRealChainId(t);try{let o={};try{let i=e.serialize({requireAllSignatures:!1,verifySignatures:!1});o={data:r.default.encode(i),from:null===(n=this.getAccount(t))||void 0===n?void 0:n.address}}catch(s){let n=e.serialize();o={data:r.default.encode(n),from:null===(i=this.getAccount(t))||void 0===i?void 0:i.address}}let a=yield this.provider.request({method:"solana_signAndSendTransaction",params:o},t);if("result"in a){let e=a.result;return new Promise(((t,n)=>{t(e)}))}return new Promise(((e,t)=>{e(a)}))}catch(o){return(0,a.logDebug)("getSignedTransaction",o),new Promise(((e,t)=>{e(o)}))}}))}getSignedTransaction(e,t,n){return i(this,void 0,void 0,(function*(){try{let s=yield this.provider.request({method:e,params:t},n);if("result"in s){let e,t=s.result,n=r.default.decode(t);try{e=o.Transaction.from(n)}catch(i){e=o.VersionedTransaction.deserialize(n)}return e instanceof o.VersionedTransaction||(0,a.logDebug)("verifySignatures",e.verifySignatures()),new Promise(((t,n)=>{t(e)}))}return new Promise(((e,t)=>{t(s)}))}catch(i){return(0,a.logDebug)("getSignedTransaction",i),new Promise(((e,t)=>{e(i)}))}}))}}t.OKXSolanaProvider=c,t["default"]=c},86855:function(e,t,n){"use strict";t.y=void 0;var i=n(71780);Object.defineProperty(t,"y",{enumerable:!0,get:function(){return i.OKXSolanaProvider}})},61764:function(e,t,n){"use strict";n(27618),n(27618);var i=this&&this.__awaiter||function(e,t,n,i){function s(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function r(e){try{c(i.next(e))}catch(t){o(t)}}function a(e){try{c(i["throw"](e))}catch(t){o(t)}}function c(e){e.done?n(e.value):s(e.value).then(r,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.OKXSuiProvider=void 0;const s=n(51079),o=n(96248),r=n(33930),a=n(2218);class c{get defaultNetwork(){let e=this.provider.requestDefaultChainWithNamespace(s.NameSpaceKeySui);return e}get suiClient(){var e,t;let n=(0,a.getFullnodeUrl)(this.defaultNetwork),i=null===(e=this.provider.session)||void 0===e?void 0:e.namespaces[s.NameSpaceKeySui];if(i&&i.rpcMap){let e=i.rpcMap[this.currentChainId];void 0!==e?(n=e,console.log("使用传进来的rpc======> ",n)):console.log("使用主网的rpc======> ",n)}else console.log("使用主网的rpc======> ",n);return console.log("使用主网的rpc======> ",JSON.stringify(null===(t=this.provider.session)||void 0===t?void 0:t.namespaces)),new a.SuiClient({url:n})}get currentChainId(){return`sui:${this.defaultNetwork}`}constructor(e){this.provider=e.getUniversalProvider()}getAccount(){var e,t,n,i,o,r,a;let c=s.NameSpaceKeySui,l=null===(t=null===(e=this.provider.session)||void 0===e?void 0:e.namespaces[c])||void 0===t?void 0:t.accounts[0];if(console.log("====> getAccount"),console.log(l),!l)return;const d=l.split(":"),u=l.split(":")[2];console.log("sui_publicKey",null===(i=null===(n=this.provider.session)||void 0===n?void 0:n.namespaces[c])||void 0===i?void 0:i.extra);let h=null===(a=null===(r=null===(o=this.provider.session)||void 0===o?void 0:o.namespaces[c])||void 0===r?void 0:r.extra)||void 0===a?void 0:a[`${d[0]}:${d[1]}`],f="";return void 0!=h&&(f=h["publicKey"],console.log("sui_publicKey",f)),u?{address:u,publicKey:f}:void 0}signTransaction(e){return i(this,void 0,void 0,(function*(){try{const[t,n]=yield this.generateTsBytesAndSerizlize(e),i=yield this.provider.request({method:"sui_signTransactionBlock",params:{txBytes:t,txSerialize:n}},this.currentChainId);if("result"in i)return{signature:i.result,transactionBlockBytes:t};{let e=i;return e.error}}catch(t){throw new s.OKXConnectError(s.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"the method signTransaction request  error")}}))}signAndExecuteTransaction(e){return i(this,void 0,void 0,(function*(){try{const[t,n]=yield this.generateTsBytesAndSerizlize(e);let i=yield this.provider.request({method:"sui_signAndExecuteTransactionBlock",params:{txBytes:t,txSerialize:n}},this.currentChainId);if("result"in i)return{confirmedLocalExecution:!1,digest:i.result,txBytes:t};{let e=i;return e.error}}catch(t){throw new s.OKXConnectError(s.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"the method signAndExecuteTransaction request  error")}}))}signMessage(e){return i(this,void 0,void 0,(function*(){console.log("====> signMessage:"),console.log(e);try{const t=new TextDecoder("utf8"),n=btoa(t.decode(e.message)),i=atob(n),s=yield this.provider.request({method:"sui_signMessage",params:{message:i}},this.currentChainId);if("result"in s){let e=s;console.log("====> signAction result"),console.log(s);const t=e.result;return{messageBytes:n,signature:t}}{console.log("====> signAction result error");let e=s;return e.error}}catch(t){throw new s.OKXConnectError(s.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"the method sui_signMessage request  error")}}))}signPersonalMessage(e){return i(this,void 0,void 0,(function*(){console.log("====> signPersonalMessage："),console.log(e);try{const t=new TextDecoder("utf8"),n=btoa(t.decode(e.message)),i=atob(n),s=yield this.provider.request({method:"sui_signPersonalMessage",params:{message:i}},this.currentChainId);if("result"in s){let e=s;console.log("====> signAction result"),console.log(s);const t=e.result;return{bytes:n,signature:t}}{console.log("====> signAction result error");let e=s;return e.error}}catch(t){throw new s.OKXConnectError(s.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"the method sui_signPersonalMessage request  error")}}))}generateTsBytesAndSerizlize(e){return i(this,void 0,void 0,(function*(){let t=["",""];if("txBytes"in e&&e.txBytes.length>0&&"txSerialize"in e&&e.txSerialize.length>0&&(t=[e.txBytes,e.txSerialize]),!("transactionBlock"in e))throw new s.OKXConnectError(s.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"params doesn't contains transactionBlock");let n=this.provider.requestAccountsWithNamespace(s.NameSpaceKeySui);if(0==n.length)throw new s.OKXConnectError(s.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"there is no sui account");try{e.transactionBlock.setSender(n[0]);const i=yield e.transactionBlock.build({client:this.suiClient}),s=(0,r.toBase64)(i),a=yield o.Transaction.from(s).toJSON();t=[s,a]}catch(i){throw new s.OKXConnectError(s.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`${i}`)}return new Promise((e=>{e(t)}))}))}}t.OKXSuiProvider=c,t["default"]=c},24998:function(e,t,n){"use strict";t.Z=void 0;var i=n(61764);Object.defineProperty(t,"Z",{enumerable:!0,get:function(){return i.OKXSuiProvider}})},46262:function(e,t,n){"use strict";n(41011),n(41011);var i=this&&this.__awaiter||function(e,t,n,i){function s(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function r(e){try{c(i.next(e))}catch(t){o(t)}}function a(e){try{c(i["throw"](e))}catch(t){o(t)}}function c(e){e.done?n(e.value):s(e.value).then(r,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.OKXBtcProvider=void 0;const s=n(6280);class o{constructor(e){this.caip=["btc:mainnet","fractal:mainnet"],this.provider=e.getUniversalProvider()}getAddressForChainId(e){var t,n;let i=this.checkChainId(e);if(void 0==i)throw new s.OKXConnectError(s.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"invalid chainId");let o=null===(n=null===(t=this.provider.session)||void 0===t?void 0:t.namespaces["btc"])||void 0===n?void 0:n.accounts.filter((function(t){return t.startsWith(e)}));if(void 0==o||o.length<0)throw new s.OKXConnectError(s.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"no connected account");let r=o[0];const a=r.split(":")[2];return a}getAccount(e){var t,n,i;let o=this.checkChainId(e);if(void 0==o)throw new s.OKXConnectError(s.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"invalid chainId");let r=null===(i=null===(n=null===(t=this.provider.session)||void 0===t?void 0:t.namespaces[o])||void 0===n?void 0:n.extra)||void 0===i?void 0:i[e],a="";return void 0!=r&&(a=r["publicKey"]),{address:this.getAddressForChainId(e),publicKey:a}}signMessage(e,t,n){return i(this,void 0,void 0,(function*(){let i=this.checkChainId(e);if(void 0==i)throw new s.OKXConnectError(s.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"invalid chainId");if("undefined"===t)throw new s.OKXConnectError(s.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"the method signMessage parmas error");let o={signStr:t,from:this.getAddressForChainId(e)};n&&(o.type=n);try{const t=yield this.provider.request({method:"btc_signMessage",params:o},e);if("result"in t)return t.result;{let e=t;return e.error}}catch(r){throw new s.OKXConnectError(s.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"the method signTransaction request error")}}))}sendBitcoin(e,t,n,o){return i(this,void 0,void 0,(function*(){let i=this.checkChainId(e);if(void 0==i)throw new s.OKXConnectError(s.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"invalid chainId");let r={from:this.getAddressForChainId(e),to:t,value:(n/1e8).toString()};(null===o||void 0===o?void 0:o.feeRate)&&(r["satBytes"]=o.feeRate.toString());let a=yield this.send(e,r);return void 0!==a&&"txhash"in a?a.txhash:a}))}send(e,t){return i(this,void 0,void 0,(function*(){let n=this.checkChainId(e);if(void 0==n)throw new s.OKXConnectError(s.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"invalid chainId");if(!this.checkParameters(t,"to","value"))throw new s.OKXConnectError(s.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"the method send parmas  error");t["from"]=this.getAddressForChainId(e);try{const n=yield this.provider.request({method:"btc_send",params:t},e);if("result"in n)return{txhash:n.result};{let e=n;return e.error}}catch(i){throw new s.OKXConnectError(s.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`the method send request error: ${i}`)}}))}signPsbt(e,t,n){return i(this,void 0,void 0,(function*(){return new Promise(((i,s)=>{this.signPsbts(e,[t],[n]).then((e=>{let t=JSON.parse(e);i(t[0])})).catch((e=>{s(e)}))}))}))}signPsbts(e,t,n){return i(this,void 0,void 0,(function*(){let i=this.checkChainId(e);if(void 0==i)throw new s.OKXConnectError(s.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"invalid chainId");if(void 0===t)throw new s.OKXConnectError(s.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"the method signPsbts params error");let o={psbtHexs:t,options:n};o.from=this.getAddressForChainId(e);try{const t=yield this.provider.request({method:"btc_signPsbts",params:o},e);if("result"in t)return t.result;{let e=t;return e.error}}catch(r){throw new s.OKXConnectError(s.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`the method send request error: ${r}`)}}))}signAndPushPsbt(e,t,n){return i(this,void 0,void 0,(function*(){let i=this.checkChainId(e);if(void 0==i)throw new s.OKXConnectError(s.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"invalid chainId");if(void 0===t)throw new s.OKXConnectError(s.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"the method signPsbts params error");let o={psbtHex:t,options:n};o.from=this.getAddressForChainId(e);try{const t=yield this.provider.request({method:"btc_signAndPushPsbt",params:o},e);if("result"in t)return JSON.parse(t.result);{let e=t;return e.error}}catch(r){throw new s.OKXConnectError(s.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`the method send request error: ${r}`)}}))}sendInscription(e,t,n,o){return i(this,void 0,void 0,(function*(){let i=this.checkChainId(e);if(void 0==i)throw new s.OKXConnectError(s.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"invalid chainId");if("undefined"===t)throw new s.OKXConnectError(s.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"the method sendInscription params error");var r=0;o&&"feeRate"in o&&(r=o.feeRate);let a="",c=this.getAddressForChainId(e);var l=7;if("undefined"!==n){let e="-Atomicals",t="-Ordinals";(null===n||void 0===n?void 0:n.toLowerCase().endsWith(e.toLowerCase()))?(l=8,n=this.removeSuffix(n,e)):(null===n||void 0===n?void 0:n.toLowerCase().endsWith(t.toLowerCase()))&&(n=this.removeSuffix(n,t))}let d={scenario:5,feeRate:r,txType:"20",to:t,batchBean:[{coinAmount:"1",nftId:n,protocolId:l,coinId:a,inscriptionId:"",from:c}]};try{const t=yield this.provider.request({method:"btc_sendInscription",params:d},e);if("result"in t)return t.result;{let e=t;return e.error}}catch(u){throw new s.OKXConnectError(s.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"the method signTransaction request error")}}))}removeSuffix(e,t){return e.endsWith(t)?e.slice(0,e.length-t.length):e}checkParameters(e,...t){var n=[];return t.forEach((t=>{`${t}`in e||n.push(t)})),!(n.length>0)||(console.log("not find key: ",n.join(",")),!1)}checkChainId(e){if(this.caip.includes(e)){let[t,n]=e.split(":");return t}}}t.OKXBtcProvider=o,t["default"]=o},11948:function(e,t,n){"use strict";n(88373),n(51555),n(33734),n(22035),n(94932),n(50427),n(19239),n(88373),n(51555),n(33734),n(22035),n(94932),n(50427),n(19239);var i=this&&this.__awaiter||function(e,t,n,i){function s(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function r(e){try{c(i.next(e))}catch(t){o(t)}}function a(e){try{c(i["throw"](e))}catch(t){o(t)}}function c(e){e.done?n(e.value):s(e.value).then(r,a)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.OKXUniversalProvider=void 0;const o=n(34310),r=n(19066),a=n(45530),c=n(27186),l=s(n(47736)),d=n(82781),u=n(65418),h=n(94524),f=s(n(55637)),p=s(n(24142)),g=s(n(96548)),b=s(n(21936));class _{static init(e){return i(this,void 0,void 0,(function*(){const t=new _(e);return yield t.initialize(),t}))}getUniversalProvider(){return this}constructor(e){this.rpcProviders={},this.events=new l.default,this.providerOpts=e}request(e,t){return i(this,void 0,void 0,(function*(){const{namespace:n,requestParam:i}=this.buildRequestParamFromRequest(e,t);return yield this.getProvider(n).request(i)}))}buildRequestParamFromRequest(e,t){(0,u.logDebug)("UniversalProvider request args >>>: ",t,JSON.stringify(e));const[n,i]=this.validateChain(t);if(!this.session)throw new u.OKXConnectError(u.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"Please call connect() before request()");let s=Object.keys(this.session.namespaces);if(!t&&s&&s.length>1)throw new u.OKXConnectError(u.OKX_CONNECT_ERROR_CODES.NOT_CONNECTED_ERROR,"Multiple chains have been linked, the request method requires chain");(0,u.logDebug)("UniversalProvider request >>args>>>: ",e);const o=Object.assign(Object.assign({},e),{chainId:`${n}:${i}`});return{namespace:n,requestParam:o}}enable(){return i(this,void 0,void 0,(function*(){if(!this.client)throw new u.OKXConnectError(u.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"Sign Client not initialized");if(!this.session){if(!this.connectOpts)throw new u.OKXConnectError(u.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"Sign Client not initialized");yield this.connect(this.connectOpts)}const e=yield this.requestAccounts();return e}))}disconnect(){return i(this,void 0,void 0,(function*(){if(!this.session)throw new u.OKXConnectError(u.OKX_CONNECT_ERROR_CODES.NOT_CONNECTED_ERROR);return new Promise((e=>i(this,void 0,void 0,(function*(){let t=!1;const n=()=>{t||(t=!0,this.disconnectAndEmit(),this.cleanup().then(e))};try{yield this.client.disconnect(),n()}catch(i){t||this.cleanup().then(e)}finally{n()}}))))}))}disconnectAndEmit(){var e,t;this.client.engine.connectionManager.disconnect(),this.events.emit("disconnect",{topic:null===(e=this.session)||void 0===e?void 0:e.topic}),this.events.emit("session_delete",{topic:null===(t=this.session)||void 0===t?void 0:t.topic})}aptosChainNameToGeneralId(e){return"aptos:mainnet"==e?"aptos:637":"movement:testnet"==e?"aptos:70000060":e}replaceAptos(e){var t,n;let i=null===(t=e.namespaces)||void 0===t?void 0:t["aptos"];if(void 0!=i){let t=this.replaceAptosInner(i);void 0!=e.namespaces&&"aptos"in e.namespaces&&void 0!=t&&(e.namespaces.aptos=t)}let s=null===(n=e.optionalNamespaces)||void 0===n?void 0:n["aptos"];if(void 0!=s){let t=this.replaceAptosInner(s);void 0!=e.optionalNamespaces&&"aptos"in e.optionalNamespaces&&void 0!=t&&(e.optionalNamespaces.aptos=t)}return e}replaceAptosInner(e){var t;return void 0!=e&&(e.chains=null===(t=e.chains)||void 0===t?void 0:t.map((e=>this.aptosChainNameToGeneralId(e))),void 0!=e.defaultChain&&(e.defaultChain=this.aptosChainNameToGeneralId(e.defaultChain))),e}connect(e){return i(this,void 0,void 0,(function*(){if(!this.client)throw new u.OKXConnectError(u.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"Sign Client not initialized");if(e=this.replaceAptos(e),this.session)throw new u.OKXConnectError(u.OKX_CONNECT_ERROR_CODES.ALREADY_CONNECTED_ERROR);(0,u.logDebug)("OKXUniversalProvider connect >>>>",JSON.stringify(e)),void 0===e.sessionConfig&&(e.sessionConfig={}),void 0===e.sessionConfig.openUniversalUrl&&(e.sessionConfig.openUniversalUrl=(0,u.isMobileUserAgent)()),this.setNamespaces(e);try{(0,u.logDebug)(`UniversalProvider connect opts.stringify ====> ${JSON.stringify(e)}`);let t=yield this.client.connect(e);return(0,u.logDebug)(`UniversalProvider connect success ====> ${JSON.stringify(t)}`),t?(this.session=t,this.onConnect(),t):void 0}catch(t){throw(0,u.logDebug)("UniversalProvider connect error ====> ",JSON.stringify(t)),t}}))}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}setDefaultChain(e,t){e=this.aptosChainNameToGeneralId(e);try{if(!this.session)return;const[n,i]=this.validateChain(e),s=this.getProvider(n);s.setDefaultChain(i,t)}catch(n){if(!/Please call connect/.test(n.message))throw n}}checkStorage(){return i(this,void 0,void 0,(function*(){let e=yield this.getFromStore("connectSession");if((0,u.logDebug)(e),e){let t=e;this.session=t,this.client.session=this.session,this.sessionConfig=t.sessionConfig,this.client.sessionConfig=this.sessionConfig,(0,u.logDebug)("[evm u-provider] do reconnection",this.session),yield this.client.restoreconnect(t),this.createProviders(),setTimeout((()=>{this.events.emit("reconnect",{session:this.session})}),100)}}))}initialize(){return i(this,void 0,void 0,(function*(){const e=Object.assign({url:window.location.hostname,origin:window.location.origin},this.providerOpts.dappMetaData);(0,o.setGlobal)("events",this.events),this.client=new d.SignClient(e),(0,o.setGlobal)("client",this.client),yield this.checkStorage()}))}createProviders(){if(!this.client)throw new u.OKXConnectError(u.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"Sign Client not initialized");if(!this.session)throw new u.OKXConnectError(u.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map((e=>(0,h.parseNamespaceKey)(e))))];e.forEach((e=>{if(!this.session)return;const t=this.session.namespaces,n=t[e];switch((0,u.logDebug)("init eip155 >> ",n),e){case"eip155":const t={namespace:n};this.rpcProviders[e]=new r.Eip155Provider(t);break;case"solana":const i={namespace:n};let s=new f.default(i,"solana");this.rpcProviders[e]=s;let o=new f.default(i,"sonic");this.rpcProviders["sonic"]=o;let c=new f.default(i,"svm");this.rpcProviders["svm"]=c;break;case"ton":const l={namespace:n};let d=new b.default(l);this.rpcProviders[e]=d;break;case"sui":const u={namespace:n};let h=new a.SuiProvider(u);h.name="sui",this.rpcProviders[e]=h;break;case"btc":const _={namespace:n};let m=new p.default(_,"btc");this.rpcProviders["btc"]=m;let v=new p.default(_,"fractal");this.rpcProviders["fractal"]=v;break;case"aptos":let O=new g.default({namespace:n},"aptos");this.rpcProviders[e]=O;break}}))}registerEventListeners(){if("undefined"===typeof this.client)throw new u.OKXConnectError(u.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"Sign Client is not initialized");this.client.engine.addDisconnectListener((()=>{this.disconnectAndEmit(),this.cleanup()})),this.on(c.PROVIDER_EVENTS.DEFAULT_CHAIN_CHANGED,(e=>{this.onChainChanged(e)})),this.on(c.PROVIDER_EVENTS.UPDATE_NAMESPACES,(e=>{if(e){const t=Object.keys(e)[0];this.session&&(this.session.namespaces[t]=e[t],this.session&&(this.persist("connectSession",this.session),this.events.emit("session_update",this.session)),(0,u.logDebug)("PROVIDER_EVENTS.UPDATE_NAMESPACES this.session... ->>>",JSON.stringify(this.session)))}}))}getProvider(e){return(0,u.logDebug)("current get providers",this.rpcProviders),(0,u.logDebug)("query namespace: ",e),this.rpcProviders[e]}setNamespaces(e){this.connectOpts=e;const{namespaces:t,sessionConfig:n}=e,i={origin:window.location.origin,url:window.location.hostname,name:this.providerOpts.dappMetaData.name,icon:this.providerOpts.dappMetaData.icon};this.sessionConfig={dappInfo:i,openUniversalUrl:null===n||void 0===n?void 0:n.openUniversalUrl,redirect:null===n||void 0===n?void 0:n.redirect},(0,u.logDebug)("setNamespaces sessionConfig>>>",this.sessionConfig),this.client.sessionConfig=this.sessionConfig,this.persist("sessionConfig",n)}validateChain(e){var t;let[n,i]=(null===e||void 0===e?void 0:e.split(":"))||["",""];if(!this.session||!this.session.namespaces||!Object.keys(this.session.namespaces).length)return(0,u.logDebug)("get name & chain",n,i),[n,i];if(n){if(!this.isChainNamespaceInSession(n))throw new u.OKXConnectError(u.OKX_CONNECT_ERROR_CODES.NOT_CONNECTED_ERROR,`Namespace '${n}' is not configured. Please call connect() first with namespace config.`);if(i&&e){(0,u.logDebug)("this.session.namespaces --\x3e> ",n,JSON.stringify(this.session.namespaces));const i=null===(t=this.session.namespaces[n])||void 0===t?void 0:t.chains;if((0,u.logDebug)("get chainsArr & chain",JSON.stringify(i),e),i&&!i.includes(e))throw new u.OKXConnectError(u.OKX_CONNECT_ERROR_CODES.NOT_CONNECTED_ERROR,`Namespace not include the chain '${e}'`)}}if(n&&i)return(0,u.logDebug)("get name & chain",n,i),[n,i];let s=(0,h.parseNamespaceKey)(Object.keys(this.session.namespaces)[0]);const o=this.rpcProviders[s].getDefaultChain();return(0,u.logDebug)("get default chain:",o),[s,o]}isChainNamespaceInSession(e){var t,n;if(Object.keys((null===(t=this.session)||void 0===t?void 0:t.namespaces)||{}).map((e=>(0,h.parseNamespaceKey)(e))).includes(e))return!0;let i=!1;return Object.values((null===(n=this.session)||void 0===n?void 0:n.namespaces)||{}).forEach((t=>{t.chains.forEach((t=>{t.split(":")[0]==e&&(i=!0)}))})),i}requestAccountsWithNamespace(e){return this.getProvider(e).requestAccounts()}requestDefaultChainWithNamespace(e){return this.getProvider(e).getDefaultChain()}requestAccounts(){return i(this,void 0,void 0,(function*(){const[e]=this.validateChain();return yield this.getProvider(e).requestAccounts()}))}onChainChanged(e){var t;if(!(null===(t=this.session)||void 0===t?void 0:t.namespaces))return;const[n,i]=this.validateChain(e);i&&(this.session.namespaces[n]&&(this.session.namespaces[n].defaultChain=i,this.persist("connectSession",this.session)),this.events.emit("chainChanged",i))}onConnect(){this.createProviders(),this.session&&this.persist("connectSession",this.session),this.events.emit("connect",{session:this.session}),this.registerEventListeners()}cleanup(){return i(this,void 0,void 0,(function*(){this.session=void 0,this.sessionProperties=void 0,this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),this.persist("connectSession",void 0)}))}persist(e,t){return(0,u.logDebug)("[evm u-provider] persisit data",e,t),this.client.engine.connectionManager.saveSessionContent(e,t)}getFromStore(e){return i(this,void 0,void 0,(function*(){return this.client.engine.connectionManager.getSessionContent(e)}))}showRequestModal(e,t){try{const{namespace:n,requestParam:i}=this.buildRequestParamFromRequest(e,t);return this.getProvider(n).showRequestModal(i)}catch(n){return!1}}}t.OKXUniversalProvider=_,t["default"]=_},6280:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,s)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.OKXConnectError=t.OKX_CONNECT_ERROR_CODES=t.NameSpaceKeyBtc=t.NameSpaceKeySui=t.OKXBtcProvider=t.OKXUniversalProvider=void 0,s(n(66154),t);var o=n(11948);Object.defineProperty(t,"OKXUniversalProvider",{enumerable:!0,get:function(){return o.OKXUniversalProvider}});var r=n(46262);Object.defineProperty(t,"OKXBtcProvider",{enumerable:!0,get:function(){return r.OKXBtcProvider}});var a=n(65418);Object.defineProperty(t,"NameSpaceKeySui",{enumerable:!0,get:function(){return a.NameSpaceKeySui}}),Object.defineProperty(t,"NameSpaceKeyBtc",{enumerable:!0,get:function(){return a.NameSpaceKeyBtc}}),Object.defineProperty(t,"OKX_CONNECT_ERROR_CODES",{enumerable:!0,get:function(){return a.OKX_CONNECT_ERROR_CODES}}),Object.defineProperty(t,"OKXConnectError",{enumerable:!0,get:function(){return a.OKXConnectError}})},82781:function(e,t,n){"use strict";n(41011),n(41011);var i=this&&this.__awaiter||function(e,t,n,i){function s(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function r(e){try{c(i.next(e))}catch(t){o(t)}}function a(e){try{c(i["throw"](e))}catch(t){o(t)}}function c(e){e.done?n(e.value):s(e.value).then(r,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.SignClient=void 0;const s=n(65418),o=n(94524),r=n(34310);class a extends s.ISignClient{constructor(e){super(e),this.engine=new s.Engine(new s.ConnectionManager),this.connect=e=>i(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{var i=[];(0,s.logDebug)("client connect params >>>",JSON.stringify(e));var r={name:"requestAccounts",requiredNamespaces:(0,o.nameSpaceToConnectWalletNameSpace)(e.namespaces),optionalNamespaces:(0,o.nameSpaceToConnectWalletNameSpace)(e.optionalNamespaces)};(0,s.logDebug)("client connect connectRequest >>>",JSON.stringify(i)),i.push(r),this.engine.universalConnect(i,Object.assign({dappInfo:this.metadata},e.sessionConfig),(e=>{if(e&&e.connectRequest){var t=(0,s.encodeConnectParams)(e.connectRequest);this.events.emit("display_uri",(0,s.getUniversalLink)((0,s.getAppWalletDeepLink)(t))),(0,s.logDebug)(`universalConect EngineConnectInfo  ${JSON.stringify(e)}`),this.events.emit("okx_engine_connect_params",e)}})).then((n=>{(0,o.fillParamsToSession)(n,e.namespaces,e.optionalNamespaces,this.sessionConfig),(0,s.logDebug)(`signClient: connect: session ${JSON.stringify(n)}`),t(n)})).catch((e=>{(0,s.logDebug)(`signClient: connect: catch ${JSON.stringify(e)}`),this.events.emit("connect_error",e),n(e)}))}))})),this.restoreconnect=e=>i(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{this.engine.restoreconnect(e,(e=>{t(e)}))}))})),this.reject=e=>i(this,void 0,void 0,(function*(){})),this.request=e=>i(this,void 0,void 0,(function*(){return new Promise(((t,n)=>i(this,void 0,void 0,(function*(){var i,o;(0,s.logDebug)("clint request --params>>>> >",null===(i=this.sessionConfig)||void 0===i?void 0:i.openUniversalUrl,JSON.stringify(e));try{(null===(o=this.sessionConfig)||void 0===o?void 0:o.openUniversalUrl)&&(0,s.isIos)()&&this.openOKXWallet(),yield this.engine.send(e,{resolve:e=>{if(delete e.requestId,(0,s.logDebug)("clint request --response >",JSON.stringify(e)),"error"in e&&e.error){let t=e.error;n(new s.OKXConnectError(e.error.code,e.method+":"+t.message))}else t(e)},onAck:()=>{var e;!(0,s.isIos)()&&(null===(e=this.sessionConfig)||void 0===e?void 0:e.openUniversalUrl)&&this.openOKXWallet()}})}catch(r){n(r)}}))))})),this.disconnect=()=>i(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{this.engine.send({method:"disconnect"},{onAck:()=>{e()}}).catch((e=>{console.log(`disconnect : ${JSON.stringify(e)}`),t(e)}))}))})),this.events=(0,r.getGlobal)("events"),this.metadata=e}openOKXWallet(){(0,s.logDebug)("bridge-provider ==>> connect_5"),(0,s.openOKXDeeplinkWithFallback)(s.standardDeeplink)}}t.SignClient=a},94524:function(e,t,n){"use strict";n(41011),n(41011),Object.defineProperty(t,"__esModule",{value:!0}),t.getAccountsChains=s,t.nameSpaceToConnectWalletNameSpace=o,t.fillParamsToSession=r,t.isCaipNamespace=a,t.parseNamespaceKey=c;const i=n(65418);function s(e){const t=[];return e.forEach((e=>{const[n,i]=e.split(":");t.push(`${n}:${i}`)})),t}function o(e){var t=[];return e?(Object.keys(e).forEach((n=>{n!==i.NameSpaceKeyEip155&&n!==i.NameSpaceKeySOL&&n!==i.NameSpaceKeySui&&n!==i.NameSpaceKeyAptos&&n!=i.NameSpaceKeyBtc&&n!==i.NameSpaceKeyTON||e[n].chains&&t.push({namespace:n,chains:e[n].chains,params:e[n].params})})),t):t}function r(e,t,n,i){const s=(e,t)=>{Object.assign(e,t)},o=(e,t)=>{for(const n in t)t.hasOwnProperty(n)&&t[n].rpcMap&&(t[n].rpcMap&&(e[n].rpcMap||(e[n].rpcMap={}),s(e[n].rpcMap,t[n].rpcMap)),t[n].defaultChain&&void 0===e[n].defaultChain&&e[n].chains.some((e=>e.split(":")[1]===t[n].defaultChain))&&(e[n].defaultChain=t[n].defaultChain))};t&&o(e.namespaces,t),n&&o(e.namespaces,n),e.sessionConfig=i}function a(e){return e.includes(":")}function c(e){return a(e)?e.split(":")[0]:e}},79385:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PROVIDER_EVENTS=void 0,t.PROVIDER_EVENTS={DEFAULT_CHAIN_CHANGED:"default_chain_changed",UPDATE_NAMESPACES:"update_name_spaces"}},27186:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,s)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),s(n(92530),t),s(n(79385),t)},92530:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GENERIC_SUBPROVIDER_NAME=t.RPC_URL=t.STORAGE=t.CONTEXT=t.WC_VERSION=t.PROTOCOL=t.RELAY_URL=t.LOGGER=void 0,t.LOGGER="error",t.RELAY_URL="wss://relay.walletconnect.com",t.PROTOCOL="wc",t.WC_VERSION=2,t.CONTEXT="universal_provider",t.STORAGE=`${t.PROTOCOL}@${t.WC_VERSION}:${t.CONTEXT}:`,t.RPC_URL="https://rpc.walletconnect.com/v1/",t.GENERIC_SUBPROVIDER_NAME="generic"},96548:function(e,t,n){"use strict";n(88373),n(51555),n(33734),n(22035),n(94932),n(50427),n(19239),n(88373),n(51555),n(33734),n(22035),n(94932),n(50427),n(19239);var i=this&&this.__awaiter||function(e,t,n,i){function s(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function r(e){try{c(i.next(e))}catch(t){o(t)}}function a(e){try{c(i["throw"](e))}catch(t){o(t)}}function c(e){e.done?n(e.value):s(e.value).then(r,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=n(27186),o=n(65418),r=n(34310),a=n(56100),c=n(34225);class l{constructor(e,t){this.name="aptos",this.namespace=e.namespace,this.events=(0,r.getGlobal)("events"),this.client=(0,r.getGlobal)("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders(),this.name=t}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return i(this,void 0,void 0,(function*(){return(0,o.logDebug)("solana request --args--string>",JSON.stringify(e)),(0,o.logDebug)("solana provider namespace: ",this.namespace),this.namespace.methods.includes(e.method)?this.client.request(e):this.getHttpProvider().request(e)}))}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(s.PROVIDER_EVENTS.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter((e=>e.split(":")[1]===this.chainId.toString())).map((e=>e.split(":")[2])))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach((t=>{const n=(0,r.getChainId)(t),i=(0,r.getRpcUrl)(t,this.namespace);let s=this.createHttpProvider(n,i);s&&(e[n]=s)})),e}getHttpProvider(){const e=`${this.chainId}`,t=this.httpProviders[e];if("undefined"===typeof t)throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t;if(n){const e=new c.JsonRpcProvider(new a.JsonRpcConnection(n,(0,r.getGlobal)("disableProviderPing")));return e}(0,o.logError)(`No RPC url provided for chainId: ${e}`)}showRequestModal(e){return!0}}t["default"]=l},24142:function(e,t,n){"use strict";n(88373),n(51555),n(33734),n(22035),n(94932),n(50427),n(19239),n(88373),n(51555),n(33734),n(22035),n(94932),n(50427),n(19239);var i=this&&this.__awaiter||function(e,t,n,i){function s(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function r(e){try{c(i.next(e))}catch(t){o(t)}}function a(e){try{c(i["throw"](e))}catch(t){o(t)}}function c(e){e.done?n(e.value):s(e.value).then(r,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=n(27186),o=n(65418),r=n(34310),a=n(56100),c=n(34225);class l{constructor(e,t){this.name=o.NameSpaceKeyBtc,this.namespace=e.namespace,this.events=(0,r.getGlobal)("events"),this.client=(0,r.getGlobal)("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders(),this.name=t}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return i(this,void 0,void 0,(function*(){return(0,o.logDebug)("btc request --args--string>",JSON.stringify(e)),(0,o.logDebug)("btc provider namespace: ",JSON.stringify(this.namespace)),this.namespace.methods.includes(e.method)?this.client.request(e):this.getHttpProvider().request(e)}))}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(s.PROVIDER_EVENTS.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter((e=>e.split(":")[1]===this.chainId.toString())).map((e=>e.split(":")[2])))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach((t=>{const n=(0,r.getChainId)(t),i=(0,r.getRpcUrl)(t,this.namespace);let s=this.createHttpProvider(n,i);s&&(e[n]=s)})),e}getHttpProvider(){const e=`${this.chainId}`,t=this.httpProviders[e];if("undefined"===typeof t)throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t;if(n){const e=new c.JsonRpcProvider(new a.JsonRpcConnection(n,(0,r.getGlobal)("disableProviderPing")));return e}(0,o.logError)(`No RPC url provided for chainId: ${e}`)}showRequestModal(e){return!0}}t["default"]=l},19066:function(e,t,n){"use strict";n(41011),n(88373),n(51555),n(33734),n(22035),n(94932),n(50427),n(19239),n(41011),n(88373),n(51555),n(33734),n(22035),n(94932),n(50427),n(19239);var i=this&&this.__awaiter||function(e,t,n,i){function s(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function r(e){try{c(i.next(e))}catch(t){o(t)}}function a(e){try{c(i["throw"](e))}catch(t){o(t)}}function c(e){e.done?n(e.value):s(e.value).then(r,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Eip155Provider=void 0;const s=n(34310),o=n(27186),r=n(65418),a=n(34225),c=n(56100);class l{constructor(e){this.name="eip155",this.namespace=e.namespace,this.events=(0,s.getGlobal)("events"),this.client=(0,s.getGlobal)("client"),this.chainId=parseInt(this.getDefaultChain()),this.httpProviders=this.createHttpProviders(),(0,r.logDebug)("eip155 constructor --opts.namespace--\x3e",e.namespace)}isRecord(e){return"object"===typeof e&&null!==e&&!Array.isArray(e)}isArray(e){return"object"===typeof e&&null!==e&&Array.isArray(e)}updateRequestParams(e){let t=e.params&&"object"===typeof e.params&&!Array.isArray(e.params);if("wallet_switchEthereumChain"===e.method){const n=e.chainId.split(":")[1],i=parseInt(n,10);if(isNaN(i))throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.NOT_CONNECTED_ERROR,`Invalid decimal number,  chainId: '${n}' `);if(e.params){if(!t)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.NOT_CONNECTED_ERROR,`Request params error ,  method: '${e.method}' `);{let t=e.params;"chainId"in t||(t["chainId"]="0x"+i.toString(16),e.params=t)}}else e.params={chainId:"0x"+i.toString(16)}}else if("personal_sign"===e.method||"eth_signTypedData_v4"===e.method||"eth_sendTransaction"===e.method||"wallet_watchAsset"===e.method){if(!e.params)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.NOT_CONNECTED_ERROR,`Request params is nil, method: '${e.method}'`);if(!this.isRecord(e.params))throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.NOT_CONNECTED_ERROR,`Invalid request params type, method: '${e.method}'`);{let t=e.params;if((0,r.logDebug)("eip155 updateRequestParams params>",JSON.stringify(t)),"chainId"in t){const n=e.chainId.split(":")[1],i=parseInt(n,10);let s,o=String(t.chainId);if(o.startsWith(this.name)&&e.chainId===o)s=i;else if(o.startsWith("0x"))s=parseInt(o,16);else{if(isNaN(Number(o)))throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.NOT_CONNECTED_ERROR,`Invalid params.chainId format, method: '${e.method}'`);s=parseInt(o,10)}if(i!==s)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.NOT_CONNECTED_ERROR,`Request params.chainId not equal chain,  method: '${e.method}' `)}}}}adaptArray(e){if("wallet_switchEthereumChain"===e.method||"wallet_addEthereumChain"===e.method||"wallet_watchAsset"===e.method||"eth_sendTransaction"===e.method){if(this.isArray(e.params)){let t=e.params;if(t){if(1!==t.length)throw t.length>1?new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`Request params only Support one data,  method: '${e.method}' `):new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`Request params is nil,  method: '${e.method}' `);{let t=e.params[0];this.isRecord(t)&&(e.params=t)}}}}else if("eth_signTypedData_v4"===e.method){if(this.isArray(e.params)){let n=e.params;if(n&&n.length>2)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`Request params only Support one data,  method: '${e.method}' `);if(n&&0===n.length)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`Request params is nil,  method: '${e.method}' `);let i={};if(n&&2===n.length){let t=e.params[0];if(!t||"string"!==typeof t)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`Request params address error , not string,  method: '${e.method}' `);{let n=!1;if(this.namespace.accounts.forEach((e=>{let i=e.split(":")[2];i===t&&(n=!0)})),(0,r.logDebug)("eip155 adaptArray eth_signTypedData_v4 >>>isEqual: ",n),!n)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`Request params address error, not equal,  method: '${e.method}' `);if(!this.isRecord(e.params[1]))throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`Request params message data error,  method: '${e.method}' `);i=e.params[1]}}else if(n&&1===n.length){if(!this.isRecord(e.params[0]))throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`Request params message data error,  method: '${e.method}' `);i=e.params[0]}try{let t=JSON.stringify(i);e.params={typedDataJson:t}}catch(t){throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`Request params call JSON.stringify() failed,  method: '${e.method}' `)}}}else if("personal_sign"===e.method&&this.isArray(e.params)){if(e.params&&e.params.length>2)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`Request params error,  method: '${e.method}' `);if(e.params&&0===e.params.length)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`Request params is nil,  method: '${e.method}' `);let t=e.params[0],n=e.params[1];if(n&&"string"===typeof n){let t=!1;if(this.namespace.accounts.forEach((e=>{let i=e.split(":")[2];i===n&&(t=!0)})),(0,r.logDebug)("eip155 adaptArray personal_sign >>>isEqual: ",t),!t)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`Request params address error,  method: '${e.method}' `)}if(!t||"string"!==typeof t)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`Request params is error,  method: '${e.method}' `);e.params={message:t}}}showRequestModal(e){switch(e.method){case"eth_requestAccounts":case"eth_accounts":case"eth_chainId":return!1;case"eth_sendTransaction":case"eth_signTransaction":case"eth_sign":case"personal_sign":case"eth_signTypedData":case"wallet_addEthereumChain":case"wallet_watchAsset":case"eth_signTypedData_v4":return!0;case"wallet_switchEthereumChain":{this.adaptArray(e),this.updateRequestParams(e);const{parsedChainId:t,hexChainId:n}=this.getHexChainIdFromRequest(e);return!this.isChainApproved(t)}default:return!1}return!1}request(e){return i(this,void 0,void 0,(function*(){switch(this.adaptArray(e),(0,r.logDebug)("eip155 request --args--string>",JSON.stringify(e)),this.updateRequestParams(e),(0,r.logDebug)("eip155 request --params--string>",JSON.stringify(e)),e.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_switchEthereumChain":return yield this.handleSwitchChain(e);case"wallet_addEthereumChain":return this.addEthereumChain(e);default:break}if(!this.namespace.methods.includes(e.method))return(0,r.logDebug)("[RPC] request begin"),yield this.getHttpProvider().request(e);try{const t=yield this.client.request(e);if((0,r.logDebug)("eip155 request --response----string>",JSON.stringify(t)),this.isRecord(t)&&"result"in t){let e=t.result;return!e||"string"!==typeof e||"true"!==e&&"false"!==e?t.result:((0,r.logDebug)("eip155 request --wallet_watchAsset>>>>","true"===e),"true"===e)}return t}catch(t){throw(0,r.logDebug)(`eip155 request --response --error--string> e instanceof OKXConnectError ${t instanceof r.OKXConnectError}`,JSON.stringify(t)),t}}))}addEthereumChain(e){return i(this,void 0,void 0,(function*(){let t=yield this.client.request(e);try{if("result"in t){let n=t.result;if(n){const t=n.split(":")[0],i=n.split(":")[1],s=t+":"+i;this.namespace;if(this.namespace.accounts.push(n),this.namespace.chains.push(s),this.isRecord(e.params)&&"rpcUrls"in e.params){let t=e.params.rpcUrls,n=t?t[0]:void 0;n&&(this.namespace.rpcMap?this.namespace.rpcMap[i]=n:this.namespace.rpcMap={[i]:n},this.setHttpProvider(i,n))}this.events.emit(o.PROVIDER_EVENTS.UPDATE_NAMESPACES,{eip155:this.namespace})}}else new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`the method ${e.method} request error`)}catch(n){throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`the method ${e.method} request  error`)}return null}))}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){if(this.chainId=parseInt(e),!this.httpProviders[e]){const n=t||(0,s.getRpcUrl)(`${this.name}:${e}`,this.namespace);n?this.setHttpProvider(e,n):(0,r.logError)(`No RPC url provided for chainId: ${e}`)}this.events.emit(o.PROVIDER_EVENTS.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return(0,r.logDebug)("eip155 getAccounts ",e,this.chainId),e?[...new Set(e.filter((e=>e.split(":")[1]===this.chainId.toString())).map((e=>e.split(":")[2])))]:[]}getHexChainIdFromRequest(e){let t=e.params,n="0x0";t&&"chainId"in t&&(n=t.chainId),n=n.startsWith("0x")?n:`0x${n}`,(0,r.logDebug)("handleSwitchChain --\x3eargs ",e),(0,r.logDebug)("handleSwitchChain --\x3ehexChainId ",n);const i=parseInt(n,16);return(0,r.logDebug)("handleSwitchChain --\x3eparsedChainId ",i),{parsedChainId:i,hexChainId:n}}handleSwitchChain(e){return i(this,void 0,void 0,(function*(){const{parsedChainId:t,hexChainId:n}=this.getHexChainIdFromRequest(e);if(this.isChainApproved(t))this.setDefaultChain(`${t}`);else{const s=yield this.client.request({method:"wallet_switchEthereumChain",chainId:e.chainId,params:{chainId:n}});try{if("result"in s){let e=s.result;if(e){const n=e.split(":")[0],i=e.split(":")[1],a=n+":"+i;this.namespace;this.namespace.accounts.push(e),this.namespace.chains.push(a),(0,r.logDebug)("handleSwitchChain --\x3ewallet_switchEthereumChain ",s),this.setDefaultChain(`${t}`),this.events.emit(o.PROVIDER_EVENTS.UPDATE_NAMESPACES,{eip155:this.namespace})}}else new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`the method ${e.method} request error`)}catch(i){throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`the method ${e.method} request  error`)}}return null}))}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}createHttpProvider(e,t){const n=t;if(n){const e=new a.JsonRpcProvider(new c.JsonRpcConnection(n,(0,s.getGlobal)("disableProviderPing")));return e}(0,r.logError)(`No RPC url provided for chainId: ${e}`)}createHttpProviders(){const e={};return this.namespace.chains.forEach((t=>{const n=(0,s.getChainId)(t),i=(0,s.getRpcUrl)(t,this.namespace);(0,r.logDebug)("get parsed chain and rpc:",n,i);let o=this.createHttpProvider(n,i);o&&(e[n]=o)})),(0,r.logDebug)("get http providermap:",e),e}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}getHttpProvider(){const e=`${this.chainId}`,t=this.httpProviders[e];if((0,r.logDebug)("[RPC] get http provider:",e,t),"undefined"===typeof t)throw new Error(`JSON-RPC provider for ${e} not found`);return t}}t.Eip155Provider=l,t["default"]=l},56100:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){function s(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function r(e){try{c(i.next(e))}catch(t){o(t)}}function a(e){try{c(i["throw"](e))}catch(t){o(t)}}function c(e){e.done?n(e.value):s(e.value).then(r,a)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.JsonRpcConnection=void 0;const o=n(47736),r=s(n(60309)),a=n(65418),c=n(65418),l={Accept:"application/json","Content-Type":"application/json"},d="POST",u={headers:l,method:d};class h{constructor(e,t=!1){if(this.url=e,this.disableProviderPing=t,this.events=new o.EventEmitter,this.isAvailable=!1,this.registering=!1,!(0,c.isHttpUrl)(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=t}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}open(){return i(this,arguments,void 0,(function*(e=this.url){yield this.register(e)}))}close(){return i(this,void 0,void 0,(function*(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}))}send(e){return i(this,void 0,void 0,(function*(){this.isAvailable||(yield this.register());try{const t=(0,a.safeJsonStringify)(e),n=yield(0,r.default)(this.url,Object.assign(Object.assign({},u),{body:t})),i=yield n.json();this.onPayload({data:i})}catch(t){this.onError(e.id,t)}}))}register(){return i(this,arguments,void 0,(function*(e=this.url){if(!(0,c.isHttpUrl)(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering)return new Promise(((e,t)=>{this.events.once("register_error",(e=>{t(e)})),this.events.once("open",(()=>{if("undefined"===typeof this.isAvailable)return t(new Error("HTTP connection is missing or invalid"));e()}))}));this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const t=(0,a.safeJsonStringify)({id:1,jsonrpc:"2.0",method:"test",params:[]});yield(0,r.default)(e,Object.assign(Object.assign({},u),{body:t}))}this.onOpen()}catch(t){const e=this.parseError(t);throw this.events.emit("register_error",e),this.onClose(),e}}))}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if("undefined"===typeof e.data)return;const t="string"===typeof e.data?(0,a.safeJsonParse)(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const n=this.parseError(t),i=n.message||n.toString(),s=(0,c.formatJsonRpcError)(e,i);this.events.emit("payload",s)}parseError(e,t=this.url){return(0,c.parseConnectionError)(e,t,"HTTP")}}t.JsonRpcConnection=h},34225:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){function s(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function r(e){try{c(i.next(e))}catch(t){o(t)}}function a(e){try{c(i["throw"](e))}catch(t){o(t)}}function c(e){e.done?n(e.value):s(e.value).then(r,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.JsonRpcProvider=void 0;const s=n(47736),o=n(66154),r=n(65418),a=n(65418);class c extends o.IJSONRpcProvider{constructor(e){super(e),this.events=new s.EventEmitter,this.connected=!1,this.connecting=!1,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}connect(){return i(this,arguments,void 0,(function*(e=this.connection){yield this.open(e)}))}disconnect(){return i(this,void 0,void 0,(function*(){yield this.close()}))}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}request(e,t){return i(this,void 0,void 0,(function*(){return this.requestStrict((0,r.formatJsonRpcRequest)(e.method,e.params||[],(0,r.getBigIntRpcId)().toString()),t)}))}requestStrict(e,t){return i(this,void 0,void 0,(function*(){return new Promise(((n,s)=>i(this,void 0,void 0,(function*(){if(!this.connection.connected)try{yield this.open()}catch(i){s(i)}this.events.on(`${e.id}`,(e=>{(0,r.isJsonRpcError)(e)?s(e.error):n(e.result)}));try{(0,a.logDebug)("[RPC] >>> send request",e,t),yield this.connection.send(e,t)}catch(i){s(i)}}))))}))}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),(0,r.isJsonRpcResponse)(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&3e3===e.code&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}open(){return i(this,arguments,void 0,(function*(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),"string"===typeof e&&(yield this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),yield this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}))}close(){return i(this,void 0,void 0,(function*(){yield this.connection.close()}))}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",(e=>this.onPayload(e))),this.connection.on("close",(e=>this.onClose(e))),this.connection.on("error",(e=>this.events.emit("error",e))),this.connection.on("register_error",(e=>this.onClose())),this.hasRegisteredEventListeners=!0)}}t.JsonRpcProvider=c},55637:function(e,t,n){"use strict";n(88373),n(51555),n(33734),n(22035),n(94932),n(50427),n(19239),n(88373),n(51555),n(33734),n(22035),n(94932),n(50427),n(19239);var i=this&&this.__awaiter||function(e,t,n,i){function s(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function r(e){try{c(i.next(e))}catch(t){o(t)}}function a(e){try{c(i["throw"](e))}catch(t){o(t)}}function c(e){e.done?n(e.value):s(e.value).then(r,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.SolanaProvider=void 0;const s=n(27186),o=n(65418),r=n(34310),a=n(56100),c=n(34225);class l{constructor(e,t){this.name="solana",this.namespace=e.namespace,this.events=(0,r.getGlobal)("events"),this.client=(0,r.getGlobal)("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders(),this.name=t}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return i(this,void 0,void 0,(function*(){return(0,o.logDebug)("solana request --args--string>",JSON.stringify(e)),(0,o.logDebug)("solana provider namespace: ",this.namespace),this.namespace.methods.includes(e.method)?this.client.request(e):this.getHttpProvider().request(e)}))}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(s.PROVIDER_EVENTS.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter((e=>e.split(":")[1]===this.chainId.toString())).map((e=>e.split(":")[2])))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach((t=>{const n=(0,r.getChainId)(t),i=(0,r.getRpcUrl)(t,this.namespace);let s=this.createHttpProvider(n,i);s&&(e[n]=s)})),e}getHttpProvider(){const e=`${this.chainId}`,t=this.httpProviders[e];if("undefined"===typeof t)throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t;if(n){const e=new c.JsonRpcProvider(new a.JsonRpcConnection(n,(0,r.getGlobal)("disableProviderPing")));return e}(0,o.logError)(`No RPC url provided for chainId: ${e}`)}getPubkey(e){return this.getWalletAddress(e)}getWalletAddress(e){return e||(e=this.namespace.defaultChain,(null===e||void 0===e?void 0:e.startsWith("solana"))||(e=`solana:${e}`)),this.namespace.accounts.filter((function(t){let n=t.split(":");return n.length>2&&t.startsWith(e)})).map((function(e){let t=e.split(":");return t[2]}))[0]}showRequestModal(e){return!0}}t.SolanaProvider=l,t["default"]=l},45530:function(e,t,n){"use strict";n(88373),n(51555),n(33734),n(22035),n(94932),n(50427),n(19239),n(88373),n(51555),n(33734),n(22035),n(94932),n(50427),n(19239);var i=this&&this.__awaiter||function(e,t,n,i){function s(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function r(e){try{c(i.next(e))}catch(t){o(t)}}function a(e){try{c(i["throw"](e))}catch(t){o(t)}}function c(e){e.done?n(e.value):s(e.value).then(r,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.SuiProvider=void 0;const s=n(27186),o=n(65418),r=n(34310),a=n(56100),c=n(34225);class l{constructor(e){this.name=o.NameSpaceKeySui,this.namespace=e.namespace,this.events=(0,r.getGlobal)("events"),this.client=(0,r.getGlobal)("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}request(e){return i(this,void 0,void 0,(function*(){return(0,o.logDebug)("sui request --args--string>",JSON.stringify(e)),(0,o.logDebug)("sui provider namespace: ",this.namespace),this.namespace.methods.includes(e.method)?this.client.request(e):this.getHttpProvider().request(e)}))}requestAccounts(){return this.getAccounts()}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(s.PROVIDER_EVENTS.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter((e=>e.split(":")[1]===this.chainId.toString())).map((e=>e.split(":")[2])))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach((t=>{const n=(0,r.getChainId)(t),i=(0,r.getRpcUrl)(t,this.namespace);let s=this.createHttpProvider(n,i);s&&(e[n]=s)})),e}getHttpProvider(){const e=`${this.chainId}`,t=this.httpProviders[e];if((0,o.logDebug)("[RPC] get http provider:",e,t),"undefined"===typeof t)throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&((0,o.logDebug)("setHttpProvider",e,t),this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t;if(n){const e=new c.JsonRpcProvider(new a.JsonRpcConnection(n,(0,r.getGlobal)("disableProviderPing")));return e}(0,o.logError)(`No RPC url provided for chainId: ${e}`)}getPubkey(e){return this.getWalletAddress(e)}getWalletAddress(e){return e||(e=this.namespace.defaultChain,(null===e||void 0===e?void 0:e.startsWith("sui"))||(e=`sui:${e}`)),this.namespace.accounts.filter((function(t){let n=t.split(":");return n.length>2&&t.startsWith(e)})).map((function(e){let t=e.split(":");return t[2]}))[0]}showRequestModal(e){switch(e.method){case"sui_signMessage":case"sui_signPersonalMessage":case"sui_signTransactionBlock":case"sui_signAndExecuteTransactionBlock":return!0;default:return!1}return!1}}t.SuiProvider=l,t["default"]=l},21936:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){function s(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function r(e){try{c(i.next(e))}catch(t){o(t)}}function a(e){try{c(i["throw"](e))}catch(t){o(t)}}function c(e){e.done?n(e.value):s(e.value).then(r,a)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var s=0;for(i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]])}return n};Object.defineProperty(t,"__esModule",{value:!0});const o=n(27186),r=n(65418),a=n(34310),c=n(56100),l=n(34225);class d{constructor(e){this.name=r.NameSpaceKeyTON,this.namespace=e.namespace,this.events=(0,a.getGlobal)("events"),this.client=(0,a.getGlobal)("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}isRecord(e){return"object"===typeof e&&null!==e&&!Array.isArray(e)}request(e){return i(this,void 0,void 0,(function*(){var t,n,i,o;if((0,r.logDebug)("TONProvider request --args--string>",JSON.stringify(e)),(0,r.logDebug)("TONProvider request provider namespace: ",this.namespace),this.namespace.methods.includes(e.method)){if(!e.params)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"ton request params is nil");if(this.isRecord(e.params)){const a=e.params,{validUntil:c}=a,l=s(a,["validUntil"]);let d=null===(n=null===(t=this.namespace.payload)||void 0===t?void 0:t.ton_addr)||void 0===n?void 0:n.address;"from"in l&&(d=l.from||(null===(o=null===(i=this.namespace.payload)||void 0===i?void 0:i.ton_addr)||void 0===o?void 0:o.address)),e.params["from"]=d,e.params["network"]=this.getDefaultChain(),e.params["valid_until"]=c;let u=yield this.client.request(e);if(this.isRecord(u)&&"result"in u){const e={boc:u.result.toString()};return(0,r.logDebug)("TONProvider request provider response: ",JSON.stringify(u)),(0,r.logDebug)("TONProvider request provider result: ",JSON.stringify(e)),e}throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"ton_send request response is nil")}throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"ton request params type add nil")}return this.getHttpProvider().request(e)}))}requestAccounts(){return this.getAccounts()}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(o.PROVIDER_EVENTS.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){var e,t;const n=this.namespace.accounts;if((0,r.logDebug)("ton getAccounts accounts :",n),(0,r.logDebug)("ton getAccounts .namespace :",JSON.stringify(this.namespace)),!n)return[];let i=null===(t=null===(e=this.namespace.payload)||void 0===e?void 0:e.ton_addr)||void 0===t?void 0:t.address;return(0,r.logDebug)("ton getAccounts address :",i),i?[i]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach((t=>{const n=(0,a.getChainId)(t),i=(0,a.getRpcUrl)(t,this.namespace);let s=this.createHttpProvider(n,i);s&&(e[n]=s)})),e}getHttpProvider(){const e=`${this.chainId}`,t=this.httpProviders[e];if((0,r.logDebug)("[RPC] get http provider:",e,t),"undefined"===typeof t)throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&((0,r.logDebug)("setHttpProvider",e,t),this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t;if(n){const e=new l.JsonRpcProvider(new c.JsonRpcConnection(n,(0,a.getGlobal)("disableProviderPing")));return e}(0,r.logError)(`No RPC url provided for chainId: ${e}`)}showRequestModal(e){switch(e.method){case"ton_sendTransaction":return!0;default:return!1}return!1}}t["default"]=d},66154:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,s)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),s(n(88312),t),s(n(73332),t)},73332:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},88312:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IJSONRpcProvider=t.IJSONRpcConnection=void 0;class n{}t.IJSONRpcConnection=n;class i{constructor(e){}}t.IJSONRpcProvider=i},18558:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setGlobal=t.getGlobal=void 0;const n={},i=e=>n[e];t.getGlobal=i;const s=(e,t)=>{n[e]=t};t.setGlobal=s},34310:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,s)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),s(n(18104),t),s(n(18558),t)},18104:function(e,t,n){"use strict";function i(e,t,n){var i;const s=a(e);return(null===(i=t.rpcMap)||void 0===i?void 0:i[s.reference])||""}function s(e){return e.includes(":")?e.split(":")[1]:e}function o(e){return"number"===typeof e?e:e.includes("0x")?parseInt(e,16):(e=e.includes(":")?e.split(":")[1]:e,isNaN(Number(e))?e:Number(e))}n(88373),n(51555),n(33734),n(22035),n(94932),n(50427),n(19239),n(88373),n(51555),n(33734),n(22035),n(94932),n(50427),n(19239),Object.defineProperty(t,"__esModule",{value:!0}),t.getRpcUrl=i,t.getChainId=s,t.convertChainIdToNumber=o,t.parseChainId=a,t.mergeArrays=c;const r=":";function a(e){const[t,n]=e.split(r);return{namespace:t,reference:n}}function c(e=[],t=[]){return[...new Set([...e,...t])]}},18167:function(e,t,n){"use strict";var i=n(93067),s=n(29281),o=(n(4188),n(2757)),r=n(46357);const a={id:"app"};function c(e,t,n,s,c,l){const d=(0,o.g2)("el-header"),u=(0,o.g2)("el-col"),h=(0,o.g2)("el-row"),f=(0,o.g2)("el-card"),p=(0,o.g2)("el-checkbox"),g=(0,o.g2)("el-option"),b=(0,o.g2)("el-select"),_=(0,o.g2)("el-input"),m=(0,o.g2)("el-button"),v=(0,o.g2)("qrcode-vue"),O=(0,o.g2)("el-tab-pane"),y=(0,o.g2)("BTCPanel"),C=(0,o.g2)("FractalPanel"),E=(0,o.g2)("el-tabs"),N=(0,o.g2)("el-main"),w=(0,o.g2)("el-container");return(0,o.uX)(),(0,o.CE)("div",a,[(0,o.bF)(w,null,{default:(0,o.k6)((()=>[(0,o.bF)(d,null,{default:(0,o.k6)((()=>t[49]||(t[49]=[(0,o.eW)("OKX Connect Evm")]))),_:1}),(0,o.bF)(N,null,{default:(0,o.k6)((()=>[(0,o.bF)(f,{class:"wallet-info"},{header:(0,o.k6)((()=>t[50]||(t[50]=[(0,o.Lk)("div",null,"钱包信息",-1)]))),default:(0,o.k6)((()=>[(0,o.bF)(h,{class:"info-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[t[51]||(t[51]=(0,o.Lk)("strong",null,"Wallet Address:",-1)),(0,o.eW)(" "+(0,r.v_)(l.getWalletAddress),1)])),_:1})])),_:1}),(0,o.bF)(h,{class:"info-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[t[52]||(t[52]=(0,o.Lk)("strong",null,"当前状态 :",-1)),(0,o.eW)(" "+(0,r.v_)(e.currentStatus),1)])),_:1})])),_:1})])),_:1}),(0,o.bF)(f,{class:"wallet-actions"},{header:(0,o.k6)((()=>t[53]||(t[53]=[(0,o.Lk)("div",null,"钱包操作",-1)]))),default:(0,o.k6)((()=>[(0,o.bF)(h,{class:"info-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(p,{modelValue:e.withUI,"onUpdate:modelValue":t[0]||(t[0]=t=>e.withUI=t),onChange:e.handleWithUI},{default:(0,o.k6)((()=>t[54]||(t[54]=[(0,o.eW)(" 是否展示UI")]))),_:1},8,["modelValue","onChange"])])),_:1})])),_:1}),(0,o.bF)(h,{style:{"align-items":"center"}},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:4},{default:(0,o.k6)((()=>t[55]||(t[55]=[(0,o.Lk)("p",{style:{"font-size":"11pt"}},"Modals",-1)]))),_:1}),(0,o.bF)(u,{span:20},{default:(0,o.k6)((()=>[(0,o.bF)(b,{modelValue:e.modals,"onUpdate:modelValue":t[1]||(t[1]=t=>e.modals=t),placeholder:"Modals",onChange:l.handleModalsSelect,multiple:""},{default:(0,o.k6)((()=>[(0,o.bF)(g,{label:"Before",value:"before"}),(0,o.bF)(g,{label:"Success",value:"success"}),(0,o.bF)(g,{label:"Error",value:"error"})])),_:1},8,["modelValue","onChange"])])),_:1})])),_:1}),(0,o.bF)(h,{style:{"align-items":"center"}},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:4},{default:(0,o.k6)((()=>t[56]||(t[56]=[(0,o.Lk)("p",{style:{"font-size":"11pt"}},"Language",-1)]))),_:1}),(0,o.bF)(u,{span:20},{default:(0,o.k6)((()=>[(0,o.bF)(b,{modelValue:e.language,"onUpdate:modelValue":t[2]||(t[2]=t=>e.language=t),onChange:l.handleLanguageSelect,placeholder:"Language"},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.locales,(e=>((0,o.uX)(),(0,o.Wv)(g,{key:`language-select-option-${e}`,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1})])),_:1}),(0,o.bF)(h,{style:{"align-items":"center"}},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:4},{default:(0,o.k6)((()=>t[57]||(t[57]=[(0,o.Lk)("p",{style:{"font-size":"11pt"}},"Theme",-1)]))),_:1}),(0,o.bF)(u,{span:20},{default:(0,o.k6)((()=>[(0,o.bF)(b,{modelValue:e.theme,"onUpdate:modelValue":t[3]||(t[3]=t=>e.theme=t),onChange:l.handleThemeSelect,placeholder:"Theme"},{default:(0,o.k6)((()=>[(0,o.bF)(g,{label:"LIGHT",value:e.THEME.LIGHT},null,8,["value"]),(0,o.bF)(g,{label:"DARK",value:e.THEME.DARK},null,8,["value"])])),_:1},8,["modelValue","onChange"])])),_:1})])),_:1}),(0,o.bF)(h,{style:{"align-items":"center"}},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:4},{default:(0,o.k6)((()=>t[58]||(t[58]=[(0,o.Lk)("p",{style:{"font-size":"11pt"}},"ton_proof",-1)]))),_:1}),(0,o.bF)(u,{span:20},{default:(0,o.k6)((()=>[(0,o.bF)(_,{modelValue:e.tonProofValue,"onUpdate:modelValue":t[4]||(t[4]=t=>e.tonProofValue=t),placeholder:"请输入ton_proof"},null,8,["modelValue"])])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,align:"middle"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:4},{default:(0,o.k6)((()=>t[59]||(t[59]=[(0,o.Lk)("div",null,"req",-1)]))),_:1}),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(Object.keys(e.availableChains),(t=>((0,o.uX)(),(0,o.Wv)(u,{span:6,key:t},{default:(0,o.k6)((()=>[(0,o.bF)(p,{modelValue:e.availableChains[t].checked,"onUpdate:modelValue":n=>e.availableChains[t].checked=n,disabled:!e.areChainsInit},{default:(0,o.k6)((()=>[(0,o.eW)((0,r.v_)(e.availableChains[t].name),1)])),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])])),_:2},1024)))),128))])),_:1}),(0,o.bF)(h,{gutter:12,align:"middle",style:{"margin-top":"20px"}},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:4},{default:(0,o.k6)((()=>t[60]||(t[60]=[(0,o.Lk)("div",null,"opt",-1)]))),_:1}),(0,o.bF)(u,{span:5},{default:(0,o.k6)((()=>[(0,o.bF)(p,{checked:e.isOptionalChecked(43114),onChange:t[5]||(t[5]=()=>e.handleOptionChange(43114))},{default:(0,o.k6)((()=>t[61]||(t[61]=[(0,o.eW)(" avax")]))),_:1},8,["checked"])])),_:1}),(0,o.bF)(u,{span:5},{default:(0,o.k6)((()=>[(0,o.bF)(p,{checked:e.isOptionalChecked(10),onChange:t[6]||(t[6]=()=>e.handleOptionChange(10))},{default:(0,o.k6)((()=>t[62]||(t[62]=[(0,o.eW)("op")]))),_:1},8,["checked"])])),_:1}),(0,o.bF)(u,{span:5},{default:(0,o.k6)((()=>[(0,o.bF)(p,{checked:e.isOptionalChecked(8453),onChange:t[7]||(t[7]=()=>e.handleOptionChange(8453))},{default:(0,o.k6)((()=>t[63]||(t[63]=[(0,o.eW)(" BASE")]))),_:1},8,["checked"])])),_:1}),(0,o.bF)(u,{span:5},{default:(0,o.k6)((()=>[(0,o.bF)(p,{checked:e.isOptionalChecked(99781165),onChange:t[8]||(t[8]=()=>e.handleOptionChange(99781165))},{default:(0,o.k6)((()=>t[64]||(t[64]=[(0,o.eW)("不存在的链")]))),_:1},8,["checked"])])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:l.connectBtnClicked,icon:"el-icon-connection",disabled:!e.areChainsInit},{default:(0,o.k6)((()=>[(0,o.eW)((0,r.v_)(e.connectStatusStr),1)])),_:1},8,["onClick","disabled"])])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"danger",onClick:l.disconnectAction,icon:"el-icon-switch-button",disabled:!e.areChainsInit||0==e.walletAddress.length},{default:(0,o.k6)((()=>[(0,o.eW)((0,r.v_)(e.disconnectStatusStr),1)])),_:1},8,["onClick","disabled"])])),_:1})])),_:1}),((0,o.uX)(),(0,o.Wv)(o.Im,{to:"body"},[e.showModal?((0,o.uX)(),(0,o.CE)("div",{key:0,class:"modal-overlay",onClick:t[11]||(t[11]=(...e)=>l.closeModal&&l.closeModal(...e))},[(0,o.Lk)("div",{class:"modal-content",onClick:t[10]||(t[10]=(0,i.D$)((()=>{}),["stop"]))},[(0,o.Lk)("button",{class:"close-button",onClick:t[9]||(t[9]=(...e)=>l.closeModal&&l.closeModal(...e))}," × "),t[65]||(t[65]=(0,o.Lk)("h2",null,"扫描二维码",-1)),(0,o.bF)(v,{value:e.qrValue,size:200,level:"H"},null,8,["value"])])])):(0,o.Q3)("",!0)]))])),_:1}),(0,o.bF)(f,{class:"wallet-actions"},{header:(0,o.k6)((()=>t[66]||(t[66]=[(0,o.Lk)("div",null,"交易",-1)]))),default:(0,o.k6)((()=>[(0,o.bF)(E,{modelValue:e.activeTab,"onUpdate:modelValue":t[45]||(t[45]=t=>e.activeTab=t),type:"border-card",onTabClick:l.clickActiveTab},{default:(0,o.k6)((()=>[(0,o.bF)(O,{label:"ETH交易",name:"eip155:1"},{default:(0,o.k6)((()=>[(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:l.eth_requestAccounts},{default:(0,o.k6)((()=>t[67]||(t[67]=[(0,o.eW)("eth_requestAccounts(ETH)")]))),_:1},8,["onClick"])])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:t[12]||(t[12]=e=>l.eth_chainId())},{default:(0,o.k6)((()=>t[68]||(t[68]=[(0,o.eW)("eth_chainId(ETH)")]))),_:1})])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:t[13]||(t[13]=e=>l.wallet_switchEthereumChain())},{default:(0,o.k6)((()=>t[69]||(t[69]=[(0,o.eW)("wallet_switchEthereumChain(切换到ETH)")]))),_:1})])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:t[14]||(t[14]=e=>l.wallet_addEthereumChain())},{default:(0,o.k6)((()=>t[70]||(t[70]=[(0,o.eW)("wallet_addEthereumChain")]))),_:1})])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:t[15]||(t[15]=e=>l.personal_sign())},{default:(0,o.k6)((()=>t[71]||(t[71]=[(0,o.eW)("personal_sign")]))),_:1})])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:t[16]||(t[16]=e=>l.eth_signTypedData_v4())},{default:(0,o.k6)((()=>t[72]||(t[72]=[(0,o.eW)("eth_signTypedData_v4")]))),_:1})])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:l.eth_sendTransaction_transfer},{default:(0,o.k6)((()=>t[73]||(t[73]=[(0,o.eW)("eth_sendTransaction(转账ETH)")]))),_:1},8,["onClick"])])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:l.eth_sendTransaction_approve},{default:(0,o.k6)((()=>t[74]||(t[74]=[(0,o.eW)("eth_sendTransaction(币种授权TONCoin)")]))),_:1},8,["onClick"])])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:l.eth_sendTransaction_mint},{default:(0,o.k6)((()=>t[75]||(t[75]=[(0,o.eW)("eth_sendTransaction(eth mint nft)")]))),_:1},8,["onClick"])])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:t[17]||(t[17]=e=>l.wallet_watchAsset())},{default:(0,o.k6)((()=>t[76]||(t[76]=[(0,o.eW)("wallet_watchAsset(添加代币SPX6900) ")]))),_:1})])),_:1})])),_:1})])),_:1}),(0,o.bF)(O,{label:"Polygon交易",name:"eip155:137"},{default:(0,o.k6)((()=>[(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:l.eth_requestAccounts},{default:(0,o.k6)((()=>t[77]||(t[77]=[(0,o.eW)("eth_requestAccounts")]))),_:1},8,["onClick"])])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:t[18]||(t[18]=e=>l.eth_chainId())},{default:(0,o.k6)((()=>t[78]||(t[78]=[(0,o.eW)("eth_chainId")]))),_:1})])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:t[19]||(t[19]=e=>l.wallet_switchEthereumChain())},{default:(0,o.k6)((()=>t[79]||(t[79]=[(0,o.eW)("wallet_switchEthereumChain")]))),_:1})])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:t[20]||(t[20]=e=>l.wallet_addEthereumChain())},{default:(0,o.k6)((()=>t[80]||(t[80]=[(0,o.eW)("wallet_addEthereumChain")]))),_:1})])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:t[21]||(t[21]=e=>l.personal_sign())},{default:(0,o.k6)((()=>t[81]||(t[81]=[(0,o.eW)("personal_sign")]))),_:1})])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:t[22]||(t[22]=e=>l.eth_signTypedData_v4())},{default:(0,o.k6)((()=>t[82]||(t[82]=[(0,o.eW)("eth_signTypedData_v4")]))),_:1})])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:l.eth_sendTransaction_transfer},{default:(0,o.k6)((()=>t[83]||(t[83]=[(0,o.eW)("eth_sendTransaction(转账POL)")]))),_:1},8,["onClick"])])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:l.eth_sendTransaction_approve},{default:(0,o.k6)((()=>t[84]||(t[84]=[(0,o.eW)("eth_sendTransaction(sushi 币种授权)")]))),_:1},8,["onClick"])])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:l.eth_sendTransaction_mint},{default:(0,o.k6)((()=>t[85]||(t[85]=[(0,o.eW)("eth_sendTransaction(polygon mint nft)")]))),_:1},8,["onClick"])])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:t[23]||(t[23]=e=>l.wallet_watchAsset())},{default:(0,o.k6)((()=>t[86]||(t[86]=[(0,o.eW)("wallet_watchAsset(添加代币LGNS) ")]))),_:1})])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:t[24]||(t[24]=e=>l.wallet_testRpc())},{default:(0,o.k6)((()=>t[87]||(t[87]=[(0,o.eW)("wallet_testRpc(Polygon)")]))),_:1})])),_:1})])),_:1})])),_:1}),(0,o.bF)(O,{label:"BNB交易",name:"eip155:56"},{default:(0,o.k6)((()=>[(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:l.eth_requestAccounts},{default:(0,o.k6)((()=>t[88]||(t[88]=[(0,o.eW)("eth_requestAccounts(BNB)")]))),_:1},8,["onClick"])])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:t[25]||(t[25]=e=>l.eth_chainId())},{default:(0,o.k6)((()=>t[89]||(t[89]=[(0,o.eW)("eth_chainId(BNB)")]))),_:1})])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:t[26]||(t[26]=e=>l.wallet_switchEthereumChain())},{default:(0,o.k6)((()=>t[90]||(t[90]=[(0,o.eW)("wallet_switchEthereumChain(切换到BNB)")]))),_:1})])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:t[27]||(t[27]=e=>l.wallet_addEthereumChain())},{default:(0,o.k6)((()=>t[91]||(t[91]=[(0,o.eW)("wallet_addEthereumChain")]))),_:1})])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:t[28]||(t[28]=e=>l.personal_sign())},{default:(0,o.k6)((()=>t[92]||(t[92]=[(0,o.eW)("personal_sign")]))),_:1})])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:t[29]||(t[29]=e=>l.eth_signTypedData_v4())},{default:(0,o.k6)((()=>t[93]||(t[93]=[(0,o.eW)("eth_signTypedData_v4")]))),_:1})])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:l.eth_sendTransaction_transfer},{default:(0,o.k6)((()=>t[94]||(t[94]=[(0,o.eW)("eth_sendTransaction(转账BNB)")]))),_:1},8,["onClick"])])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:l.eth_sendTransaction_approve},{default:(0,o.k6)((()=>t[95]||(t[95]=[(0,o.eW)("eth_sendTransaction(币种授权POSI)")]))),_:1},8,["onClick"])])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:t[30]||(t[30]=e=>l.wallet_watchAsset())},{default:(0,o.k6)((()=>t[96]||(t[96]=[(0,o.eW)("wallet_watchAsset(添加代币FET) ")]))),_:1})])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:t[31]||(t[31]=e=>l.wallet_testRpc())},{default:(0,o.k6)((()=>t[97]||(t[97]=[(0,o.eW)("wallet_testRpc(check balance on eth)")]))),_:1})])),_:1})])),_:1})])),_:1}),(0,o.bF)(O,{label:"Fuse交易",name:"eip155:122"},{default:(0,o.k6)((()=>[(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:l.eth_requestAccounts},{default:(0,o.k6)((()=>t[98]||(t[98]=[(0,o.eW)("eth_requestAccounts")]))),_:1},8,["onClick"])])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:t[32]||(t[32]=e=>l.eth_chainId())},{default:(0,o.k6)((()=>t[99]||(t[99]=[(0,o.eW)("eth_chainId")]))),_:1})])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:t[33]||(t[33]=e=>l.personal_sign())},{default:(0,o.k6)((()=>t[100]||(t[100]=[(0,o.eW)("personal_sign")]))),_:1})])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:t[34]||(t[34]=e=>l.eth_signTypedData_v4())},{default:(0,o.k6)((()=>t[101]||(t[101]=[(0,o.eW)("eth_signTypedData_v4")]))),_:1})])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:l.eth_sendTransaction_swap},{default:(0,o.k6)((()=>t[102]||(t[102]=[(0,o.eW)("eth_sendTransaction(Swap)")]))),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1}),(0,o.bF)(O,{label:"TON交易",name:"ton:-239"},{default:(0,o.k6)((()=>[(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:l.ton_getAccount},{default:(0,o.k6)((()=>t[103]||(t[103]=[(0,o.eW)("ton_getAccount")]))),_:1},8,["onClick"])])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:l.ton_sendTransaction},{default:(0,o.k6)((()=>t[104]||(t[104]=[(0,o.eW)("ton_sendTransaction")]))),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1}),(0,o.bF)(O,{label:"Sol交易",name:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp"},{default:(0,o.k6)((()=>[(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:l.sol_signMessage},{default:(0,o.k6)((()=>t[105]||(t[105]=[(0,o.eW)("solana_signMessage")]))),_:1},8,["onClick"])])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:l.sol_signTransaction},{default:(0,o.k6)((()=>t[106]||(t[106]=[(0,o.eW)("solana_signTransaction")]))),_:1},8,["onClick"])])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:l.sol_signVersionedTransaction},{default:(0,o.k6)((()=>t[107]||(t[107]=[(0,o.eW)("solana_signVersionedTransaction")]))),_:1},8,["onClick"])])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:l.sol_signAllTransactions},{default:(0,o.k6)((()=>t[108]||(t[108]=[(0,o.eW)("sol_signAllTransactions")]))),_:1},8,["onClick"])])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:l.sol_signAllVersionedTransactions},{default:(0,o.k6)((()=>t[109]||(t[109]=[(0,o.eW)("sol_signAllVersionedTransactions")]))),_:1},8,["onClick"])])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:l.sol_signAndSendTransaction},{default:(0,o.k6)((()=>t[110]||(t[110]=[(0,o.eW)("sol_signAndSendTransaction")]))),_:1},8,["onClick"])])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:l.sol_signAndSendVersionedTransaction},{default:(0,o.k6)((()=>t[111]||(t[111]=[(0,o.eW)("signAndSendVersionedTransaction")]))),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1}),(0,o.bF)(O,{label:"Sonic交易",name:"sonic:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z"},{default:(0,o.k6)((()=>[(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:l.sol_signMessage},{default:(0,o.k6)((()=>t[112]||(t[112]=[(0,o.eW)("solana_signMessage")]))),_:1},8,["onClick"])])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:l.sol_signTransaction},{default:(0,o.k6)((()=>t[113]||(t[113]=[(0,o.eW)("solana_signTransaction")]))),_:1},8,["onClick"])])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:l.sol_signAllTransactions},{default:(0,o.k6)((()=>t[114]||(t[114]=[(0,o.eW)("sol_signAllTransactions")]))),_:1},8,["onClick"])])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:l.sol_signAndSendTransaction},{default:(0,o.k6)((()=>t[115]||(t[115]=[(0,o.eW)("sol_signAndSendTransaction")]))),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1}),(0,o.bF)(O,{label:"Sonic交易(svm)",name:"svm:70000059"},{default:(0,o.k6)((()=>[(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:l.sol_signMessage},{default:(0,o.k6)((()=>t[116]||(t[116]=[(0,o.eW)("solana_signMessage")]))),_:1},8,["onClick"])])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:l.sol_signTransaction},{default:(0,o.k6)((()=>t[117]||(t[117]=[(0,o.eW)("solana_signTransaction")]))),_:1},8,["onClick"])])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:l.sol_signAllTransactions},{default:(0,o.k6)((()=>t[118]||(t[118]=[(0,o.eW)("sol_signAllTransactions")]))),_:1},8,["onClick"])])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:l.sol_signAndSendTransaction},{default:(0,o.k6)((()=>t[119]||(t[119]=[(0,o.eW)("sol_signAndSendTransaction")]))),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1}),(0,o.bF)(O,{label:"Sui交易",name:"sui:mainnet"},{default:(0,o.k6)((()=>[(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:t[35]||(t[35]=e=>l.sui_getAccount())},{default:(0,o.k6)((()=>t[120]||(t[120]=[(0,o.eW)("getAccount(Sui)")]))),_:1})])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:t[36]||(t[36]=e=>l.sui_signMessage())},{default:(0,o.k6)((()=>t[121]||(t[121]=[(0,o.eW)("signMessage(Sui)")]))),_:1})])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:t[37]||(t[37]=e=>l.sui_signPersonalMessage())},{default:(0,o.k6)((()=>t[122]||(t[122]=[(0,o.eW)("signPersonalMessage(Sui)")]))),_:1})])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:t[38]||(t[38]=e=>l.sui_signTransaction2())},{default:(0,o.k6)((()=>t[123]||(t[123]=[(0,o.eW)("signTransaction(Sui)")]))),_:1})])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:t[39]||(t[39]=e=>l.sui_signAndExecuteTransaction())},{default:(0,o.k6)((()=>t[124]||(t[124]=[(0,o.eW)("sendTransaction(转账到Rally Tiger钱包)")]))),_:1})])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:t[40]||(t[40]=e=>l.sui_requestRpc())},{default:(0,o.k6)((()=>t[125]||(t[125]=[(0,o.eW)("rpc(Sui)")]))),_:1})])),_:1})])),_:1}),t[130]||(t[130]=(0,o.Lk)("div",{style:{height:"48px"}},null,-1)),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:t[41]||(t[41]=e=>l.sui_signTransaction_pre_execution())},{default:(0,o.k6)((()=>t[126]||(t[126]=[(0,o.eW)("signTransaction(预执行)")]))),_:1})])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:t[42]||(t[42]=e=>l.sui_signAndExecuteTransaction_pre_execution())},{default:(0,o.k6)((()=>t[127]||(t[127]=[(0,o.eW)("sendTransaction(预执行)")]))),_:1})])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:t[43]||(t[43]=e=>l.sui_signTransaction())},{default:(0,o.k6)((()=>t[128]||(t[128]=[(0,o.eW)("signTransaction(Pattern钱包专属)")]))),_:1})])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:t[44]||(t[44]=e=>l.sui_signAndExecuteTransaction_stake())},{default:(0,o.k6)((()=>t[129]||(t[129]=[(0,o.eW)("质押(Sui)")]))),_:1})])),_:1})])),_:1})])),_:1}),(0,o.bF)(O,{label:"BTC交易",name:"btc:mainnet"},{default:(0,o.k6)((()=>[(0,o.bF)(y,{onGenerateTransactionParams:l.btc_generateTransactionParams},null,8,["onGenerateTransactionParams"])])),_:1}),(0,o.bF)(O,{label:"Fractal交易",name:"fractal:mainnet"},{default:(0,o.k6)((()=>[(0,o.bF)(C,{onGenerateTransactionParams:l.fractal_generateTransactionParams},null,8,["onGenerateTransactionParams"])])),_:1}),(0,o.bF)(O,{label:"Aptos交易",name:"aptos:mainnet"},{default:(0,o.k6)((()=>[(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:l.aptos_signMessage},{default:(0,o.k6)((()=>t[131]||(t[131]=[(0,o.eW)("aptos_signMessage")]))),_:1},8,["onClick"])])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:l.aptos_signTransaction},{default:(0,o.k6)((()=>t[132]||(t[132]=[(0,o.eW)("aptos_signTransaction")]))),_:1},8,["onClick"])])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:l.aptos_signAndSubmitTransaction},{default:(0,o.k6)((()=>t[133]||(t[133]=[(0,o.eW)("aptos_signAndSubmitTransaction")]))),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1}),(0,o.bF)(O,{label:"Movement交易",name:"movement:testnet"},{default:(0,o.k6)((()=>[(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:l.aptos_signMessage},{default:(0,o.k6)((()=>t[134]||(t[134]=[(0,o.eW)("aptos_signMessage")]))),_:1},8,["onClick"])])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:l.move_signTransaction},{default:(0,o.k6)((()=>t[135]||(t[135]=[(0,o.eW)("move_signTransaction")]))),_:1},8,["onClick"])])),_:1})])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:l.move_signAndSubmitTransaction},{default:(0,o.k6)((()=>t[136]||(t[136]=[(0,o.eW)("move_signAndSubmitTransaction")]))),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue","onTabClick"]),(0,o.bF)(u,{xs:24,sm:12},{default:(0,o.k6)((()=>[t[137]||(t[137]=(0,o.Lk)("div",{class:"input-label"},"交易数据:",-1)),(0,o.bF)(_,{modelValue:e.testTransaction,"onUpdate:modelValue":t[46]||(t[46]=t=>e.testTransaction=t),type:"textarea",rows:5,placeholder:"sendTransactions"},null,8,["modelValue"])])),_:1}),(0,o.bF)(u,{xs:24,sm:12},{default:(0,o.k6)((()=>[t[138]||(t[138]=(0,o.Lk)("div",{class:"input-label"},"签名结果 :",-1)),(0,o.bF)(_,{modelValue:e.testboc,"onUpdate:modelValue":t[47]||(t[47]=t=>e.testboc=t),type:"textarea",rows:5,placeholder:"boc"},null,8,["modelValue"])])),_:1}),(0,o.bF)(h,{gutter:12,class:"button-row"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:t[48]||(t[48]=e=>l.sendTransaction())},{default:(0,o.k6)((()=>[(0,o.eW)((0,r.v_)(e.testTransactionStr),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])}n(41011),n(92806),n(53287),n(70039),n(88373),n(51555),n(33734),n(22035),n(94932),n(50427),n(19239),n(70144),n(86823),n(51204);var l=n(16070),d=n(6280),u=n(86855),h=n(45116),f=n(24998),p=n(782),g=n(18584),b=n(20777),_=n(16310),m=n(23824),v=n(88392),O=n(54512);function y(e,t,n,i,s,r){const a=(0,o.g2)("el-button"),c=(0,o.g2)("el-col"),l=(0,o.g2)("el-input"),d=(0,o.g2)("el-row");return(0,o.uX)(),(0,o.Wv)(d,{gutter:12},{default:(0,o.k6)((()=>[(0,o.bF)(c,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(a,{class:"grid-content",type:"warning",onClick:t[0]||(t[0]=e=>r.btc_signMessage())},{default:(0,o.k6)((()=>t[11]||(t[11]=[(0,o.eW)("signMessage(BTC)")]))),_:1})])),_:1}),t[23]||(t[23]=(0,o.Lk)("div",{class:"line"},null,-1)),(0,o.bF)(c,{span:24},{default:(0,o.k6)((()=>[t[14]||(t[14]=(0,o.Lk)("div",{style:{"font-size":"12px",color:"gray"}},"(发送到Pattern测试钱包的legacy地址)",-1)),(0,o.bF)(l,{class:"grid-content",modelValue:i.sendAmount,"onUpdate:modelValue":t[1]||(t[1]=e=>i.sendAmount=e),clearable:"",placeholder:"请输入要发送的数量"},null,8,["modelValue"]),(0,o.bF)(a,{class:"grid-content",type:"warning",onClick:t[2]||(t[2]=e=>r.btc_send())},{default:(0,o.k6)((()=>t[12]||(t[12]=[(0,o.eW)("send(BTC)")]))),_:1}),t[15]||(t[15]=(0,o.Lk)("br",null,null,-1)),(0,o.bF)(l,{class:"grid-content",modelValue:i.sendSatoshisAmount,"onUpdate:modelValue":t[3]||(t[3]=e=>i.sendSatoshisAmount=e),clearable:"",placeholder:"请输入要发送的satoshi数量"},null,8,["modelValue"]),(0,o.bF)(a,{class:"grid-content",type:"warning",onClick:t[4]||(t[4]=e=>r.btc_sendBitcoin())},{default:(0,o.k6)((()=>t[13]||(t[13]=[(0,o.eW)("sendBitcoin(BTC)")]))),_:1})])),_:1}),t[24]||(t[24]=(0,o.Lk)("div",{class:"line"},null,-1)),(0,o.bF)(c,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(l,{class:"grid-content",modelValue:i.psbtHex,"onUpdate:modelValue":t[5]||(t[5]=e=>i.psbtHex=e),clearable:"",placeholder:"请输入要签名的Psbt"},null,8,["modelValue"]),(0,o.bF)(a,{class:"grid-content",type:"warning",onClick:t[6]||(t[6]=e=>r.btc_signPsbt_up())},{default:(0,o.k6)((()=>t[16]||(t[16]=[(0,o.eW)("signPsbt(上架NFT)")]))),_:1}),t[18]||(t[18]=(0,o.Lk)("br",null,null,-1)),(0,o.bF)(a,{class:"grid-content",type:"warning",onClick:t[7]||(t[7]=e=>r.btc_signAndPushPsbt_up())},{default:(0,o.k6)((()=>t[17]||(t[17]=[(0,o.eW)("signAndPushPsbt(上架NFT)")]))),_:1}),t[19]||(t[19]=(0,o.Lk)("br",null,null,-1)),t[20]||(t[20]=(0,o.Lk)("div",{style:{"font-size":"12px","margin-top":"12px","margin-left":"4px",color:"gray","text-align":"left"}},[(0,o.Lk)("li",null," 1. 在OKX App选择要上架的Btc NFT，点击【上架】 "),(0,o.Lk)("li",null," 2. 弹出签名面板，点开高级选项，查看 "),(0,o.Lk)("li",null," 3. 单击复制，就可以得到psbt。然后退出上架流程。 "),(0,o.Lk)("li",null," 4. 验证 https://chainquery.com/bitcoin-cli/decodepsbt ")],-1))])),_:1}),t[25]||(t[25]=(0,o.Lk)("div",{class:"line"},null,-1)),(0,o.bF)(c,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(l,{class:"grid-content",modelValue:i.nftId,"onUpdate:modelValue":t[8]||(t[8]=e=>i.nftId=e),clearable:"",placeholder:"请输入要转移的NFT ID"},null,8,["modelValue"]),(0,o.bF)(l,{class:"grid-content",modelValue:i.receiver,"onUpdate:modelValue":t[9]||(t[9]=e=>i.receiver=e),clearable:"",placeholder:"接收者钱包地址"},null,8,["modelValue"]),(0,o.bF)(a,{class:"grid-content",type:"warning",onClick:t[10]||(t[10]=e=>r.btc_sendInscription())},{default:(0,o.k6)((()=>t[21]||(t[21]=[(0,o.eW)("sendInscription(BTC)")]))),_:1}),t[22]||(t[22]=(0,o.Lk)("div",{style:{"font-size":"12px","margin-top":"12px","margin-left":"4px",color:"gray","text-align":"left"}},[(0,o.Lk)("li",null," 1. 在web端NFT界面，选择要发送的Btc NFT，打开详情 "),(0,o.Lk)("li",null," 2. 从NFT详情页URL中获取NFT id（url最后一部分） "),(0,o.Lk)("li",null," 3. 复制到上面输入框中，再点击sendInscription按钮 ")],-1))])),_:1})])),_:1})}var C=n(50141),E={name:"BtcTransactionPanel",props:{msg:String},setup(){const e=(0,C.KR)(""),t=(0,C.KR)(15e-6),n=(0,C.KR)(17100),i=(0,C.KR)(""),s=(0,C.KR)("");return{nftId:e,receiver:s,psbtHex:i,sendAmount:t,sendSatoshisAmount:n}},methods:{btc_signMessage(){let e={from:"bc1p7pgnqe87red4cvd7ml6rh9pl9ufpr522k2y3dpeyrvfc6g2g3r3s3ae9dr",signStr:"Welcome to UniSat!\n\nClick to sign in and accept the UniSat Terms of Service (https://unisat.io/terms-of-service.html) and Privacy Policy (https://unisat.io/privacy-policy.html).\n    \nThis request will not trigger a blockchain transaction.\n    \nYour authentication status will reset after 24 hours.\n    \nWallet address:\nbc1p7pgnqe87red4cvd7ml6rh9pl9ufpr522k2y3dpeyrvfc6g2g3r3s3ae9dr\n    \nNonce:\n162d70e3-8c21-4cfd-9a22-9bf0a4b7be51\n"};this.$emit("generateTransactionParams",e,"btc_signMessage")},btc_send(){if(0==this.sendAmount)return void alert("不能为零");let e={from:"",to:"1NKnZ3uAuQLnmExA3WY44u1efwCgTiAxBn",value:`${this.sendAmount}`};this.$emit("generateTransactionParams",e,"btc_send")},btc_sendBitcoin(){if(0==this.sendAmount)return void alert("不能为零");let e={from:"",toAddress:"1NKnZ3uAuQLnmExA3WY44u1efwCgTiAxBn",satoshis:`${this.sendSatoshisAmount}`,options:{feeRate:16}};this.$emit("generateTransactionParams",e,"btc_sendBitcoin")},btc_signPsbt_up(){this.psbtHex?this.$emit("generateTransactionParams",{psbtHex:this.psbtHex,options:{autoFinalized:!1}},"btc_signPsbt"):alert("请输入psbt")},btc_signAndPushPsbt_up(){this.psbtHex?this.$emit("generateTransactionParams",{psbtHex:this.psbtHex,options:{autoFinalized:!0}},"btc_signAndPushPsbt"):alert("请输入psbt")},btc_sendInscription(){this.nftId?this.receiver?this.$emit("generateTransactionParams",{address:this.receiver,inscriptionId:this.nftId,options:{feeRate:"15"}},"btc_sendInscription"):alert("请输入接收者地址"):alert("请输入NFT ID")}}},N=n(15690);const w=(0,N.A)(E,[["render",y],["__scopeId","data-v-17e9106e"]]);var R=w;function T(e,t,n,i,s,r){const a=(0,o.g2)("el-button"),c=(0,o.g2)("el-col"),l=(0,o.g2)("el-input"),d=(0,o.g2)("el-row");return(0,o.uX)(),(0,o.Wv)(d,{gutter:12},{default:(0,o.k6)((()=>[(0,o.bF)(c,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(a,{class:"grid-content",type:"warning",onClick:t[0]||(t[0]=e=>r.fractal_signMessage())},{default:(0,o.k6)((()=>t[11]||(t[11]=[(0,o.eW)("signMessage(Fractal)")]))),_:1})])),_:1}),t[23]||(t[23]=(0,o.Lk)("div",{class:"line"},null,-1)),(0,o.bF)(c,{span:24},{default:(0,o.k6)((()=>[t[14]||(t[14]=(0,o.Lk)("div",{style:{"font-size":"12px",color:"gray"}},"(发送到Pattern测试钱包的legacy地址)",-1)),(0,o.bF)(l,{class:"grid-content",modelValue:i.sendAmount,"onUpdate:modelValue":t[1]||(t[1]=e=>i.sendAmount=e),clearable:"",placeholder:"请输入要发送的数量"},null,8,["modelValue"]),(0,o.bF)(a,{class:"grid-content",type:"warning",onClick:t[2]||(t[2]=e=>r.fractal_send())},{default:(0,o.k6)((()=>t[12]||(t[12]=[(0,o.eW)("send(Fractal)")]))),_:1}),t[15]||(t[15]=(0,o.Lk)("br",null,null,-1)),(0,o.bF)(l,{class:"grid-content",modelValue:i.sendSatoshisAmount,"onUpdate:modelValue":t[3]||(t[3]=e=>i.sendSatoshisAmount=e),clearable:"",placeholder:"请输入要发送的satoshi数量"},null,8,["modelValue"]),(0,o.bF)(a,{class:"grid-content",type:"warning",onClick:t[4]||(t[4]=e=>r.fractal_sendBitcoin())},{default:(0,o.k6)((()=>t[13]||(t[13]=[(0,o.eW)("sendBitcoin(Fractal)")]))),_:1})])),_:1}),t[24]||(t[24]=(0,o.Lk)("div",{class:"line"},null,-1)),(0,o.bF)(c,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(l,{class:"grid-content",modelValue:i.psbtHex,"onUpdate:modelValue":t[5]||(t[5]=e=>i.psbtHex=e),clearable:"",placeholder:"请输入要签名的Psbt"},null,8,["modelValue"]),(0,o.bF)(a,{class:"grid-content",type:"warning",onClick:t[6]||(t[6]=e=>r.fractal_signPsbt_up())},{default:(0,o.k6)((()=>t[16]||(t[16]=[(0,o.eW)("signPsbt(上架NFT)")]))),_:1}),t[18]||(t[18]=(0,o.Lk)("br",null,null,-1)),(0,o.bF)(a,{class:"grid-content",type:"warning",onClick:t[7]||(t[7]=e=>r.fractal_signAndPushPsbt_up())},{default:(0,o.k6)((()=>t[17]||(t[17]=[(0,o.eW)("signAndPushPsbt(上架NFT)")]))),_:1}),t[19]||(t[19]=(0,o.Lk)("br",null,null,-1)),t[20]||(t[20]=(0,o.Lk)("div",{style:{"font-size":"12px","margin-top":"12px","margin-left":"4px",color:"gray","text-align":"left"}},[(0,o.Lk)("li",null," 1. 在OKX App选择要上架的Fractal NFT，点击【上架】 "),(0,o.Lk)("li",null," 2. 弹出签名面板，点开高级选项，查看 "),(0,o.Lk)("li",null," 3. 单击复制，就可以得到psbt。然后退出上架流程。 "),(0,o.Lk)("li",null," 4. 验证 https://chainquery.com/bitcoin-cli/decodepsbt ")],-1))])),_:1}),t[25]||(t[25]=(0,o.Lk)("div",{class:"line"},null,-1)),(0,o.bF)(c,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(l,{class:"grid-content",modelValue:i.nftId,"onUpdate:modelValue":t[8]||(t[8]=e=>i.nftId=e),clearable:"",placeholder:"请输入要转移的NFT ID"},null,8,["modelValue"]),(0,o.bF)(l,{class:"grid-content",modelValue:i.receiver,"onUpdate:modelValue":t[9]||(t[9]=e=>i.receiver=e),clearable:"",placeholder:"接收者钱包地址"},null,8,["modelValue"]),(0,o.bF)(a,{class:"grid-content",type:"warning",onClick:t[10]||(t[10]=e=>r.fractal_sendInscription())},{default:(0,o.k6)((()=>t[21]||(t[21]=[(0,o.eW)("sendInscription(Fractal)")]))),_:1}),t[22]||(t[22]=(0,o.Lk)("div",{style:{"font-size":"12px","margin-top":"12px","margin-left":"4px",color:"gray","text-align":"left"}},[(0,o.Lk)("li",null," 1. 在web端NFT界面，选择要发送的Fractal NFT，打开详情 "),(0,o.Lk)("li",null," 2. 从NFT详情页URL中获取NFT id（url最后一部分） "),(0,o.Lk)("li",null," 3. 复制到上面输入框中，再点击sendInscription按钮 ")],-1))])),_:1})])),_:1})}var S={name:"BtcTransactionPanel",props:{msg:String},setup(){const e=(0,C.KR)(""),t=(0,C.KR)(15e-6),n=(0,C.KR)(17100),i=(0,C.KR)(""),s=(0,C.KR)("");return{nftId:e,receiver:s,psbtHex:i,sendAmount:t,sendSatoshisAmount:n}},methods:{fractal_signMessage(){let e={from:"bc1p7pgnqe87red4cvd7ml6rh9pl9ufpr522k2y3dpeyrvfc6g2g3r3s3ae9dr",signStr:"Welcome to UniSat!\n\nClick to sign in and accept the UniSat Terms of Service (https://unisat.io/terms-of-service.html) and Privacy Policy (https://unisat.io/privacy-policy.html).\n    \nThis request will not trigger a blockchain transaction.\n    \nYour authentication status will reset after 24 hours.\n    \nWallet address:\nbc1p7pgnqe87red4cvd7ml6rh9pl9ufpr522k2y3dpeyrvfc6g2g3r3s3ae9dr\n    \nNonce:\n162d70e3-8c21-4cfd-9a22-9bf0a4b7be51\n"};this.$emit("generateTransactionParams",e,"fractal_signMessage")},fractal_send(){if(0==this.sendAmount)return void alert("不能为零");let e={from:"",to:"1NKnZ3uAuQLnmExA3WY44u1efwCgTiAxBn",value:`${this.sendAmount}`};this.$emit("generateTransactionParams",e,"fractal_send")},fractal_sendBitcoin(){if(0==this.sendAmount)return void alert("不能为零");let e={from:"",toAddress:"1NKnZ3uAuQLnmExA3WY44u1efwCgTiAxBn",satoshis:`${this.sendSatoshisAmount}`,options:{feeRate:16}};this.$emit("generateTransactionParams",e,"fractal_sendBitcoin")},fractal_signPsbt_up(){this.psbtHex?this.$emit("generateTransactionParams",{psbtHex:this.psbtHex,options:{autoFinalized:!1}},"fractal_signPsbt"):alert("请输入psbt")},fractal_signAndPushPsbt_up(){this.psbtHex?this.$emit("generateTransactionParams",{psbtHex:this.psbtHex,options:{autoFinalized:!0}},"fractal_signAndPushPsbt"):alert("请输入psbt")},fractal_sendInscription(){this.nftId?this.receiver?this.$emit("generateTransactionParams",{address:this.receiver,inscriptionId:this.nftId,options:{feeRate:"15"}},"fractal_sendInscription"):alert("请输入接收者地址"):alert("请输入NFT ID")}}};const k=(0,N.A)(S,[["render",T],["__scopeId","data-v-02b5b8a5"]]);var P=k,D=n(20571),I=n(55138),A=n.n(I),K=n(63987)["Buffer"];new(A());const F={1:{name:"eth",checked:!1},56:{name:"BNB",checked:!1},137:{name:"Polygon",checked:!1},122:{name:"Fuse",checked:!1},"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp":{name:"Sol mainnet",checked:!1},"solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z":{name:"Sol testnet",checked:!1},"sonic:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z":{name:"Sonic testnet",checked:!1},"svm:70000059":{name:"70000059",checked:!1},"sui:mainnet":{name:"Sui mainnet",checked:!1},"aptos:mainnet":{name:"Aptos mainnet",checked:!1},"movement:testnet":{name:"Movement",checked:!1},"btc:mainnet":{name:"BTC",checked:!1},"fractal:mainnet":{name:"Fractal",checked:!1},997865:{name:"不存在的链",checked:!1}};var x=new Set([]),M=["before","success","error"],W="en_US",U=D.THEME.LIGHT,J={name:"App",components:{QrcodeVue:g.Ay,BTCPanel:R,FractalPanel:P},data:()=>({activeTab:"eip155:1",testTopic:"",testPublicKey:"",testProofPayload:"",tonProofValue:"",pendingDeepLink:"-",logList:[],connectReady:!1,connectStatusStr:"连接钱包",disconnectStatusStr:"断开钱包",localPubKey:"",localSecKey:"",testTransaction:"",selectedChain:"eip155:1",testTransactionStr:"发送交易",walletAddress:"",testboc:"",ProofPayloadVerify:"",showModal:!1,showVerifyRow:!1,qrValue:"https://www.okx.com/download",currentStatus:"",areChainsInit:!1,availableChains:F,isOptionalChecked:e=>x.has(e),withUI:"false"!=localStorage.getItem("autoRefresh"),modals:M,locales:["en_US","ru_RU","zh_CN","zh","ar_AE","cs_CZ","de_DE","es_ES","es_LAT","fr_FR","id_ID","it_IT","nl_NL","pl_PL","pt_BR","pt_PT","ro_RO","tr_TR","uk_UA","vi_VN"],language:W,theme:U,THEME:D.THEME,handleWithUI:e=>{localStorage.setItem("autoRefresh",`${e}`),location.reload()},handleOptionChange:e=>{x.has(e)?x.delete(e):x.add(e)}}),computed:{getWalletAddress:function(){return this.walletAddress}},methods:{isChecked(e){return this.selectedChains.has(e)},initChains(e){if(e.length>0){const t=Object.assign({},this.availableChains);for(const n of e)t[n].checked=!t[n].checked;this.availableChains=t}this.areChainsInit=!0},async clickActiveTab(e){const t=e.props?e.props.name:e.name;this.selectedChain=t,console.log("已切换到链 :",t),window.provider||console.error("钱包 未初始化完成"),window.provider.setDefaultChain(this.selectedChain)},async connectBtnClicked(){console.log(`encryptStoreMsg   connectBtnClicked  ${Date.now()}`),window.provider?this.testTonSdk():console.log("connectBtnClicked provider not finish init")},async disconnectAction(){try{console.log("get disconnect wallet btn clicked");var e=window.provider;await e.disconnect(),this.walletAddress="disconnected"}catch(t){console.log("Disconnect  error ==>> ",t.message),this.currentStatus=t.message}},async eth_requestAccounts(){var e={method:"eth_requestAccounts"};this.testTransaction=JSON.stringify(e)},async eth_chainId(){var e={method:"eth_chainId"};this.testTransaction=JSON.stringify(e)},async wallet_switchEthereumChain(){var e={method:"wallet_switchEthereumChain"};this.testTransaction=JSON.stringify(e)},async wallet_addEthereumChain(){var e={method:"wallet_addEthereumChain",params:{blockExplorerUrls:["https://explorer.fuse.io"],chainId:"0x7a",chainName:"Fuse",nativeCurrency:{name:"Fuse",symbol:"FUSE",decimals:18},rpcUrls:["https://rpc.fuse.io"]}};this.testTransaction=JSON.stringify(e)},async personal_sign(){if("eip155:1"===this.selectedChain){var e=await window.provider.request({method:"eth_requestAccounts"},"eip155"),t=e[0];console.log("签名地址>>>",t,JSON.stringify(e));var n={method:"personal_sign",params:["0x4d7920656d61696c206973206a6f686e40646f652e636f6d202d2031373237353937343537313336",t]};this.testTransaction=JSON.stringify(n)}else if("eip155:137"===this.selectedChain||"eip155:122"===this.selectedChain){var i={method:"personal_sign",params:{message:"0x4d7920656d61696c206973206a6f686e40646f652e636f6d202d2031373237353937353831303437"}};this.testTransaction=JSON.stringify(i)}else if("eip155:56"===this.selectedChain){var s={method:"personal_sign",params:{message:"0x4d7920656d61696c206973206a6f686e40646f652e636f6d202d2031373237353937353831303437"}};this.testTransaction=JSON.stringify(s)}},async eth_sendTransaction_swap(){var e={method:"eth_sendTransaction",chainId:"eip155:122",params:{value:"0x38d7ea4c68000",gas:"0x2665f",to:"0xf2614A233c7C3e7f08b1F887Ba133a13f1eb2c55",from:"0xf2F3e73be57031114dd1f4E75c1DD87658be7F0E",data:"0x2646478b000000000000000000000000eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee00000000000000000000000000000000000000000000000000038d7ea4c68000000000000000000000000000620fd5fa44be6af63715ef4e65ddfa0387ad13f5000000000000000000000000000000000000000000000000000000000000001b000000000000000000000000f2f3e73be57031114dd1f4e75c1dd87658be7f0e00000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000000700301ffff0201602352A9Eb5234466Eac23E59e7B99bCaE79C39c0BE9e53fd7EDaC9F859882AfdDa116645287C629040BE9e53fd7EDaC9F859882AfdDa116645287C62900602352A9Eb5234466Eac23E59e7B99bCaE79C39c01f2F3e73be57031114dd1f4E75c1DD87658be7F0E000bb800000000000000000000000000000000"}};this.testTransaction=JSON.stringify(e)},async eth_signTypedData_v4(){var e=await window.provider.request({method:"eth_requestAccounts"},"eip155"),t=e[0];console.log("签名地址>>>",t,JSON.stringify(e));var n={method:"eth_signTypedData_v4",params:[t,{types:{EIP712Domain:[{name:"name",type:"string"},{name:"version",type:"string"},{name:"chainId",type:"uint256"},{name:"verifyingContract",type:"address"}],Person:[{name:"name",type:"string"},{name:"wallet",type:"address"}],Mail:[{name:"from",type:"Person"},{name:"to",type:"Person"},{name:"contents",type:"string"}]},primaryType:"Mail",domain:{name:"Ether Mail",version:"1",chainId:1,verifyingContract:"0xCcCCccccCCCCcCCCCCCcCcCccCcCCCcCcccccccC"},message:{from:{name:"Cow",wallet:"0xCD2a3d9F938E13CD947Ec05AbC7FE734Df8DD826"},to:{name:"Bob",wallet:"0xbBbBBBBbbBBBbbbBbbBbbbbBBbBbbbbBbBbbBBbB"},contents:"Hello, Bob!"}}]};this.testTransaction=JSON.stringify(n)},async eth_sendTransaction_transfer(){var e={};"eip155:1"===this.selectedChain?e={method:"eth_sendTransaction",params:{from:"0x0cecb15396825a895ff8da8fc2d2c77a234dccee",chainId:"0x1",to:"0x0cecb15396825a895ff8da8fc2d2c77a234dccee",value:"0x5af3107a4000",maxPriorityFeePerGas:"0x3b9aca00",gas:"0x5e56",maxFeePerGas:"0x2643b9db8"}}:"eip155:137"===this.selectedChain?e={method:"eth_sendTransaction",params:{gasPrice:"0x17003f6530",nonce:"0x0d30",data:"0x",value:"0x00",to:"0xf2f3e73be57031114dd1f4e75c1dd87658be7f0e",gasLimit:"0x5208",from:"0xf2f3e73be57031114dd1f4e75c1dd87658be7f0e"}}:"eip155:56"===this.selectedChain&&(e={method:"eth_sendTransaction",params:{gas:"0x5e56",value:"0x5af3107a4000",from:"0xf2f3e73be57031114dd1f4e75c1dd87658be7f0e",gasPrice:"0x3b9aca00",to:"0xf2f3e73be57031114dd1f4e75c1dd87658be7f0e",chainId:"0x38"}});var t=await window.provider.request({method:"eth_requestAccounts"},"eip155"),n=t[0];console.log("当前钱包地址------",n),e.params["to"]=n,e.params["from"]=n,this.testTransaction=JSON.stringify(e)},async eth_sendTransaction_approve(){var e={};"eip155:1"===this.selectedChain?e={method:"eth_sendTransaction",params:{from:"0xf2F3e73be57031114dd1f4E75c1DD87658be7F0E",data:"0x095ea7b3000000000000000000000000000000000022d473030f116ddee9f6b43ac78ba3ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff",to:"0x582d872a1b094fc48f5de31d3b73f2d9be47def1"}}:"eip155:137"===this.selectedChain?e={method:"eth_sendTransaction",params:{from:"0xf2F3e73be57031114dd1f4E75c1DD87658be7F0E",data:"0x095ea7b3000000000000000000000000f2614a233c7c3e7f08b1f887ba133a13f1eb2c5500000000000000000000000000000000000000000000000000f6f8096ac575b0",to:"0x0b3F868E0BE5597D5DB7fEB59E1CADBb0fdDa50a"}}:"eip155:56"===this.selectedChain&&(e={method:"eth_sendTransaction",params:{from:"0x0cecb15396825A895FF8DA8fC2D2C77A234dcCee",value:"0x0",gas:"0xe117",gasPrice:"0xb2d05e00",data:"0x095ea7b300000000000000000000000031c2f6fcff4f8759b3bd5bf0e1084a055615c768ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff",to:"0x5CA42204cDaa70d5c773946e69dE942b85CA6706"}});var t=await window.provider.request({method:"eth_requestAccounts"},"eip155"),n=t[0];console.log("当前钱包地址------",n),e.params["from"]=n,this.testTransaction=JSON.stringify(e)},async eth_sendTransaction_mint(){var e={};"eip155:1"===this.selectedChain?e={method:"eth_sendTransaction",params:{gas:"0x4cacb",data:"0xa64dfa75000000000000000000000000ed688002f3797599db8b4feacfe8b1dda0df1c8d000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000002a000000000000000000000000000000000000000000000000000000000000002e0000000000000000000000000000000000000000000000000000000000000032000000000000000000000000000000000000000000000000000000000000003a000000000000000000000000000000000000000000000000000000000000003c000000000000000000000000000000000000000000000000000000000000003e00000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000042000000000000000000000000000000000000000000000000000000000000005000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000052000000000000000000000000000000000000000000000000000000000000005400000000000000000000000000000000000000000000000000000000000000560000000000000000000000000000000000000000000000000000000000000058000000000000000000000000000000000000000000000000000000000000005a000000000000000000000000000000000000000000000000000000000000005c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000cecb15396825a895ff8da8fc2d2c77a234dccee00000000000000000000000000000000000000000000000000000000000005e0000000000000000000000000000000000000000000000000000000000000062000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000047697066733a2f2f6261667962656968643737366b6177706e71336f6f6a6635693274787a76617737737164656b34616a776472637472703261366f626b70723773792f7b69647d0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002a3078303030303030303030303030303030303030303030303030303030303030303030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001",to:"0x864baa13e01d8f9e26549dc91b458cd15e34eb7c",value:"0x0",from:"0x0cecb15396825a895ff8da8fc2d2c77a234dccee"}}:"eip155:137"===this.selectedChain&&(e={method:"eth_sendTransaction",params:{gas:"0x30795",data:"0xa64dfa75000000000000000000000000341b3687f0309778f08f29336b2c4b9c38b9f110000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000002a000000000000000000000000000000000000000000000000000000000000002e0000000000000000000000000000000000000000000000000000000000000032000000000000000000000000000000000000000000000000000000000000003a000000000000000000000000000000000000000000000000000000000000003c000000000000000000000000000000000000000000000000000000000000003e00000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000042000000000000000000000000000000000000000000000000000000000000005000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000052000000000000000000000000000000000000000000000000000000000000005400000000000000000000000000000000000000000000000000000000000000560000000000000000000000000000000000000000000000000000000000000058000000000000000000000000000000000000000000000000000000000000005a000000000000000000000000000000000000000000000000000000000000005c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f2f3e73be57031114dd1f4e75c1dd87658be7f0e00000000000000000000000000000000000000000000000000000000000005e0000000000000000000000000000000000000000000000000000000000000062000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000047697066733a2f2f62616679626569686a6279676b68747a71376b68377434336266686e676e793236337668766f6578716a6d6e377161716166366e717a64743777712f7b69647d0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002a3078303030303030303030303030303030303030303030303030303030303030303030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001",to:"0x864baa13e01d8f9e26549dc91b458cd15e34eb7c",value:"0x0",from:"0xf2f3e73be57031114dd1f4e75c1dd87658be7f0e"}});let t=JSON.stringify(e);console.log("-----长度---\x3e",t.length);var n=await window.provider.request({method:"eth_requestAccounts"},"eip155"),i=n[0];console.log("当前钱包地址------",i),e.params["from"]=i,this.testTransaction=JSON.stringify(e)},async wallet_testRpc(){let e=window.provider;e.setDefaultChain("eip155:56","https://eth-mainnet.g.alchemy.com/v2/NxUfYJUr-TQtEpLmSXhhD5pXn70GwsyV");var t={method:"eth_getBalance",params:["0x8D97689C9818892B700e27F316cc3E41e17fBeb9","latest"]};this.testTransaction=JSON.stringify(t)},async wallet_watchAsset(){var e={};"eip155:1"===this.selectedChain?e={method:"wallet_watchAsset",params:{type:"ERC20",options:{address:"0xe0f63a424a4439cbe457d80e4f4b51ad25b2c56c",symbol:"SPX6900",image:"https://assets.coingecko.com/coins/images/31401/standard/sticker_%281%29.jpg?1702371083",decimals:8}}}:"eip155:137"===this.selectedChain?e={method:"wallet_watchAsset",params:{type:"ERC20",options:{address:"0xeB51D9A39AD5EEF215dC0Bf39a8821ff804A0F01",symbol:"LGNS",image:"https://polygonscan.com/token/images/originlgns_32.png",decimals:9}}}:"eip155:56"===this.selectedChain&&(e={method:"wallet_watchAsset",params:{type:"ERC20",options:{address:"0x031b41e504677879370e9dbcf937283a8691fa7f",symbol:"FET",image:"https://bscscan.com/token/images/fetch_32.png",decimals:18}}}),this.testTransaction=JSON.stringify(e)},async ton_sendTransaction(){var e={messages:[{address:"EQARULUYsmJq1RiZ-YiH-IJLcAZUVkVff-KBPwEmmaQGH6aC",amount:"205000000",payload:"te6cckEBAgEAhwABbQ+KfqUAAADNgG7tIEATEtAIAO87mQKicbKgHIk4pSPP4k5xhHqutqYgAB7USnesDnCcECwbgQMBAJUlk4VhgBD3JEg1TUr75iTijBghOKm/sxNDXUBl7CD6WMut0Q85x4RafwA/Es89DBXoTxuqxVFxyBbzt9Rav2HBUKl7hmkvLuKHLBCW57aK"}],validUntil:1792481054,network:"-239"};this.testTransaction=JSON.stringify(e)},ton_getAccount(){this.testTransaction="这里是同步获取 不再需要点击 <<发送交易>>";const e=new m.l(window.provider);let t=e.getAccount();this.testboc=t?JSON.stringify(t):"null"},async sendTransaction(){if(!(this.selectedChain.startsWith("aptos")||this.selectedChain.startsWith("movement")||this.selectedChain.startsWith("solana")||this.selectedChain.startsWith("sonic")))if(console.log("sendTransaction",window.provider),console.log("sendTransaction内容11------",this.testTransaction),window.provider||console.error("钱包 未初始化完成"),this.testTransaction&&window.provider){const o=JSON.parse(this.testTransaction);try{console.log("sendTransaction-----22method>>",o.method);let s="eip155:1";if(this.selectedChain&&(s=this.selectedChain,console.log("sendTransaction-----this.selectedChain>>",this.selectedChain)),console.log("windowOpen[click_1]: ",Date.now()),"sui:mainnet"==s){const t=new f.Z(window.provider);var e="invalid result";if("sui_signTransaction"==this.currentSuiMethod)e=await t.signTransaction(this.currentSuiTransaction),this.testboc=JSON.stringify(e);else if("sui_signAndExecuteTransaction"==this.currentSuiMethod)e=await t.signAndExecuteTransaction(this.currentSuiTransaction),this.testboc=JSON.stringify(e);else if("sui_signMessage"==this.currentSuiMethod)console.log("signMessage----",this.currentSuiTransaction),e=await t.signMessage(this.currentSuiTransaction),this.testboc=JSON.stringify(e);else if("sui_signPersonalMessage"==this.currentSuiMethod)console.log("signPersonalMessage----",this.currentSuiTransaction),e=await t.signPersonalMessage(this.currentSuiTransaction),this.testboc=JSON.stringify(e);else if("sui_testRpc"==this.currentSuiMethod){console.log("test rpc----",this.currentSuiTransaction),console.log(`请求数据发送 rpc -----\x3e> ${JSON.stringify(o)}`);const e=await window.provider.request(o,s);console.log(`请求数据回调 rpc -----\x3e> ${JSON.stringify(i)}`),this.testboc="string"==typeof e?e:JSON.stringify(e)}return void console.log("windowOpen[click_2]: ",Date.now())}if("ton:-239"===s){console.log(`请求数据发送 sendTransaction ---ton--\x3e> ${JSON.stringify(o)}`);const e=new m.l(window.provider);let t=await e.sendTransaction(o);return console.log(`请求数据回调 sendTransaction -----\x3e> ${JSON.stringify(t)}`),void(this.testboc="string"==typeof t?t:JSON.stringify(t))}if("btc:mainnet"==s){const e=new d.OKXBtcProvider(window.provider);var t="invalid result";return void("btc_signMessage"==this.currentBtcMethod?(t=await e.signMessage(s,this.currentBtcTransaction["signStr"]),this.testboc=JSON.stringify(t)):"btc_send"==this.currentBtcMethod?(t=await e.send(s,this.currentBtcTransaction),this.testboc=JSON.stringify(t)):"btc_signPsbt"==this.currentBtcMethod?(t=await e.signPsbt(s,this.currentBtcTransaction.psbtHex,this.currentBtcTransaction.options),this.hexToBase64(t).then((e=>{this.testboc=JSON.stringify(e)})).catch((e=>{this.testboc=e}))):"btc_signPsbts"==this.currentBtcMethod?(t=await e.signPsbts(s,this.currentBtcTransaction.psbtHexs,this.currentBtcTransaction.options),this.testboc=JSON.stringify(t)):"btc_sendInscription"==this.currentBtcMethod?(t=await e.sendInscription(s,this.currentBtcTransaction.address,this.currentBtcTransaction.inscriptionId,this.currentBtcTransaction.options),this.testboc=JSON.stringify(t)):"btc_signAndPushPsbt"==this.currentBtcMethod?(t=await e.signAndPushPsbt(s,this.currentBtcTransaction.psbtHex,this.currentBtcTransaction.options),this.testboc=JSON.stringify(t)):"btc_sendBitcoin"==this.currentBtcMethod&&(t=await e.sendBitcoin(s,this.currentBtcTransaction.toAddress,this.currentBtcTransaction.satoshis,this.currentBtcTransaction.options),this.testboc=JSON.stringify(t)))}if("fractal:mainnet"==s){const e=new d.OKXBtcProvider(window.provider);var n="invalid result";return void("fractal_signMessage"==this.currentFractalMethod?(n=await e.signMessage(s,this.currentFractalTransaction["signStr"]),this.testboc=JSON.stringify(n)):"fractal_send"==this.currentFractalMethod?(n=await e.send(s,this.currentFractalTransaction),this.testboc=JSON.stringify(n)):"fractal_signPsbt"==this.currentFractalMethod?(n=await e.signPsbt(s,this.currentFractalTransaction.psbtHex,this.currentFractalTransaction.options),this.hexToBase64(n).then((e=>{this.testboc=JSON.stringify(e)})).catch((e=>{this.testboc=e}))):"fractal_signPsbts"==this.currentFractalMethod?(n=await e.signPsbts(s,this.currentFractalTransaction.psbtHexs,this.currentFractalTransaction.options),this.testboc=JSON.stringify(n)):"fractal_sendInscription"==this.currentFractalMethod?(n=await e.sendInscription(s,this.currentFractalTransaction.address,this.currentFractalTransaction.inscriptionId,this.currentFractalTransaction.options),this.testboc=JSON.stringify(n)):"fractal_signAndPushPsbt"==this.currentFractalMethod?(n=await e.signAndPushPsbt(s,this.currentFractalTransaction.psbtHex,this.currentFractalTransaction.options),this.testboc=JSON.stringify(n)):"fractal_sendBitcoin"==this.currentFractalMethod&&(n=await e.sendBitcoin(s,this.currentFractalTransaction.toAddress,this.currentFractalTransaction.satoshis,this.currentFractalTransaction.options),this.testboc=JSON.stringify(n)))}console.log(`请求数据发送 sendTransaction -----\x3e> ${JSON.stringify(o)}`);var i=await window.provider.request(o,s);console.log(`请求数据回调 sendTransaction -----\x3e> ${JSON.stringify(i)}`),console.log("windowOpen[click_3]: ",Date.now()),this.testboc="string"==typeof i?i:JSON.stringify(i),console.log("方法数据回调 --this.testboc--",this.testboc)}catch(s){console.error("方法数据回调失败 --Error--",s.message),s.code===l.OKX_CONNECT_ERROR_CODES.USER_REJECTS_ERROR?this.testboc=s.message:this.testboc="签名错误！"+s.message}}else alert("交易数据为空，请选则或输入交易数据。")},hexToBase64(e){for(var t=[],n=0;n<e.length;n+=2)t.push(parseInt(e.substr(n,2),16));const i=new Uint8Array(t),s=new Blob([i]);return new Promise(((e,t)=>{const n=new FileReader;n.onload=function(t){var n=t.target.result.split(",")[1];e(n)},n.onerror=function(e){t(e)},n.readAsDataURL(s)}))},async testTonSdk(){let e,t,n,i,s,o=[],r=[],a=["solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","sonic:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z"],c=!1,l=["sui:mainnet"],d=["btc:mainnet","fractal:mainnet"];const u=Object.entries(this.availableChains).filter((e=>e[1].checked)).map((e=>e[0]));console.log(`chains  ===> ${u.values()}`),u.forEach((function(r){return console.log(`chains.forEach chainId  ===> ${r}`),a.includes(r)?(o.push(r),void(t=!0)):"string"==typeof r&&r.startsWith("ton")?(o.push(r),void(c=!0)):"string"==typeof r&&(r.startsWith("aptos")||r.startsWith("movement"))?(o.push(r),void(s=!0)):"string"==typeof r&&r.startsWith("svm")?(o.push(r),void(t=!0)):l.includes(r)?(console.log(`nameSpacesChains.push  ===> ${r}`),o.push(r),void(n=!0)):d.includes(r)?(console.log(`nameSpacesChains.push  ===> ${r}`),o.push(r),void(i=!0)):(e=!0,void o.push(`eip155:${r}`))})),x.forEach((function(e){if(!a.includes(e))return"string"==typeof e&&e.startsWith("svm")?(o.push(e),void(t=!0)):void(l.includes(e)||d.includes(e)?r.push(e):r.push(`eip155:${e}`));r.push(e)})),console.log(`namespaceChains  ===> ${JSON.stringify(o)}`);var h,f={};if(o&&o.length>0){var p={};if(e&&(p.eip155={chains:o.filter((e=>e.startsWith("eip155"))),defaultChain:o.filter((e=>e.startsWith("eip155")))[0]}),t&&(p.solana={chains:o.filter((e=>e.startsWith("solana")||e.startsWith("sonic")||e.startsWith("svm"))),defaultChain:o.filter((e=>e.startsWith("solana")||e.startsWith("sonic")||e.startsWith("svm")))[0]}),c){let e={ton_addr:{name:"ton_addr"}};this.tonProofValue&&(e={ton_addr:{name:"ton_addr"},ton_proof:{name:"ton_proof",payload:this.tonProofValue}}),p.ton={chains:o.filter((e=>e.startsWith("ton"))),defaultChain:o.filter((e=>e.startsWith("ton")))[0],params:e}}if(n&&(p.sui={chains:o.filter((e=>e.startsWith("sui"))),defaultChain:o.filter((e=>e.startsWith("sui")))[0],rpcMap:{"sui:mainnet":"https://www.okx.com/fullnode/sui/discover/rpc"}}),s&&(p.aptos={chains:o.filter((e=>e.startsWith("aptos")||e.startsWith("movement"))),defaultChain:o.filter((e=>e.startsWith("aptos")||e.startsWith("movement")))[0]}),i){let e=o.filter((e=>e.startsWith("btc")||e.startsWith("fractal")));p.btc={chains:e,defaultChain:e[0]}}console.log(`requireData  ===> ${JSON.stringify(p)}`),f["namespaces"]=p,console.log(JSON.stringify(f))}if(r&&r.length>0){var g={eip155:{chains:r.filter((e=>e.startsWith("eip155"))),defaultChain:r.filter((e=>e.startsWith("eip155")))[0]}};f["optionalNamespaces"]=g}0!==o.length||0!==r.length?(console.log("=====>connectData "),console.log(f),h=window.provider instanceof D.OKXUniversalConnectUI?window.provider.openModal(f):window.provider.connect(f),await h.then((()=>{this.walletAddress="connected",this.isPC()&&(this.showModal=!1)})).catch((e=>{console.error("发生了错误：",e)}))):alert("请选择一条链")},closeModal(){this.showModal=!1},isPC(){const e=navigator.userAgent;console.log("current device ua is ===>",e);const t=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"];let n=!0;for(let i=0;i<t.length;i++)if(e.indexOf(t[i])>0){n=!1;break}return n},isSafariOrChrome(){const e=navigator.userAgent,t=["Safari","Chrome"];let n=!1;for(let i=0;i<t.length;i++)if(e.indexOf(t[i])>0){n=!0;break}return n},async sol_signMessage(){let e={method:"solana_signMessage",params:{message:"123 签名测试!",pubkey:""}};this.testTransaction=JSON.stringify(e);let t=new u.y(window.provider),n=await t.signMessage("123 签名测试!",this.selectedChain);this.testboc="string"==typeof n?n:JSON.stringify(n)},async aptos_signMessage(){let e={address:!0,application:!0,chainId:!0,message:"123 签名测试!",nonce:"1234"},t=new v.V(window.provider),n=await t.signMessage(e,this.selectedChain);this.testTransaction=JSON.stringify(e),this.testboc="string"==typeof n?n:JSON.stringify(n)},async aptos_signTransaction(){let e=new v.V(window.provider);const t=new O.qc8({network:O.lgv.MAINNET}),n=new O.i5T(t),i=await n.transaction.build.simple({sender:e.getAccount(this.selectedChain).address,data:{function:"0x80273859084bc47f92a6c2d3e9257ebb2349668a1b0fb3db1d759a04c7628855::router::swap_exact_coin_for_coin_x1",typeArguments:["0x1::aptos_coin::AptosCoin","0x111ae3e5bc816a5e63c2da97d0aa3886519e0cd5e4b046659fa35796bd11542a::stapt_token::StakedApt","0x0163df34fccbf003ce219d3f1d9e70d140b60622cb9dd47599c25fb2f797ba6e::curves::Uncorrelated","0x80273859084bc47f92a6c2d3e9257ebb2349668a1b0fb3db1d759a04c7628855::router::BinStepV0V05"],functionArguments:["10000",["9104"],["5"],["true"]]}});this.testTransaction=(0,l.safeJsonStringify)(i);let s=await e.signTransaction(i,this.selectedChain);this.testboc="string"==typeof s?s:JSON.stringify(s)},async move_signTransaction(){let e=new v.V(window.provider);const t=new O.qc8({network:O.lgv.MAINNET}),n=new O.i5T(t),i=await n.transaction.build.simple({sender:e.getAccount(this.selectedChain).address,data:{function:"0x0163df34fccbf003ce219d3f1d9e70d140b60622cb9dd47599c25fb2f797ba6e::scripts::swap",typeArguments:["0x1::aptos_coin::AptosCoin","0x275f508689de8756169d1ee02d889c777de1cebda3a7bbcce63ba8a27c563c6f::tokens::WBTC","0x0163df34fccbf003ce219d3f1d9e70d140b60622cb9dd47599c25fb2f797ba6e::curves::Uncorrelated"],functionArguments:["10000","12"]}});this.testTransaction=(0,l.safeJsonStringify)(i);let s=await e.signTransaction(i,this.selectedChain);this.testboc="string"==typeof s?s:JSON.stringify(s)},async move_signAndSubmitTransaction(){let e=new v.V(window.provider);const t=new O.qc8({network:O.lgv.MAINNET}),n=new O.i5T(t),i=await n.transaction.build.simple({sender:e.getAccount(this.selectedChain).address,data:{function:"0x0163df34fccbf003ce219d3f1d9e70d140b60622cb9dd47599c25fb2f797ba6e::scripts::swap",typeArguments:["0x1::aptos_coin::AptosCoin","0x275f508689de8756169d1ee02d889c777de1cebda3a7bbcce63ba8a27c563c6f::tokens::WBTC","0x0163df34fccbf003ce219d3f1d9e70d140b60622cb9dd47599c25fb2f797ba6e::curves::Uncorrelated"],functionArguments:["10000","12"]}});this.testTransaction=(0,l.safeJsonStringify)(i);let s=await e.signAndSubmitTransaction(i,this.selectedChain);this.testboc="string"==typeof s?s:JSON.stringify(s)},async aptos_signAndSubmitTransaction(){let e=new v.V(window.provider);const t=new O.qc8({network:O.lgv.MAINNET}),n=new O.i5T(t),i=await n.transaction.build.simple({sender:e.getAccount(this.selectedChain).address,data:{function:"0x80273859084bc47f92a6c2d3e9257ebb2349668a1b0fb3db1d759a04c7628855::router::swap_exact_coin_for_coin_x1",typeArguments:["0x1::aptos_coin::AptosCoin","0x111ae3e5bc816a5e63c2da97d0aa3886519e0cd5e4b046659fa35796bd11542a::stapt_token::StakedApt","0x0163df34fccbf003ce219d3f1d9e70d140b60622cb9dd47599c25fb2f797ba6e::curves::Uncorrelated","0x80273859084bc47f92a6c2d3e9257ebb2349668a1b0fb3db1d759a04c7628855::router::BinStepV0V05"],functionArguments:["10000",["9104"],["5"],["true"]]}});this.testTransaction=(0,l.safeJsonStringify)(i);let s=await e.signAndSubmitTransaction(i,this.selectedChain);this.testboc="string"==typeof s?s:JSON.stringify(s)},async sol_signVersionedTransaction(){let e=new u.y(window.provider),t=new h.J3(e.getAccount("solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp").address);const n=new h.Ng(this.getSolConnect()),{blockhash:i}=await n.getLatestBlockhash(),s=new h.wu({payerKey:t,recentBlockhash:i,instructions:[h.yq.transfer({fromPubkey:new h.J3(e.getAccount().address),toPubkey:new h.J3(e.getAccount().address),lamports:"100"})]}).compileToV0Message();let o=new h.Kt(s);this.testTransaction=(0,l.safeJsonStringify)(o);let r=await e.signTransaction(o,this.selectedChain);console.log("sol_signTransaction result",JSON.stringify(r)),this.testboc="string"==typeof r?r:JSON.stringify(r)},async sol_signAndSendVersionedTransaction(){let e=new u.y(window.provider),t=new h.J3(e.getAccount().address);const n=new h.Ng(this.getSolConnect()),{blockhash:i}=await n.getLatestBlockhash(),s=new h.wu({payerKey:t,recentBlockhash:i,instructions:[h.yq.transfer({fromPubkey:new h.J3(e.getAccount().address),toPubkey:new h.J3(e.getAccount().address),lamports:"100"})]}).compileToV0Message();let o=new h.Kt(s);this.testTransaction=(0,l.safeJsonStringify)(o);let r=await e.signAndSendTransaction(o,this.selectedChain);console.log("sol_signTransaction result",JSON.stringify(r)),this.testboc="string"==typeof r?r:JSON.stringify(r)},async sol_signAllVersionedTransactions(){let e=new u.y(window.provider);const t=new h.Ng(this.getSolConnect()),{blockhash:n}=await t.getLatestBlockhash();let i=new h.J3(e.getAccount().address);const s=new h.wu({payerKey:i,recentBlockhash:n,instructions:[h.yq.transfer({fromPubkey:new h.J3(e.getAccount().address),toPubkey:new h.J3(e.getAccount().address),lamports:"100"})]}).compileToV0Message();let o=new h.Kt(s);this.testTransaction=(0,l.safeJsonStringify)(o);let r=await e.signAllTransactions([o],this.selectedChain);console.log("sol_signTransaction result",JSON.stringify(r)),this.testboc="string"==typeof r?r:JSON.stringify(r)},async sol_signTransaction(){const e=new h.Ng(this.getSolConnect()),{blockhash:t}=await e.getLatestBlockhash();let n=new u.y(window.provider);const i=new h.ZX({feePayer:new h.J3(n.getAccount().address),recentBlockhash:t}).add(h.yq.transfer({fromPubkey:new h.J3(n.getAccount().address),toPubkey:new h.J3(n.getAccount().address),lamports:1e3}));this.testTransaction=(0,l.safeJsonStringify)(i);let s=await n.signTransaction(i,this.selectedChain);console.log("sol_signTransaction result",JSON.stringify(s)),this.testboc="string"==typeof s?s:JSON.stringify(s)},async sol_signAllTransactions(){const e=new h.Ng(this.getSolConnect()),{blockhash:t}=await e.getLatestBlockhash();let n=new u.y(window.provider);const i=new h.ZX({feePayer:new h.J3(n.getAccount().address),recentBlockhash:t}).add(h.yq.transfer({fromPubkey:new h.J3(n.getAccount().address),toPubkey:new h.J3(n.getAccount().address),lamports:"100"}));this.testTransaction=(0,l.safeJsonStringify)(i);let s=await n.signAllTransactions([i],this.selectedChain);this.testboc="string"==typeof s?s:JSON.stringify(s)},getSolConnect(){let e="https://www.okx.com/fullnode/sol/discover/rpc";return"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp"===this.selectedChain?e="https://www.okx.com//fullnode/sol/discover/rpc":"solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z"===this.selectedChain?e="https://www.okx.com/fullnode/soltestnet/discover/rpc":"sonic:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z"===this.selectedChain&&(e="https://www.okx.com/fullnode/sonic/testnet/discover/rpc/sonic-testnet-rpc-light"),e},async sol_signAndSendTransaction(){const e=new h.Ng(this.getSolConnect()),{blockhash:t}=await e.getLatestBlockhash();let n=new u.y(window.provider);const i=new h.ZX({feePayer:new h.J3(n.getAccount().address),recentBlockhash:t}).add(h.yq.transfer({fromPubkey:new h.J3(n.getAccount().address),toPubkey:new h.J3(n.getAccount().address),lamports:"100"}));this.testTransaction=(0,l.safeJsonStringify)(i);let s=await n.signAndSendTransaction(i,this.selectedChain);this.testboc="string"==typeof s?s:JSON.stringify(s)},sui_getAccount(){let e=new f.Z(window.provider),t=e.getAccount();this.testboc="string"==typeof t?t:JSON.stringify(t)},async sui_signMessage(){const e=[76,111,103,105,110,32,119,105,116,104,32,66,108,117,101,109,111,118,101],t=new Uint8Array(e);let n={message:t};this.testTransaction=JSON.stringify(n),this.currentSuiTransaction=n,this.currentSuiMethod="sui_signMessage"},async sui_signPersonalMessage(){const e=[76,111,103,105,110,32,119,105,116,104,32,66,108,117,101,109,111,118,101],t=new Uint8Array(e);let n={message:t};this.testTransaction=JSON.stringify(n),this.currentSuiTransaction=n,this.currentSuiMethod="sui_signPersonalMessage"},sui_signAndExecuteTransaction(){const e=115,t="0x72f798f8b709902453d4bb55c65661e9e04154a506765f2333dfb7e7834056d2",n=new p.Z,[i]=n.splitCoins(n.gas,[e]);n.transferObjects([i],t);const s={transactionBlock:n,account:{},chain:"sui:mainnet",options:{showEffects:!0}};this.testTransaction=JSON.stringify(s),this.currentSuiTransaction=s,this.currentSuiMethod="sui_signAndExecuteTransaction"},async deeplinkActionTest(){let e="https://www.okx.com/download?deeplink=okx%3A%2F%2Fweb3%2Fwallet%2Fconnect";await this.performAsyncTask(),window.open(e,"_self")},async performAsyncTask(){return new Promise((e=>{setTimeout((()=>{e("Task completed")}),5e3)}))},sui_signTransaction2(){const e=109,t="0x72f798f8b709902453d4bb55c65661e9e04154a506765f2333dfb7e7834056d2",n=new p.Z,[i]=n.splitCoins(n.gas,[e]);n.transferObjects([i],t);const s={transactionBlock:n,account:{},chain:"sui:mainnet",options:{showEffects:!0}};this.testTransaction=JSON.stringify(s),this.currentSuiTransaction=s,this.currentSuiMethod="sui_signTransaction"},async sui_signTransaction(){let e='{"version":1, "expiration":null,"gasConfig":{"payment":[{"objectId":"0x04a1673fa847afa845e477925c271cb3e8cf0d19cfb830e8c3e841adc299cbca","version":"391804724","digest":"AHXon1Qvb1xUj5r7aaHyHfLgGhdeNXQ1V3RaNW755mVK"}],"owner":"0xe62ee1c436125b5b6224cb11b0fa9fbf2c313743aea84eead0450ab49dd0d6ed","price":"750","budget":"8177120"},"inputs":[{"kind":"Input","type":"object","index":0,"value":"0x0000000000000000000000000000000000000000000000000000000000000006"},{"kind":"Input","type":"object","index":1,"value":"0xbb4e2f4b6205c2e2a2db47aeb4f830796ec7c005f88537ee775986639bc442fe"},{"kind":"Input","type":"object","index":2,"value":"0x96df0fce3c471489f4debaaa762cf960b3d97820bd1f3f025ff8190730e958c5"},{"kind":"Input","index":3,"value":{"Pure":[0]},"type":"pure"},{"kind":"Input","index":4,"value":{"Pure":[0,202,154,59,0,0,0,0]},"type":"pure"},{"kind":"Input","index":5,"value":{"Pure":[0,202,154,59,0,0,0,0]},"type":"pure"},{"kind":"Input","type":"object","index":6,"value":"0xaaf735bf83ff564e1b219a0d644de894ef5bdc4b2250b126b2a46dd002331821"},{"kind":"Input","type":"object","index":7,"value":"0xf87a8acb8b81d14307894d12595541a73f19933f88e1326d5be349c7a6f7559c"}],"transactions":[{"kind":"SplitCoins","coin":{"kind":"GasCoin"},"amounts":[{"kind":"Input","index":4,"value":{"Pure":[0,202,154,59,0,0,0,0]},"type":"pure"}]},{"kind":"MoveCall","target":"0x834a86970ae93a73faf4fff16ae40bdb72b91c47be585fff19a2af60a19ddca3::incentive_v2::entry_deposit","typeArguments":["0x2::sui::SUI"],"arguments":[{"kind":"Input","type":"object","index":0,"value":"0x0000000000000000000000000000000000000000000000000000000000000006"},{"kind":"Input","type":"object","index":1,"value":"0xbb4e2f4b6205c2e2a2db47aeb4f830796ec7c005f88537ee775986639bc442fe"},{"kind":"Input","type":"object","index":2,"value":"0x96df0fce3c471489f4debaaa762cf960b3d97820bd1f3f025ff8190730e958c5"},{"kind":"Input","index":3,"value":{"Pure":[0]},"type":"pure"},{"kind":"Result","index":0},{"kind":"Input","index":5,"value":{"Pure":[0,202,154,59,0,0,0,0]},"type":"pure"},{"kind":"Input","type":"object","index":6,"value":"0xaaf735bf83ff564e1b219a0d644de894ef5bdc4b2250b126b2a46dd002331821"},{"kind":"Input","type":"object","index":7,"value":"0xf87a8acb8b81d14307894d12595541a73f19933f88e1326d5be349c7a6f7559c"}]}]}';const t=p.Z.from(e),n={transactionBlock:t,account:{},chain:"sui:mainnet",options:{showEffects:!0}};this.testTransaction=JSON.stringify(n),this.currentSuiTransaction=n,this.currentSuiMethod="sui_signTransaction"},async sui_requestRpc(){let e=window.provider;e.setDefaultChain("sui:mainnet","https://fullnode.mainnet.sui.io:443");var t={method:"suix_getBalance",params:["0x51ceab2edc89f74730e683ebee65578cb3bc9237ba6fca019438a9737cf156ae","0x168da5bf1f48dafc111b0a488fa454aca95e0b5e::usdc::USDC"]};this.testTransaction=JSON.stringify(t),this.currentSuiTransaction=JSON.stringify(t),this.currentSuiMethod="sui_testRpc"},async sui_signAndExecuteTransaction_stake(){if(0==this.testboc.length)return void alert("输入input.serilize()读取到的参数");let e,t=this.testboc;try{e=p.Z.from(t)}catch(i){alert("参数错误")}const n={transactionBlock:e,account:{},chain:"sui:mainnet",options:{showEffects:!0}};this.testTransaction=JSON.stringify(n),this.currentSuiTransaction=n,this.currentSuiMethod="sui_signAndExecuteTransaction"},async sui_signTransaction_pre_execution(){const e=102,t="0x72f798f8b709902453d4bb55c65661e9e04154a506765f2333dfb7e7834056d2",n=new p.Z,[i]=n.splitCoins(n.gas,[e]);n.transferObjects([i],t);const s={transactionBlock:n,options:{showEffects:!0}},[o,r]=await this.generateTsBytesAndSerizlize(s);s.txBytes=o,s.txSerialize=r,this.testTransaction=JSON.stringify(s),this.currentSuiTransaction=s,this.currentSuiMethod="sui_signTransaction"},async sui_signAndExecuteTransaction_pre_execution(){const e=115,t="0x72f798f8b709902453d4bb55c65661e9e04154a506765f2333dfb7e7834056d2",n=new p.Z,[i]=n.splitCoins(n.gas,[e]);n.transferObjects([i],t);const s={transactionBlock:n,options:{showEffects:!0}},[o,r]=await this.generateTsBytesAndSerizlize(s);s.txBytes=o,s.txSerialize=r,this.testTransaction=JSON.stringify(s),this.currentSuiTransaction=s,this.currentSuiMethod="sui_signAndExecuteTransaction"},async generateTsBytesAndSerizlize(e){let t=["",""];if("txBytes"in e&&e.txBytes.length>0&&"txSerialize"in e&&e.txSerialize.length>0&&(t=[e.txBytes,e.txSerialize]),!("transactionBlock"in e))return new Promise((e=>{e(t)}));if("connected"!=this.walletAddress)return alert("请先连接钱包"),new Promise((e=>{e(t)}));let n=window.provider.requestAccountsWithNamespace("sui");if(0==n.length)return new Promise((e=>{e(t)}));try{let i=(0,b.T)("mainnet");i="https://www.okx.com/fullnode/sui/discover/rpc";const s=new _.x({url:i});e.transactionBlock.setSender(n[0]);const o=await e.transactionBlock.build({client:s}),r=K(o).toString("base64"),a=await p.Z.from(r).toJSON();t=[r,a]}catch(i){return new Promise((e=>{e(t)}))}return new Promise((e=>{e(t)}))},btc_generateTransactionParams(e,t){this.testTransaction=JSON.stringify(e),this.currentBtcTransaction=e,this.currentBtcMethod=t,console.log("参数是: ",e),console.log("flag: ",t)},fractal_generateTransactionParams(e,t){this.testTransaction=JSON.stringify(e),this.currentFractalTransaction=e,this.currentFractalMethod=t,console.log("参数是: ",e),console.log("flag: ",t)},handleModalsSelect(e){M=e,this.withUI&&(window.provider.uiOptions={actionsConfiguration:{returnStrategy:"none",modals:3===e.length?"all":e},language:W,uiPreferences:{theme:U}})},handleLanguageSelect(e){W=e,this.withUI&&(console.log("currOpts",window.provider),window.provider.uiOptions={actionsConfiguration:window.provider.actionsConfiguration,language:e,uiPreferences:{theme:U}})},handleThemeSelect(e){U=e,this.withUI&&(window.provider.uiOptions={actionsConfiguration:window.provider.actionsConfiguration,language:W,uiPreferences:{theme:e}})}},created(){},mounted(){var e,t=document.createElement("script");t.src="https://telegram.org/js/telegram-web-app.js",t.id="tgsdk",document.getElementsByTagName("head")[0].appendChild(t),this.connectReady=!0,document.title="OKX Connect Evm",e=this.withUI?D.OKXUniversalConnectUI.init({dappMetaData:{icon:"https://static.okx.com/cdn/assets/imgs/247/58E63FEA47A2B7D7.png",name:"OKX WalletConnect UI Demo"},actionsConfiguration:{returnStrategy:"tg://resolve",modals:"all"},language:"en_US",uiPreferences:{theme:D.THEME.LIGHT}}):d.OKXUniversalProvider.init({dappMetaData:{name:"univer test dapp",icon:"https://avatars.githubusercontent.com/u/37784886"}}),e.then((e=>{if(window.provider=e,console.log("init finished:",e),console.log("init finished session:",JSON.stringify(e.session)),e.session?.namespaces){const t=[];console.log("namespaces",e.session.namespaces),Object.entries(e.session.namespaces).forEach((([e,n])=>{"eip155"===e?n.chains.forEach((e=>{t.push(parseInt(e.substring(7)))})):"aptos"===e?n.chains.forEach((e=>{"aptos:637"===e?t.push("aptos:mainnet"):t.push("movement:testnet")})):n.chains.forEach((e=>{t.push(e)}))})),console.log("existing chains:",t),this.initChains(t)}else this.initChains([]);e.on("display_uri",(e=>{this.isPC()&&e&&!this.withUI&&(this.qrValue=e,this.showModal=!0),console.log("通知>>>display_uri  ==> ",e)})),e.on("connect",(e=>{console.log("通知>>>get connect session",e)})),e.on("reconnect",(e=>{console.log("通知>>>get reconnect session",e),this.walletAddress="connected"})),e.on("disconnect",(({topic:e})=>{console.log(`通知>>>get disconnect  ${e}`),this.walletAddress="disconnecteddddd"})),e.on("session_delete",(({topic:e})=>{console.log(`通知>>>get session_delete  ${e}`)})),e.on("session_update",(e=>{console.log("通知>>>get session_update ",JSON.stringify(e))}))}))}};const X=(0,N.A)(J,[["render",c],["__scopeId","data-v-1a60011a"]]);var j=X;const L=(0,i.Ef)(j);L.use(s.A),L.mount("#app")},5444:function(){},36305:function(){},59575:function(){},38581:function(){},98730:function(){},48103:function(){},45349:function(){},30515:function(){},71283:function(){},59583:function(){},89513:function(){},99432:function(){},61276:function(){},50477:function(){},66443:function(){},71281:function(){}},t={};function n(i){var s=t[i];if(void 0!==s)return s.exports;var o=t[i]={id:i,loaded:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.m=e,function(){n.amdO={}}(),function(){var e=[];n.O=function(t,i,s,o){if(!i){var r=1/0;for(d=0;d<e.length;d++){i=e[d][0],s=e[d][1],o=e[d][2];for(var a=!0,c=0;c<i.length;c++)(!1&o||r>=o)&&Object.keys(n.O).every((function(e){return n.O[e](i[c])}))?i.splice(c--,1):(a=!1,o<r&&(r=o));if(a){e.splice(d--,1);var l=s();void 0!==l&&(t=l)}}return t}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[i,s,o]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){var e={524:0};n.O.j=function(t){return 0===e[t]};var t=function(t,i){var s,o,r=i[0],a=i[1],c=i[2],l=0;if(r.some((function(t){return 0!==e[t]}))){for(s in a)n.o(a,s)&&(n.m[s]=a[s]);if(c)var d=c(n)}for(t&&t(i);l<r.length;l++)o=r[l],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return n.O(d)},i=self["webpackChunkokxconnectdemo"]=self["webpackChunkokxconnectdemo"]||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}();var i=n.O(void 0,[504],(function(){return n(18167)}));i=n.O(i)})();
//# sourceMappingURL=app.973a08d7.js.map